{"version":3,"file":"OutermostTargetSelector.test.js","sourceRoot":"","sources":["../../../../../../front_end/entrypoints/inspector_main/OutermostTargetSelector.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../../core/sdk/sdk.js';\nimport {\n  createTarget,\n} from '../../testing/EnvironmentHelpers.js';\nimport {\n  describeWithMockConnection,\n} from '../../testing/MockConnection.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport * as InspectorMain from './inspector_main.js';\n\ndescribeWithMockConnection('OutermostTargetSelector', () => {\n  let tabTarget: SDK.Target.Target;\n  let primaryTarget: SDK.Target.Target;\n  let prerenderTarget: SDK.Target.Target;\n  let selector: InspectorMain.OutermostTargetSelector.OutermostTargetSelector;\n\n  beforeEach(() => {\n    tabTarget = createTarget({type: SDK.Target.Type.Tab, url: 'http://example.com/', name: 'tab'});\n    primaryTarget = createTarget({parentTarget: tabTarget, url: 'http://example.com/', name: 'primary'});\n    prerenderTarget = createTarget(\n        {parentTarget: tabTarget, subtype: 'prerender', url: 'http://example.com/prerender1', name: 'prerender1'});\n    selector = InspectorMain.OutermostTargetSelector.OutermostTargetSelector.instance({forceNew: true});\n  });\n\n  it('creates drop-down with outermost targets', () => {\n    assert.deepEqual([...selector.listItems], [primaryTarget, prerenderTarget]);\n\n    createTarget({parentTarget: primaryTarget});\n    assert.deepEqual([...selector.listItems], [primaryTarget, prerenderTarget]);\n\n    const prerenderTarget2 =\n        createTarget({parentTarget: tabTarget, subtype: 'prerender', url: 'http://example.com/prerender2'});\n    assert.deepEqual([...selector.listItems], [primaryTarget, prerenderTarget, prerenderTarget2]);\n\n    prerenderTarget.dispose('');\n    assert.deepEqual([...selector.listItems], [primaryTarget, prerenderTarget2]);\n  });\n\n  it('hides when only one target is present', () => {\n    assert.isTrue(selector.item().visible());\n    prerenderTarget.dispose('');\n    assert.isFalse(selector.item().visible());\n  });\n\n  it('updates selected target when UI context flavor changes', () => {\n    UI.Context.Context.instance().setFlavor(SDK.Target.Target, primaryTarget);\n    assert.strictEqual(selector.item().element.title, 'Page: primary');\n    UI.Context.Context.instance().setFlavor(SDK.Target.Target, prerenderTarget);\n    assert.strictEqual(selector.item().element.title, 'Page: prerender1');\n  });\n\n  it('updates when name changes', () => {\n    UI.Context.Context.instance().setFlavor(SDK.Target.Target, prerenderTarget);\n    assert.strictEqual(selector.item().element.title, 'Page: prerender1');\n    prerenderTarget.setName('prerender3');\n\n    assert.strictEqual(selector.item().element.title, 'Page: prerender3');\n  });\n\n  it('updates UI context flavor on selection', () => {\n    selector.itemSelected(primaryTarget);\n    assert.strictEqual(UI.Context.Context.instance().flavor(SDK.Target.Target), primaryTarget);\n    selector.itemSelected(prerenderTarget);\n    assert.strictEqual(UI.Context.Context.instance().flavor(SDK.Target.Target), prerenderTarget);\n  });\n\n  it('does not change UI context flavor within the same page', () => {\n    const subtarget = createTarget({parentTarget: primaryTarget});\n    selector.itemSelected(primaryTarget);\n    assert.strictEqual(UI.Context.Context.instance().flavor(SDK.Target.Target), primaryTarget);\n    UI.Context.Context.instance().setFlavor(SDK.Target.Target, subtarget);\n    assert.strictEqual(selector.item().element.title, 'Page: primary');\n    assert.strictEqual(UI.Context.Context.instance().flavor(SDK.Target.Target), subtarget);\n  });\n});\n"]}