{"version":3,"file":"SourceMapEncoder.test.js","sourceRoot":"","sources":["../../../../../front_end/testing/SourceMapEncoder.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SourceMapEncoder from './SourceMapEncoder.js';\n\ndescribe('SourceMapEncoder', () => {\n  it('translates numbers to Base64 VLQ correctly', () => {\n    assert.strictEqual(SourceMapEncoder.encodeVlq(0), 'A');\n    assert.strictEqual(SourceMapEncoder.encodeVlq(-2), 'F');\n    assert.strictEqual(SourceMapEncoder.encodeVlq(41), 'yC');\n    assert.strictEqual(SourceMapEncoder.encodeVlq(-25), 'zB');\n  });\n\n  it('translates number lists correctly', () => {\n    // Let us test the cases we care about in source maps.\n\n    // Encoding of column-only mapping.\n    assert.strictEqual('A', SourceMapEncoder.encodeVlqList([0]));\n    assert.strictEqual('oG', SourceMapEncoder.encodeVlqList([100]));\n\n    // Encoding of column => source:line:column mapping.\n    assert.strictEqual('w+BoGUwM', SourceMapEncoder.encodeVlqList([1000, 100, 10, 200]));\n    assert.strictEqual('DFHJ', SourceMapEncoder.encodeVlqList([-1, -2, -3, -4]));\n\n    // Encoding of column => source:line:column@name mapping.\n    assert.strictEqual('CEGIK', SourceMapEncoder.encodeVlqList([1, 2, 3, 4, 5]));\n    assert.strictEqual('qGsGuGwGyG', SourceMapEncoder.encodeVlqList([101, 102, 103, 104, 105]));\n  });\n\n  it('can encode trivial source maps correctly', () => {\n    // Test trivial cases.\n    assert.deepEqual(\n        {\n          sources: [],\n          names: [],\n          mappings: 'A',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap(['0:0']));\n\n    assert.deepEqual(\n        {\n          sources: ['a.js'],\n          names: [],\n          mappings: 'AAAA',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap(['0:0 => a.js:0:0']));\n\n    assert.deepEqual(\n        {\n          sources: ['a.js'],\n          names: ['b'],\n          mappings: 'AAAAA',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap(['0:0 => a.js:0:0@b']));\n  });\n\n  it('can encode multiple lines correctly', () => {\n    // Next line encoding.\n    assert.strictEqual('AAAA;AACA', SourceMapEncoder.encodeSourceMap(['0:0 => a.js:0:0', '1:0 => a.js:1:0']).mappings);\n    assert.strictEqual('A;A', SourceMapEncoder.encodeSourceMap(['0:0', '1:0']).mappings);\n\n    // Skipping lines.\n    assert.strictEqual(';A;;;A', SourceMapEncoder.encodeSourceMap(['1:0', '4:0']).mappings);\n    assert.strictEqual(\n        ';AACA;;;AAEA', SourceMapEncoder.encodeSourceMap(['1:0 => a.js:1:0', '4:0 => a.js:3:0']).mappings);\n  });\n\n  it('can encode relative offset mappings correctly', () => {\n    // Relative columns.\n    assert.strictEqual(\n        'AAAA,EAAI,IAAD',\n        SourceMapEncoder.encodeSourceMap(['0:0 => a.js:0:0', '0:2 => a.js:0:4', '0:6 => a.js:0:3']).mappings);\n\n    // Reset after new line.\n    assert.strictEqual(\n        'AAAA,EAAC;MAAE',\n        SourceMapEncoder.encodeSourceMap(['0:0 => a.js:0:0', '0:2 => a.js:0:1', '1:6 => a.js:0:3']).mappings);\n\n    // Relative source, source line and source column.\n    assert.deepEqual(\n        {\n          sources: ['a.js', 'b.js', 'c.js'],\n          names: [],\n          mappings: 'CACC;CCEC;CCFC;CDAH',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap(['0:1 => a.js:1:1', '1:1 => b.js:3:2', '2:1 => c.js:1:3', '3:1 => b.js:1:0']));\n  });\n\n  it('can encode names correctly', () => {\n    assert.deepEqual(\n        {\n          sources: ['a.js'],\n          names: ['a', 'b', 'c'],\n          mappings: 'AAAAA;AACAC;AACAC;AACAF',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap(\n            ['0:0 => a.js:0:0@a', '1:0 => a.js:1:0@b', '2:0 => a.js:2:0@c', '3:0 => a.js:3:0@a']));\n  });\n\n  it('can encode small realistic samples correctly', () => {\n    assert.deepEqual(\n        {\n          sources: ['example.js'],\n          names: ['a', 'b', 'c', 'd'],\n          mappings: 'AAASA,QAAAA,IAAG,CAACC,CAAD,CAAaC,CAAb,CACZ,CACI,MAAOD,EAAP,CAAoBC,CADxB,CAIA,IAAIC,OAAS;A',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap([\n          // clang-format off\n          '0:0 => example.js:0:9@a',\n          '0:8 => example.js:0:9@a',\n          '0:12 => example.js:0:12',\n          '0:13 => example.js:0:13@b',\n          '0:14 => example.js:0:12',\n          '0:15 => example.js:0:25@c',\n          '0:16 => example.js:0:12',\n          '0:17 => example.js:1:0',\n          '0:18 => example.js:2:4',\n          '0:24 => example.js:2:11@b',\n          '0:26 => example.js:2:4',\n          '0:27 => example.js:2:24@c',\n          '0:28 => example.js:1:0',\n          '0:29 => example.js:5:0',\n          '0:33 => example.js:5:4@d',\n          '0:40 => example.js:5:13',\n          '1:0',\n          // clang-format on\n        ]));\n\n    assert.deepEqual(\n        {\n          sources: ['sourcemap-stepping-source.js'],\n          names: [],\n          mappings:\n              'AAAA,oCAAoC;;AAEpC;GACG;GAAA;GAAA;GACA;GAAA;GAAA;GACA;GAAA;GAAA;;GAEA;AACH;;AAEA;GACG;GACA;GACA;;GAEA;AACH',\n          version: 3,\n        },\n        SourceMapEncoder.encodeSourceMap([\n          // clang-format off\n        '0:0 => sourcemap-stepping-source.js:0:0',\n        '0:36 => sourcemap-stepping-source.js:0:36',\n        '2:0 => sourcemap-stepping-source.js:2:0',\n        '3:3 => sourcemap-stepping-source.js:3:3',\n        '4:3 => sourcemap-stepping-source.js:3:3',\n        '5:3 => sourcemap-stepping-source.js:3:3',\n        '6:3 => sourcemap-stepping-source.js:4:3',\n        '7:3 => sourcemap-stepping-source.js:4:3',\n        '8:3 => sourcemap-stepping-source.js:4:3',\n        '9:3 => sourcemap-stepping-source.js:5:3',\n        '10:3 => sourcemap-stepping-source.js:5:3',\n        '11:3 => sourcemap-stepping-source.js:5:3',\n        '13:3 => sourcemap-stepping-source.js:7:3',\n        '14:0 => sourcemap-stepping-source.js:8:0',\n        '16:0 => sourcemap-stepping-source.js:10:0',\n        '17:3 => sourcemap-stepping-source.js:11:3',\n        '18:3 => sourcemap-stepping-source.js:12:3',\n        '19:3 => sourcemap-stepping-source.js:13:3',\n        '21:3 => sourcemap-stepping-source.js:15:3',\n        '22:0 => sourcemap-stepping-source.js:16:0',\n          // clang-format on\n        ]));\n  });\n});\n"]}