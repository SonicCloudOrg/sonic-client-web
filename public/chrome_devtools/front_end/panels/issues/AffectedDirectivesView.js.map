{"version":3,"file":"AffectedDirectivesView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/issues/AffectedDirectivesView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as IssuesManager from '../../models/issues_manager/issues_manager.js';\nimport * as IssuesComponents from './components/components.js';\n\nimport {AffectedItem, AffectedResourcesView} from './AffectedResourcesView.js';\n\nconst UIStrings = {\n  /**\n   *@description Singular or plural label for number of affected CSP (content security policy,\n   * see https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) directives in issue view.\n   */\n  nDirectives: '{n, plural, =1 {# directive} other {# directives}}',\n  /**\n   *@description Indicates that a CSP error should be treated as a warning\n   */\n  reportonly: 'report-only',\n  /**\n   *@description The kind of resolution for a mixed content issue\n   */\n  blocked: 'blocked',\n  /**\n   *@description Tooltip for button linking to the Elements panel\n   */\n  clickToRevealTheViolatingDomNode: 'Click to reveal the violating DOM node in the Elements panel',\n  /**\n   *@description Header for the section listing affected directives\n   */\n  directiveC: 'Directive',\n  /**\n   *@description Label for the column in the element list in the CSS overview report\n   */\n  element: 'Element',\n  /**\n   *@description Header for the source location column\n   */\n  sourceLocation: 'Source location',\n  /**\n   *@description Text for the status of something\n   */\n  status: 'Status',\n  /**\n   *@description Text that refers to the resources of the web page\n   */\n  resourceC: 'Resource',\n};\n\nconst str_ = i18n.i18n.registerUIStrings('panels/issues/AffectedDirectivesView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class AffectedDirectivesView extends AffectedResourcesView {\n  #appendStatus(element: Element, isReportOnly: boolean): void {\n    const status = document.createElement('td');\n    if (isReportOnly) {\n      status.classList.add('affected-resource-report-only-status');\n      status.textContent = i18nString(UIStrings.reportonly);\n    } else {\n      status.classList.add('affected-resource-blocked-status');\n      status.textContent = i18nString(UIStrings.blocked);\n    }\n    element.appendChild(status);\n  }\n\n  protected getResourceNameWithCount(count: number): Platform.UIString.LocalizedString {\n    return i18nString(UIStrings.nDirectives, {n: count});\n  }\n\n  #appendViolatedDirective(element: Element, directive: string): void {\n    const violatedDirective = document.createElement('td');\n    violatedDirective.textContent = directive;\n    element.appendChild(violatedDirective);\n  }\n\n  #appendBlockedURL(element: Element, url: Platform.DevToolsPath.UrlString): void {\n    const info = document.createElement('td');\n    info.classList.add('affected-resource-directive-info');\n    info.textContent = url;\n    element.appendChild(info);\n  }\n\n  #appendBlockedElement(\n      element: Element, nodeId: Protocol.DOM.BackendNodeId|undefined, model: SDK.IssuesModel.IssuesModel): void {\n    const elementsPanelLinkComponent = new IssuesComponents.ElementsPanelLink.ElementsPanelLink();\n    if (nodeId) {\n      const violatingNodeId = nodeId;\n      elementsPanelLinkComponent.title = i18nString(UIStrings.clickToRevealTheViolatingDomNode);\n\n      const onElementRevealIconClick: (arg0?: Event|undefined) => void = () => {\n        const target = model.getTargetIfNotDisposed();\n        if (target) {\n          Host.userMetrics.issuesPanelResourceOpened(this.issue.getCategory(), AffectedItem.Element);\n          const deferredDOMNode = new SDK.DOMModel.DeferredDOMNode(target, violatingNodeId);\n          void Common.Revealer.reveal(deferredDOMNode);\n        }\n      };\n\n      const onElementRevealIconMouseEnter: (arg0?: Event|undefined) => void = () => {\n        const target = model.getTargetIfNotDisposed();\n        if (target) {\n          const deferredDOMNode = new SDK.DOMModel.DeferredDOMNode(target, violatingNodeId);\n          if (deferredDOMNode) {\n            deferredDOMNode.highlight();\n          }\n        }\n      };\n\n      const onElementRevealIconMouseLeave: (arg0?: Event|undefined) => void = () => {\n        SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n      };\n\n      elementsPanelLinkComponent\n          .data = {onElementRevealIconClick, onElementRevealIconMouseEnter, onElementRevealIconMouseLeave};\n    }\n\n    const violatingNode = document.createElement('td');\n    violatingNode.classList.add('affected-resource-csp-info-node');\n    violatingNode.appendChild(elementsPanelLinkComponent);\n    element.appendChild(violatingNode);\n  }\n\n  #appendAffectedContentSecurityPolicyDetails(\n      cspIssues: Iterable<IssuesManager.ContentSecurityPolicyIssue.ContentSecurityPolicyIssue>): void {\n    const header = document.createElement('tr');\n    if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.inlineViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.directiveC));\n      this.appendColumnTitle(header, i18nString(UIStrings.element));\n      this.appendColumnTitle(header, i18nString(UIStrings.sourceLocation));\n      this.appendColumnTitle(header, i18nString(UIStrings.status));\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.urlViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.resourceC), 'affected-resource-directive-info-header');\n      this.appendColumnTitle(header, i18nString(UIStrings.status));\n      this.appendColumnTitle(header, i18nString(UIStrings.directiveC));\n      this.appendColumnTitle(header, i18nString(UIStrings.sourceLocation));\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.evalViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.sourceLocation));\n      this.appendColumnTitle(header, i18nString(UIStrings.directiveC));\n      this.appendColumnTitle(header, i18nString(UIStrings.status));\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.trustedTypesSinkViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.sourceLocation));\n      this.appendColumnTitle(header, i18nString(UIStrings.status));\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.trustedTypesPolicyViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.sourceLocation));\n      this.appendColumnTitle(header, i18nString(UIStrings.directiveC));\n      this.appendColumnTitle(header, i18nString(UIStrings.status));\n    } else {\n      this.updateAffectedResourceCount(0);\n      return;\n    }\n    this.affectedResources.appendChild(header);\n    let count = 0;\n    for (const cspIssue of cspIssues) {\n      count++;\n      this.#appendAffectedContentSecurityPolicyDetail(cspIssue);\n    }\n    this.updateAffectedResourceCount(count);\n  }\n\n  #appendAffectedContentSecurityPolicyDetail(\n      cspIssue: IssuesManager.ContentSecurityPolicyIssue.ContentSecurityPolicyIssue): void {\n    const element = document.createElement('tr');\n    element.classList.add('affected-resource-directive');\n\n    const cspIssueDetails = cspIssue.details();\n    const location = IssuesManager.Issue.toZeroBasedLocation(cspIssueDetails.sourceCodeLocation);\n    const model = cspIssue.model();\n    const maybeTarget = cspIssue.model()?.getTargetIfNotDisposed();\n    if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.inlineViolationCode && model) {\n      this.#appendViolatedDirective(element, cspIssueDetails.violatedDirective);\n      this.#appendBlockedElement(element, cspIssueDetails.violatingNodeId, model);\n      this.appendSourceLocation(element, location, maybeTarget);\n      this.#appendStatus(element, cspIssueDetails.isReportOnly);\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.urlViolationCode) {\n      const url = cspIssueDetails.blockedURL ? cspIssueDetails.blockedURL as Platform.DevToolsPath.UrlString :\n                                               Platform.DevToolsPath.EmptyUrlString;\n      this.#appendBlockedURL(element, url);\n      this.#appendStatus(element, cspIssueDetails.isReportOnly);\n      this.#appendViolatedDirective(element, cspIssueDetails.violatedDirective);\n      this.appendSourceLocation(element, location, maybeTarget);\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.evalViolationCode) {\n      this.appendSourceLocation(element, location, maybeTarget);\n      this.#appendViolatedDirective(element, cspIssueDetails.violatedDirective);\n      this.#appendStatus(element, cspIssueDetails.isReportOnly);\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.trustedTypesSinkViolationCode) {\n      this.appendSourceLocation(element, location, maybeTarget);\n      this.#appendStatus(element, cspIssueDetails.isReportOnly);\n    } else if (this.issue.code() === IssuesManager.ContentSecurityPolicyIssue.trustedTypesPolicyViolationCode) {\n      this.appendSourceLocation(element, location, maybeTarget);\n      this.#appendViolatedDirective(element, cspIssueDetails.violatedDirective);\n      this.#appendStatus(element, cspIssueDetails.isReportOnly);\n    } else {\n      return;\n    }\n\n    this.affectedResources.appendChild(element);\n  }\n\n  update(): void {\n    this.clear();\n    this.#appendAffectedContentSecurityPolicyDetails(this.issue.getCspIssues());\n  }\n}\n"]}