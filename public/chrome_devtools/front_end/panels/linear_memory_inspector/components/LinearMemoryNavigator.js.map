{"version":3,"file":"LinearMemoryNavigator.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/linear_memory_inspector/components/LinearMemoryNavigator.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport linearMemoryNavigatorStyles from './linearMemoryNavigator.css.js';\n\nconst UIStrings = {\n  /**\n   *@description Tooltip text that appears when hovering over a valid memory address (e.g. 0x0) in the address line in the Linear memory inspector.\n   */\n  enterAddress: 'Enter address',\n  /**\n   *@description Tooltip text that appears when hovering over the button to go back in history in the Linear Memory Navigator\n   */\n  goBackInAddressHistory: 'Go back in address history',\n  /**\n   *@description Tooltip text that appears when hovering over the button to go forward in history in the Linear Memory Navigator\n   */\n  goForwardInAddressHistory: 'Go forward in address history',\n  /**\n   *@description Tooltip text that appears when hovering over the page back icon in the Linear Memory Navigator\n   */\n  previousPage: 'Previous page',\n  /**\n   *@description Tooltip text that appears when hovering over the next page icon in the Linear Memory Navigator\n   */\n  nextPage: 'Next page',\n  /**\n   *@description Text to refresh the page\n   */\n  refresh: 'Refresh',\n};\nconst str_ =\n    i18n.i18n.registerUIStrings('panels/linear_memory_inspector/components/LinearMemoryNavigator.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {render, html} = LitHtml;\n\nexport const enum Navigation {\n  Backward = 'Backward',\n  Forward = 'Forward',\n}\n\nexport class AddressInputChangedEvent extends Event {\n  static readonly eventName = 'addressinputchanged';\n  data: {address: string, mode: Mode};\n\n  constructor(address: string, mode: Mode) {\n    super(AddressInputChangedEvent.eventName);\n    this.data = {address, mode};\n  }\n}\n\nexport class PageNavigationEvent extends Event {\n  static readonly eventName = 'pagenavigation';\n  data: Navigation;\n\n  constructor(navigation: Navigation) {\n    super(PageNavigationEvent.eventName, {});\n    this.data = navigation;\n  }\n}\n\nexport class HistoryNavigationEvent extends Event {\n  static readonly eventName = 'historynavigation';\n  data: Navigation;\n\n  constructor(navigation: Navigation) {\n    super(HistoryNavigationEvent.eventName, {});\n    this.data = navigation;\n  }\n}\n\nexport class RefreshRequestedEvent extends Event {\n  static readonly eventName = 'refreshrequested';\n  constructor() {\n    super(RefreshRequestedEvent.eventName, {});\n  }\n}\n\nexport interface LinearMemoryNavigatorData {\n  address: string;\n  mode: Mode;\n  canGoBackInHistory: boolean;\n  canGoForwardInHistory: boolean;\n  valid: boolean;\n  error: string|undefined;\n}\n\nexport const enum Mode {\n  Edit = 'Edit',\n  Submitted = 'Submitted',\n  InvalidSubmit = 'InvalidSubmit',\n}\n\nexport class LinearMemoryNavigator extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-linear-memory-inspector-navigator`;\n\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #address = '0';\n  #error: string|undefined = undefined;\n  #valid = true;\n  #canGoBackInHistory = false;\n  #canGoForwardInHistory = false;\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [linearMemoryNavigatorStyles];\n  }\n\n  set data(data: LinearMemoryNavigatorData) {\n    this.#address = data.address;\n    this.#error = data.error;\n    this.#valid = data.valid;\n    this.#canGoBackInHistory = data.canGoBackInHistory;\n    this.#canGoForwardInHistory = data.canGoForwardInHistory;\n    this.#render();\n\n    const addressInput = this.#shadow.querySelector<HTMLInputElement>('.address-input');\n    if (addressInput) {\n      if (data.mode === Mode.Submitted) {\n        addressInput.blur();\n      } else if (data.mode === Mode.InvalidSubmit) {\n        addressInput.select();\n      }\n    }\n  }\n\n  #render(): void {\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    const result = html`\n      <div class=\"navigator\">\n        <div class=\"navigator-item\">\n          ${this.#createButton({icon: 'undo', title: i18nString(UIStrings.goBackInAddressHistory),\n              event: new HistoryNavigationEvent(Navigation.Backward), enabled: this.#canGoBackInHistory,\n              jslogContext:'linear-memory-inspector.history-back'})}\n          ${this.#createButton({icon: 'redo', title: i18nString(UIStrings.goForwardInAddressHistory),\n              event: new HistoryNavigationEvent(Navigation.Forward), enabled: this.#canGoForwardInHistory,\n              jslogContext:'linear-memory-inspector.history-forward'})}\n        </div>\n        <div class=\"navigator-item\">\n          ${this.#createButton({icon: 'chevron-left', title: i18nString(UIStrings.previousPage),\n              event: new PageNavigationEvent(Navigation.Backward), enabled: true,\n              jslogContext:'linear-memory-inspector.previous-page'})}\n          ${this.#createAddressInput()}\n          ${this.#createButton({icon: 'chevron-right', title: i18nString(UIStrings.nextPage),\n              event: new PageNavigationEvent(Navigation.Forward), enabled: true,\n              jslogContext:'linear-memory-inspector.next-page'})}\n        </div>\n        ${this.#createButton({icon: 'refresh', title: i18nString(UIStrings.refresh),\n            event: new RefreshRequestedEvent(), enabled: true,\n            jslogContext:'linear-memory-inspector.refresh'})}\n      </div>\n      `;\n      render(result, this.#shadow, {host: this});\n    // clang-format on\n  }\n\n  #createAddressInput(): LitHtml.TemplateResult {\n    const classMap = {\n      'address-input': true,\n      invalid: !this.#valid,\n    };\n    return html`\n      <input class=${LitHtml.Directives.classMap(classMap)} data-input=\"true\" .value=${this.#address}\n        jslog=${VisualLogging.textField('linear-memory-inspector.address').track({\n      change: true,\n    })}\n        title=${this.#valid ? i18nString(UIStrings.enterAddress) : this.#error} @change=${\n        this.#onAddressChange.bind(this, Mode.Submitted)} @input=${this.#onAddressChange.bind(this, Mode.Edit)}/>`;\n  }\n\n  #onAddressChange(mode: Mode, event: Event): void {\n    const addressInput = event.target as HTMLInputElement;\n    this.dispatchEvent(new AddressInputChangedEvent(addressInput.value, mode));\n  }\n\n  #createButton(data: {icon: string, title: string, event: Event, enabled: boolean, jslogContext: string}):\n      LitHtml.TemplateResult {\n    return html`\n      <button class=\"navigator-button\" ?disabled=${!data.enabled}\n        jslog=${VisualLogging.action().track({click: true, keydown: 'Enter'}).context(data.jslogContext)}\n        data-button=${data.event.type} title=${data.title}\n        @click=${this.dispatchEvent.bind(this, data.event)}>\n        <${IconButton.Icon.Icon.litTagName} name=${data.icon}></${IconButton.Icon.Icon.litTagName}>\n      </button>`;\n  }\n}\n\ncustomElements.define('devtools-linear-memory-inspector-navigator', LinearMemoryNavigator);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-linear-memory-inspector-navigator': LinearMemoryNavigator;\n  }\n}\n"]}