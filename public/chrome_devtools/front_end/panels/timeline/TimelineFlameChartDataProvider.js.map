{"version":3,"file":"TimelineFlameChartDataProvider.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineFlameChartDataProvider.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2014 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport type * as TimelineModel from '../../models/timeline_model/timeline_model.js';\nimport * as TraceEngine from '../../models/trace/trace.js';\nimport * as ModificationsManager from '../../services/modifications_manager/modifications_manager.js';\nimport * as PerfUI from '../../ui/legacy/components/perf_ui/perf_ui.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as ThemeSupport from '../../ui/legacy/theme_support/theme_support.js';\n\nimport {CompatibilityTracksAppender, type TrackAppenderName} from './CompatibilityTracksAppender.js';\nimport * as Components from './components/components.js';\nimport {initiatorsDataToDraw} from './Initiators.js';\nimport {ThreadAppender} from './ThreadAppender.js';\nimport timelineFlamechartPopoverStyles from './timelineFlamechartPopover.css.js';\nimport {FlameChartStyle, Selection} from './TimelineFlameChartView.js';\nimport {TimelineSelection} from './TimelineSelection.js';\n\nconst UIStrings = {\n  /**\n   *@description Text for rendering frames\n   */\n  frames: 'Frames',\n  /**\n   *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n   */\n  idleFrame: 'Idle Frame',\n  /**\n   *@description Text in Timeline Frame Chart Data Provider of the Performance panel\n   */\n  droppedFrame: 'Dropped Frame',\n  /**\n   *@description Text in Timeline Frame Chart Data Provider of the Performance panel\n   */\n  partiallyPresentedFrame: 'Partially Presented Frame',\n  /**\n   *@description Text for a rendering frame\n   */\n  frame: 'Frame',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/TimelineFlameChartDataProvider.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\n// Frames are special cased because we don't render them as a normal track, hence the distinction here.\nexport type TimelineFlameChartEntry =\n    TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame|TraceEngine.Types.TraceEvents.TraceEventData;\n\nexport class TimelineFlameChartDataProvider extends Common.ObjectWrapper.ObjectWrapper<EventTypes> implements\n    PerfUI.FlameChart.FlameChartDataProvider {\n  private droppedFramePatternCanvas: HTMLCanvasElement;\n  private partialFramePatternCanvas: HTMLCanvasElement;\n  private timelineDataInternal: PerfUI.FlameChart.FlameChartTimelineData|null;\n  private currentLevel: number;\n\n  // The Performance and the Timeline models are expected to be\n  // deprecated in favor of using traceEngineData (new RPP engine) only\n  // as part of the work in crbug.com/1386091. For this reason they\n  // have the \"legacy\" prefix on their name.\n  private compatibilityTracksAppender: CompatibilityTracksAppender|null;\n  private traceEngineData: TraceEngine.Handlers.Types.TraceParseData|null;\n  private isCpuProfile = false;\n\n  private minimumBoundaryInternal: number;\n  private timeSpan: number;\n  private readonly headerLevel1: PerfUI.FlameChart.GroupStyle;\n  private readonly headerLevel2: PerfUI.FlameChart.GroupStyle;\n  private readonly staticHeader: PerfUI.FlameChart.GroupStyle;\n  private framesHeader: PerfUI.FlameChart.GroupStyle;\n  private readonly screenshotsHeader: PerfUI.FlameChart.GroupStyle;\n  private entryData!: TimelineFlameChartEntry[];\n  private entryTypeByLevel!: EntryType[];\n  private screenshotImageCache!: Map<TraceEngine.Types.TraceEvents.SyntheticScreenshot, HTMLImageElement|null>;\n  private entryIndexToTitle!: string[];\n  private lastInitiatorEntry!: number;\n  private lastInitiatorsData: PerfUI.FlameChart.FlameChartInitiatorData[] = [];\n  private lastSelection?: Selection;\n  #font: string;\n  #eventIndexByEvent: WeakMap<\n      TraceEngine.Types.TraceEvents.TraceEventData|TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame,\n      number|null> = new WeakMap();\n\n  constructor() {\n    super();\n    this.reset();\n    this.#font = `${PerfUI.Font.DEFAULT_FONT_SIZE} ${PerfUI.Font.getFontFamilyForCanvas()}`;\n    this.droppedFramePatternCanvas = document.createElement('canvas');\n    this.partialFramePatternCanvas = document.createElement('canvas');\n    this.preparePatternCanvas();\n    this.timelineDataInternal = null;\n    this.currentLevel = 0;\n    this.compatibilityTracksAppender = null;\n    this.traceEngineData = null;\n    this.minimumBoundaryInternal = 0;\n    this.timeSpan = 0;\n\n    this.headerLevel1 = this.buildGroupStyle({shareHeaderLine: false});\n    this.headerLevel2 = this.buildGroupStyle({padding: 2, nestingLevel: 1, collapsible: false});\n    this.staticHeader = this.buildGroupStyle({collapsible: false});\n    this.framesHeader = this.buildGroupStyle({useFirstLineForOverview: true});\n    this.screenshotsHeader =\n        this.buildGroupStyle({useFirstLineForOverview: true, nestingLevel: 1, collapsible: false, itemsHeight: 150});\n\n    ThemeSupport.ThemeSupport.instance().addEventListener(ThemeSupport.ThemeChangeEvent.eventName, () => {\n      const headers = [\n        this.headerLevel1,\n        this.headerLevel2,\n        this.staticHeader,\n        this.framesHeader,\n        this.screenshotsHeader,\n      ];\n      for (const header of headers) {\n        header.color = ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-on-surface');\n        header.backgroundColor =\n            ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-cdt-base-container');\n      }\n    });\n  }\n\n  hasTrackConfigurationMode(): boolean {\n    return true;\n  }\n\n  modifyTree(node: number, action: TraceEngine.EntriesFilter.FilterAction): void {\n    const entry = this.entryData[node] as TraceEngine.Types.TraceEvents.SyntheticTraceEntry;\n\n    ModificationsManager.ModificationsManager.ModificationsManager.activeManager()\n        ?.getEntriesFilter()\n        .applyFilterAction({type: action, entry});\n  }\n\n  findPossibleContextMenuActions(node: number): TraceEngine.EntriesFilter.PossibleFilterActions|void {\n    const entry = this.entryData[node] as TraceEngine.Types.TraceEvents.SyntheticTraceEntry;\n    return ModificationsManager.ModificationsManager.ModificationsManager.activeManager()\n        ?.getEntriesFilter()\n        .findPossibleActions(entry);\n  }\n\n  private buildGroupStyle(extra: Object): PerfUI.FlameChart.GroupStyle {\n    const defaultGroupStyle = {\n      padding: 4,\n      height: 17,\n      collapsible: true,\n      color: ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-on-surface'),\n      backgroundColor: ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-cdt-base-container'),\n      nestingLevel: 0,\n      shareHeaderLine: true,\n    };\n    return Object.assign(defaultGroupStyle, extra);\n  }\n\n  setModel(traceEngineData: TraceEngine.Handlers.Types.TraceParseData|null, isCpuProfile = false): void {\n    this.reset();\n    this.traceEngineData = traceEngineData;\n\n    this.isCpuProfile = isCpuProfile;\n    if (traceEngineData) {\n      const {traceBounds} = traceEngineData.Meta;\n      const minTime = TraceEngine.Helpers.Timing.microSecondsToMilliseconds(traceBounds.min);\n      const maxTime = TraceEngine.Helpers.Timing.microSecondsToMilliseconds(traceBounds.max);\n      this.minimumBoundaryInternal = minTime;\n      this.timeSpan = minTime === maxTime ? 1000 : maxTime - this.minimumBoundaryInternal;\n    }\n  }\n\n  /**\n   * Instances and caches a CompatibilityTracksAppender using the\n   * internal flame chart data and the trace parsed data coming from the\n   * trace engine.\n   * The model data must have been set to the data provider instance before\n   * attempting to instance the CompatibilityTracksAppender.\n   */\n  compatibilityTracksAppenderInstance(forceNew = false): CompatibilityTracksAppender {\n    if (!this.compatibilityTracksAppender || forceNew) {\n      if (!this.traceEngineData) {\n        throw new Error(\n            'Attempted to instantiate a CompatibilityTracksAppender without having set the trace parse data first.');\n      }\n      this.timelineDataInternal = this.#instantiateTimelineData();\n      this.compatibilityTracksAppender = new CompatibilityTracksAppender(\n          this.timelineDataInternal, this.traceEngineData, this.entryData, this.entryTypeByLevel);\n    }\n    return this.compatibilityTracksAppender;\n  }\n\n  /**\n   * Returns the instance of the timeline flame chart data, without\n   * adding data to it. In case the timeline data hasn't been instanced\n   * creates a new instance and returns it.\n   */\n  #instantiateTimelineData(): PerfUI.FlameChart.FlameChartTimelineData {\n    if (!this.timelineDataInternal) {\n      this.timelineDataInternal = PerfUI.FlameChart.FlameChartTimelineData.createEmpty();\n    }\n    return this.timelineDataInternal;\n  }\n\n  /**\n   * Builds the flame chart data using the track appenders\n   */\n  buildFromTrackAppenders(options?: {filterThreadsByName?: string, expandedTracks?: Set<TrackAppenderName>}): void {\n    if (!this.compatibilityTracksAppender) {\n      return;\n    }\n    const appenders = this.compatibilityTracksAppender.allVisibleTrackAppenders();\n    for (const appender of appenders) {\n      const skipThreadAppenderByName =\n          appender instanceof ThreadAppender && !appender.trackName().includes(options?.filterThreadsByName || '');\n      if (skipThreadAppenderByName) {\n        continue;\n      }\n      const expanded = Boolean(options?.expandedTracks?.has(appender.appenderName));\n      this.currentLevel = appender.appendTrackAtLevel(this.currentLevel, expanded);\n    }\n  }\n\n  groupTreeEvents(group: PerfUI.FlameChart.Group): TraceEngine.Types.TraceEvents.TraceEventData[]|null {\n    return this.compatibilityTracksAppender?.groupEventsForTreeView(group) ?? null;\n  }\n\n  mainFrameNavigationStartEvents(): readonly TraceEngine.Types.TraceEvents.TraceEventNavigationStart[] {\n    if (!this.traceEngineData) {\n      return [];\n    }\n    return this.traceEngineData.Meta.mainFrameNavigations;\n  }\n\n  entryTitle(entryIndex: number): string|null {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.Screenshot) {\n      return '';\n    }\n    if (entryType === EntryType.TrackAppender) {\n      const timelineData = (this.timelineDataInternal as PerfUI.FlameChart.FlameChartTimelineData);\n      const eventLevel = timelineData.entryLevels[entryIndex];\n      const event = (this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData);\n      return this.compatibilityTracksAppender?.titleForEvent(event, eventLevel) || null;\n    }\n    let title: Common.UIString.LocalizedString|string = this.entryIndexToTitle[entryIndex];\n    if (!title) {\n      title = `Unexpected entryIndex ${entryIndex}`;\n      console.error(title);\n    }\n    return title;\n  }\n\n  textColor(index: number): string {\n    const event = this.entryData[index];\n    if (!TimelineFlameChartDataProvider.timelineEntryIsTraceEvent(event)) {\n      return FlameChartStyle.textColor;\n    }\n    return this.isIgnoreListedEvent(event) ? '#888' : FlameChartStyle.textColor;\n  }\n\n  entryFont(_index: number): string|null {\n    return this.#font;\n  }\n\n  // resetCompatibilityTracksAppender boolean set to false does not recreate the thread appenders\n  reset(resetCompatibilityTracksAppender: boolean = true): void {\n    this.currentLevel = 0;\n    this.entryData = [];\n    this.entryTypeByLevel = [];\n    this.entryIndexToTitle = [];\n    this.screenshotImageCache = new Map();\n    this.#eventIndexByEvent = new Map();\n    if (resetCompatibilityTracksAppender) {\n      this.compatibilityTracksAppender = null;\n      this.timelineDataInternal = null;\n    } else if (!resetCompatibilityTracksAppender && this.timelineDataInternal) {\n      this.compatibilityTracksAppender?.setFlameChartDataAndEntryData(\n          this.timelineDataInternal, this.entryData, this.entryTypeByLevel);\n      this.compatibilityTracksAppender?.threadAppenders().forEach(\n          threadAppender => threadAppender.setHeaderAppended(false));\n    }\n  }\n\n  maxStackDepth(): number {\n    return this.currentLevel;\n  }\n\n  /**\n   * Builds the flame chart data using the tracks appender (which use\n   * the new trace engine) and the legacy code paths present in this\n   * file. The result built data is cached and returned.\n   */\n  timelineData(rebuild: boolean = false): PerfUI.FlameChart.FlameChartTimelineData {\n    if (this.timelineDataInternal && this.timelineDataInternal.entryLevels.length !== 0 && !rebuild) {\n      // The flame chart data is built already, so return the cached\n      // data.\n      return this.timelineDataInternal;\n    }\n\n    this.timelineDataInternal = PerfUI.FlameChart.FlameChartTimelineData.createEmpty();\n\n    if (rebuild) {\n      this.reset(/* resetCompatibilityTracksAppender= */ false);\n    }\n\n    this.currentLevel = 0;\n\n    if (this.traceEngineData) {\n      this.compatibilityTracksAppender = this.compatibilityTracksAppenderInstance();\n      if (this.traceEngineData.Meta.traceIsGeneric) {\n        this.#processGenericTrace();\n      } else {\n        this.#processInspectorTrace();\n      }\n    }\n\n    return this.timelineDataInternal;\n  }\n\n  #processGenericTrace(): void {\n    if (!this.compatibilityTracksAppender) {\n      return;\n    }\n\n    const appendersByProcess = this.compatibilityTracksAppender.allThreadAppendersByProcess();\n\n    for (const [pid, threadAppenders] of appendersByProcess) {\n      const processGroupStyle = this.buildGroupStyle({shareHeaderLine: false});\n      const processName = this.traceEngineData?.Meta.processNames.get(pid)?.args.name || 'Process';\n      this.appendHeader(`${processName} (${pid})`, processGroupStyle, true, false);\n      for (const appender of threadAppenders) {\n        appender.setHeaderNestingLevel(1);\n        this.currentLevel = appender.appendTrackAtLevel(this.currentLevel);\n      }\n    }\n  }\n\n  #processInspectorTrace(): void {\n    if (!this.isCpuProfile) {\n      // CPU Profiles do not have frames and screenshots.\n      this.#appendFramesAndScreenshotsTrack();\n    }\n\n    const weight = (track: {type?: string, forMainFrame?: boolean, appenderName?: TrackAppenderName}): number => {\n      switch (track.appenderName) {\n        case 'Animations':\n          return 0;\n        case 'Timings':\n          return 1;\n        case 'Interactions':\n          return 2;\n        case 'LayoutShifts':\n          return 3;\n        case 'GPU':\n          return 8;\n        case 'Thread':\n          return 4;\n        case 'Thread_AuctionWorklet':\n          return 10;\n        case 'Extension':\n          return 11;\n        default:\n          return 12;\n      }\n    };\n\n    const allTrackAppenders =\n        this.compatibilityTracksAppender ? this.compatibilityTracksAppender.allVisibleTrackAppenders() : [];\n\n    allTrackAppenders.sort((a, b) => weight(a) - weight(b));\n\n    for (const appender of allTrackAppenders) {\n      if (!this.traceEngineData) {\n        continue;\n      }\n\n      this.currentLevel = appender.appendTrackAtLevel(this.currentLevel);\n\n      // If there is not a selected group, we want to default to selecting the\n      // main thread track. Therefore in this check we look to see if the\n      // current appender is a ThreadAppender and represnets the Main Thread.\n      // If it is, we mark the group as selected.\n      if (this.timelineDataInternal && !this.timelineDataInternal.selectedGroup) {\n        if (appender instanceof ThreadAppender &&\n            (appender.threadType === TraceEngine.Handlers.Threads.ThreadType.MAIN_THREAD ||\n             appender.threadType === TraceEngine.Handlers.Threads.ThreadType.CPU_PROFILE)) {\n          const group = this.compatibilityTracksAppender?.groupForAppender(appender);\n          if (group) {\n            this.timelineDataInternal.selectedGroup = group;\n          }\n        }\n      }\n    }\n    if (this.timelineDataInternal && this.timelineDataInternal.selectedGroup) {\n      this.timelineDataInternal.selectedGroup.expanded = true;\n    }\n  }\n\n  minimumBoundary(): number {\n    return this.minimumBoundaryInternal;\n  }\n\n  totalTime(): number {\n    return this.timeSpan;\n  }\n\n  static timelineEntryIsTraceEvent(entry: TimelineFlameChartEntry):\n      entry is TraceEngine.Types.TraceEvents.TraceEventData {\n    return entry instanceof TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame === false;\n  }\n\n  search(\n      startTime: TraceEngine.Types.Timing.MilliSeconds, endTime: TraceEngine.Types.Timing.MilliSeconds,\n      filter: TimelineModel.TimelineModelFilter.TimelineModelFilter): number[] {\n    const result = [];\n    this.timelineData();\n    for (let i = 0; i < this.entryData.length; ++i) {\n      const entry = this.entryData[i];\n      if (!entry) {\n        continue;\n      }\n\n      if (!TimelineFlameChartDataProvider.timelineEntryIsTraceEvent(entry)) {\n        // We only search for events, not for frames, hence this early exit.\n        continue;\n      }\n\n      const entryStartTime = TraceEngine.Helpers.Timing.eventTimingsMilliSeconds(entry).startTime;\n      const entryEndTime = TraceEngine.Helpers.Timing.eventTimingsMilliSeconds(entry).endTime;\n\n      if (entryStartTime > endTime) {\n        continue;\n      }\n      if ((entryEndTime || entryStartTime) < startTime) {\n        continue;\n      }\n      if (filter.accept(entry, this.traceEngineData || undefined)) {\n        result.push(i);\n      }\n    }\n    result.sort((a, b) => {\n      const firstEvent = this.entryData.at(a);\n      if (!firstEvent) {\n        return 0;\n      }\n      const secondEvent = this.entryData.at(b);\n      if (!secondEvent) {\n        return 0;\n      }\n\n      if (!TimelineFlameChartDataProvider.timelineEntryIsTraceEvent(firstEvent) ||\n          !TimelineFlameChartDataProvider.timelineEntryIsTraceEvent(secondEvent)) {\n        return 0;\n      }\n\n      return TraceEngine.Helpers.Trace.eventTimeComparator(firstEvent, secondEvent);\n    });\n    return result;\n  }\n\n  isIgnoreListedEvent(event: TraceEngine.Types.TraceEvents.TraceEventData): boolean {\n    if (TraceEngine.Types.TraceEvents.isProfileCall(event)) {\n      return this.isIgnoreListedURL(event.callFrame.url as Platform.DevToolsPath.UrlString);\n    }\n    return false;\n  }\n\n  private isIgnoreListedURL(url: Platform.DevToolsPath.UrlString): boolean {\n    return Bindings.IgnoreListManager.IgnoreListManager.instance().isUserIgnoreListedURL(url);\n  }\n\n  getEntryTypeForLevel(level: number): EntryType {\n    return this.entryTypeByLevel[level];\n  }\n\n  /**\n   * The frames and screenshots track is special cased because it is rendered\n   * differently to the rest of the tracks and not as a series of events. This\n   * is why it is not done via the appender system; we track frames &\n   * screenshots as a different EntryType to the TrackAppender entries,\n   * because then when it comes to drawing we can decorate them differently.\n   **/\n  #appendFramesAndScreenshotsTrack(): void {\n    if (!this.traceEngineData) {\n      return;\n    }\n    const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(this.traceEngineData);\n    const hasScreenshots = filmStrip.frames.length > 0;\n\n    this.framesHeader.collapsible = hasScreenshots;\n    const expanded = Root.Runtime.Runtime.queryParam('flamechart-force-expand') === 'frames';\n\n    this.appendHeader(i18nString(UIStrings.frames), this.framesHeader, false /* selectable */, expanded);\n\n    this.entryTypeByLevel[this.currentLevel] = EntryType.Frame;\n    for (const frame of this.traceEngineData.Frames.frames) {\n      this.#appendNewEngineFrame(frame);\n    }\n    ++this.currentLevel;\n\n    if (!hasScreenshots) {\n      return;\n    }\n    this.#appendScreenshots(filmStrip);\n  }\n\n  #appendScreenshots(filmStrip: TraceEngine.Extras.FilmStrip.Data): void {\n    if (!this.timelineDataInternal || !this.traceEngineData) {\n      return;\n    }\n    this.appendHeader('', this.screenshotsHeader, false /* selectable */);\n    this.entryTypeByLevel[this.currentLevel] = EntryType.Screenshot;\n    let prevTimestamp: TraceEngine.Types.Timing.MilliSeconds|undefined = undefined;\n\n    for (const filmStripFrame of filmStrip.frames) {\n      const screenshotTimeInMilliSeconds =\n          TraceEngine.Helpers.Timing.microSecondsToMilliseconds(filmStripFrame.screenshotEvent.ts);\n      this.entryData.push(filmStripFrame.screenshotEvent);\n      (this.timelineDataInternal.entryLevels as number[]).push(this.currentLevel);\n      (this.timelineDataInternal.entryStartTimes as number[]).push(screenshotTimeInMilliSeconds);\n      if (prevTimestamp) {\n        (this.timelineDataInternal.entryTotalTimes as number[]).push(screenshotTimeInMilliSeconds - prevTimestamp);\n      }\n      prevTimestamp = screenshotTimeInMilliSeconds;\n    }\n    if (filmStrip.frames.length && prevTimestamp !== undefined) {\n      const maxRecordTimeMillis =\n          TraceEngine.Helpers.Timing.traceWindowMilliSeconds(this.traceEngineData.Meta.traceBounds).max;\n\n      // Set the total time of the final screenshot so it takes up the remainder of the trace.\n      (this.timelineDataInternal.entryTotalTimes as number[]).push(maxRecordTimeMillis - prevTimestamp);\n    }\n    ++this.currentLevel;\n  }\n\n  #entryTypeForIndex(entryIndex: number): EntryType {\n    const level = this.timelineData().entryLevels[entryIndex];\n    return this.entryTypeByLevel[level];\n  }\n  prepareHighlightedEntryInfo(entryIndex: number): Element|null {\n    let time = '';\n    let title;\n    let warningElements: Element[] = [];\n    let nameSpanTimelineInfoTime = 'timeline-info-time';\n\n    const additionalContent: HTMLElement[] = [];\n\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.TrackAppender) {\n      if (!this.compatibilityTracksAppender) {\n        return null;\n      }\n      const event = (this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData);\n      const timelineData = (this.timelineDataInternal as PerfUI.FlameChart.FlameChartTimelineData);\n      const eventLevel = timelineData.entryLevels[entryIndex];\n      const highlightedEntryInfo = this.compatibilityTracksAppender.highlightedEntryInfo(event, eventLevel);\n      title = highlightedEntryInfo.title;\n      time = highlightedEntryInfo.formattedTime;\n      warningElements = highlightedEntryInfo.warningElements || warningElements;\n      if (TraceEngine.Types.TraceEvents.isSyntheticInteractionEvent(event)) {\n        const breakdown = new Components.InteractionBreakdown.InteractionBreakdown();\n        breakdown.entry = event;\n        additionalContent.push(breakdown);\n      }\n    } else if (entryType === EntryType.Frame) {\n      const frame = (this.entryData[entryIndex] as TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame);\n      time = i18n.TimeUtilities.preciseMillisToString(\n          TraceEngine.Helpers.Timing.microSecondsToMilliseconds(frame.duration), 1);\n\n      if (frame.idle) {\n        title = i18nString(UIStrings.idleFrame);\n      } else if (frame.dropped) {\n        if (frame.isPartial) {\n          title = i18nString(UIStrings.partiallyPresentedFrame);\n        } else {\n          title = i18nString(UIStrings.droppedFrame);\n        }\n        nameSpanTimelineInfoTime = 'timeline-info-warning';\n      } else {\n        title = i18nString(UIStrings.frame);\n      }\n    } else {\n      return null;\n    }\n\n    const element = document.createElement('div');\n    const root = UI.UIUtils.createShadowRootWithCoreStyles(element, {\n      cssFile: [timelineFlamechartPopoverStyles],\n      delegatesFocus: undefined,\n    });\n    const contents = root.createChild('div', 'timeline-flamechart-popover');\n    contents.createChild('span', nameSpanTimelineInfoTime).textContent = time;\n    contents.createChild('span', 'timeline-info-title').textContent = title;\n    if (warningElements) {\n      for (const warningElement of warningElements) {\n        warningElement.classList.add('timeline-info-warning');\n        contents.appendChild(warningElement);\n      }\n    }\n    for (const elem of additionalContent) {\n      contents.appendChild(elem);\n    }\n    return element;\n  }\n\n  prepareHighlightedHiddenEntriesArrowInfo(entryIndex: number): Element|null {\n    const element = document.createElement('div');\n    const root = UI.UIUtils.createShadowRootWithCoreStyles(element, {\n      cssFile: [timelineFlamechartPopoverStyles],\n      delegatesFocus: undefined,\n    });\n\n    const entry = this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.SyntheticTraceEntry;\n    const hiddenEntriesAmount = ModificationsManager.ModificationsManager.ModificationsManager.activeManager()\n                                    ?.getEntriesFilter()\n                                    .findHiddenDescendantsAmount(entry);\n\n    if (!hiddenEntriesAmount) {\n      return null;\n    }\n    const contents = root.createChild('div', 'timeline-flamechart-popover');\n    contents.createChild('span', 'timeline-info-title').textContent = hiddenEntriesAmount + ' hidden';\n\n    return element;\n  }\n\n  entryColor(entryIndex: number): string {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.Frame) {\n      return 'white';\n    }\n    if (entryType === EntryType.TrackAppender) {\n      const timelineData = (this.timelineDataInternal as PerfUI.FlameChart.FlameChartTimelineData);\n      const eventLevel = timelineData.entryLevels[entryIndex];\n      const event = (this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData);\n      return this.compatibilityTracksAppender?.colorForEvent(event, eventLevel) || '';\n    }\n    return '';\n  }\n\n  private preparePatternCanvas(): void {\n    // Set the candy stripe pattern to 17px so it repeats well.\n    const size = 17;\n    this.droppedFramePatternCanvas.width = size;\n    this.droppedFramePatternCanvas.height = size;\n\n    this.partialFramePatternCanvas.width = size;\n    this.partialFramePatternCanvas.height = size;\n\n    const ctx = this.droppedFramePatternCanvas.getContext('2d');\n    if (ctx) {\n      // Make a dense solid-line pattern.\n      ctx.translate(size * 0.5, size * 0.5);\n      ctx.rotate(Math.PI * 0.25);\n      ctx.translate(-size * 0.5, -size * 0.5);\n\n      ctx.fillStyle = 'rgb(255, 255, 255)';\n      for (let x = -size; x < size * 2; x += 3) {\n        ctx.fillRect(x, -size, 1, size * 3);\n      }\n    }\n\n    const ctx2 = this.partialFramePatternCanvas.getContext('2d');\n    if (ctx2) {\n      // Make a sparse dashed-line pattern.\n      ctx2.strokeStyle = 'rgb(255, 255, 255)';\n      ctx2.lineWidth = 2;\n      ctx2.beginPath();\n      ctx2.moveTo(17, 0);\n      ctx2.lineTo(10, 7);\n      ctx2.moveTo(8, 9);\n      ctx2.lineTo(2, 15);\n      ctx2.stroke();\n    }\n  }\n\n  private drawFrame(\n      entryIndex: number, context: CanvasRenderingContext2D, text: string|null, barX: number, barY: number,\n      barWidth: number, barHeight: number): void {\n    const hPadding = 1;\n    const frame = (this.entryData[entryIndex] as TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame);\n    barX += hPadding;\n    barWidth -= 2 * hPadding;\n    if (frame.idle) {\n      context.fillStyle = 'white';\n    } else if (frame.dropped) {\n      if (frame.isPartial) {\n        // For partially presented frame boxes, paint a yellow background with\n        // a sparse white dashed-line pattern overlay.\n        context.fillStyle = '#f0e442';\n        context.fillRect(barX, barY, barWidth, barHeight);\n\n        const overlay = context.createPattern(this.partialFramePatternCanvas, 'repeat');\n        context.fillStyle = overlay || context.fillStyle;\n      } else {\n        // For dropped frame boxes, paint a red background with a dense white\n        // solid-line pattern overlay.\n        context.fillStyle = '#f08080';\n        context.fillRect(barX, barY, barWidth, barHeight);\n\n        const overlay = context.createPattern(this.droppedFramePatternCanvas, 'repeat');\n        context.fillStyle = overlay || context.fillStyle;\n      }\n    } else {\n      context.fillStyle = '#d7f0d1';\n    }\n    context.fillRect(barX, barY, barWidth, barHeight);\n\n    const frameDurationText = i18n.TimeUtilities.preciseMillisToString(\n        TraceEngine.Helpers.Timing.microSecondsToMilliseconds(frame.duration), 1);\n    const textWidth = context.measureText(frameDurationText).width;\n    if (textWidth <= barWidth) {\n      context.fillStyle = this.textColor(entryIndex);\n      context.fillText(frameDurationText, barX + (barWidth - textWidth) / 2, barY + barHeight - 4);\n    }\n  }\n\n  private async drawScreenshot(\n      entryIndex: number, context: CanvasRenderingContext2D, barX: number, barY: number, barWidth: number,\n      barHeight: number): Promise<void> {\n    const screenshot = (this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.SyntheticScreenshot);\n    if (!this.screenshotImageCache.has(screenshot)) {\n      this.screenshotImageCache.set(screenshot, null);\n      const data = screenshot.args.dataUri;\n      const image = await UI.UIUtils.loadImage(data);\n      this.screenshotImageCache.set(screenshot, image);\n      this.dispatchEventToListeners(Events.DataChanged);\n      return;\n    }\n\n    const image = this.screenshotImageCache.get(screenshot);\n    if (!image) {\n      return;\n    }\n    const imageX = barX + 1;\n    const imageY = barY + 1;\n    const imageHeight = barHeight - 2;\n    const scale = imageHeight / image.naturalHeight;\n    const imageWidth = Math.floor(image.naturalWidth * scale);\n    context.save();\n    context.beginPath();\n    context.rect(barX, barY, barWidth, barHeight);\n    context.clip();\n    context.drawImage(image, imageX, imageY, imageWidth, imageHeight);\n    context.strokeStyle = '#ccc';\n    context.strokeRect(imageX - 0.5, imageY - 0.5, Math.min(barWidth - 1, imageWidth + 1), imageHeight);\n    context.restore();\n  }\n\n  decorateEntry(\n      entryIndex: number, context: CanvasRenderingContext2D, text: string|null, barX: number, barY: number,\n      barWidth: number, barHeight: number, unclippedBarX: number, timeToPixelRatio: number): boolean {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n\n    if (entryType === EntryType.Frame) {\n      this.drawFrame(entryIndex, context, text, barX, barY, barWidth, barHeight);\n      return true;\n    }\n\n    if (entryType === EntryType.Screenshot) {\n      void this.drawScreenshot(entryIndex, context, barX, barY, barWidth, barHeight);\n      return true;\n    }\n\n    if (entryType === EntryType.TrackAppender) {\n      const entry = this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData;\n      if (TraceEngine.Types.TraceEvents.isSyntheticInteractionEvent(entry)) {\n        this.#drawInteractionEventWithWhiskers(\n            context, entryIndex, text, entry, barX, barY, unclippedBarX, barWidth, barHeight, timeToPixelRatio);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Draws the left and right whiskers around an interaction in the timeline.\n   * @param context - the canvas that will be drawn onto\n   * @param entryIndex\n   * @param entryTitle - the title of the entry\n   * @param entry - the entry itself\n   * @param barX - the starting X pixel position of the bar representing this event. This is clipped: if the bar is off the left side of the screen, this value will be 0\n   * @param barY - the starting Y pixel position of the bar representing this event.\n   * @param unclippedBarXStartPixel - the starting X pixel position of the bar representing this event, not clipped. This means if the bar is off the left of the screen this will be a negative number.\n   * @param barWidth - the width of the full bar in pixels\n   * @param barHeight - the height of the full bar in pixels\n   * @param timeToPixelRatio - the ratio required to convert a millisecond time to a pixel value.\n   **/\n  #drawInteractionEventWithWhiskers(\n      context: CanvasRenderingContext2D, entryIndex: number, entryTitle: string|null,\n      entry: TraceEngine.Types.TraceEvents.SyntheticInteractionPair, barX: number, barY: number,\n      unclippedBarXStartPixel: number, barWidth: number, barHeight: number, timeToPixelRatio: number): void {\n    /**\n     * An interaction is drawn with whiskers as so:\n     * |----------[=======]-------------|\n     * => The left whisker is the event's start time (event.ts)\n     * => The box start is the event's processingStart time\n     * => The box end is the event's processingEnd time\n     * => The right whisker is the event's end time (event.ts + event.dur)\n     *\n     * When we draw the event in the InteractionsAppender, we draw a huge box\n     * that spans the entire of the above. So here we need to draw over the\n     * rectangle that is outside of {processingStart, processingEnd} and\n     * replace it with the whiskers.\n     * TODO(crbug.com/1495248): rework how we draw whiskers to avoid this inefficiency\n     */\n\n    const beginTime = TraceEngine.Helpers.Timing.microSecondsToMilliseconds(entry.ts);\n    const entireBarEndXPixel = barX + barWidth;\n\n    function timeToPixel(time: TraceEngine.Types.Timing.MicroSeconds): number {\n      const timeMilli = TraceEngine.Helpers.Timing.microSecondsToMilliseconds(time);\n      return Math.floor(unclippedBarXStartPixel + (timeMilli - beginTime) * timeToPixelRatio);\n    }\n\n    context.save();\n\n    // Clear portions of initial rect to prepare for the ticks.\n    context.fillStyle = ThemeSupport.ThemeSupport.instance().getComputedValue('--sys-color-cdt-base-container');\n    let desiredBoxStartX = timeToPixel(entry.processingStart);\n    const desiredBoxEndX = timeToPixel(entry.processingEnd);\n\n    // If the entry has no processing duration, ensure the box is 1px wide so at least it is visible.\n    if (entry.processingEnd - entry.processingStart === 0) {\n      desiredBoxStartX -= 1;\n    }\n\n    context.fillRect(barX, barY - 0.5, desiredBoxStartX - barX, barHeight);\n    context.fillRect(desiredBoxEndX, barY - 0.5, entireBarEndXPixel - desiredBoxEndX, barHeight);\n\n    // Draws left and right whiskers\n    function drawTick(begin: number, end: number, y: number): void {\n      const tickHeightPx = 6;\n      context.moveTo(begin, y - tickHeightPx / 2);\n      context.lineTo(begin, y + tickHeightPx / 2);\n      context.moveTo(begin, y);\n      context.lineTo(end, y);\n    }\n\n    // The left whisker starts at the enty timestamp, and continues until the start of the box (processingStart).\n    const leftWhiskerX = timeToPixel(entry.ts);\n    // The right whisker ends at (entry.ts + entry.dur). We draw the line from the end of the box (processingEnd).\n    const rightWhiskerX = timeToPixel(TraceEngine.Types.Timing.MicroSeconds(entry.ts + entry.dur));\n    context.beginPath();\n    context.lineWidth = 1;\n    context.strokeStyle = '#ccc';\n    const lineY = Math.floor(barY + barHeight / 2) + 0.5;\n    const leftTick = leftWhiskerX + 0.5;\n    const rightTick = rightWhiskerX - 0.5;\n    drawTick(leftTick, desiredBoxStartX, lineY);\n    drawTick(rightTick, desiredBoxEndX, lineY);\n    context.stroke();\n\n    if (entryTitle) {\n      // BarX will be set to 0 if the start of the box if off the screen to the\n      // left. If this happens, the desiredBoxStartX will be negative. In that\n      // case, we fallback to the BarX. This ensures that even if the box\n      // starts off-screen, we draw the text at the first visible on screen\n      // pixels, so the user can still see the event's title.\n      const textStartX = desiredBoxStartX > 0 ? desiredBoxStartX : barX;\n      context.font = this.#font;\n      const textWidth = UI.UIUtils.measureTextWidth(context, entryTitle);\n\n      // These numbers are duplicated from FlameChart.ts.\n      const textPadding = 5;\n      const textBaseline = 5;\n\n      // Only draw the text if it can fit in the amount of box that is visible.\n      if (textWidth <= desiredBoxEndX - textStartX + textPadding) {\n        context.fillStyle = this.textColor(entryIndex);\n        context.fillText(entryTitle, textStartX + textPadding, barY + barHeight - textBaseline);\n      }\n    }\n    context.restore();\n  }\n\n  forceDecoration(entryIndex: number): boolean {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.Frame) {\n      return true;\n    }\n    if (entryType === EntryType.Screenshot) {\n      return true;\n    }\n    const event = (this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData);\n\n    if (TraceEngine.Types.TraceEvents.isSyntheticInteractionEvent(event)) {\n      // We draw interactions with whiskers, which are done via the\n      // decorateEntry() method, hence we always want to force these to be\n      // decorated.\n      return true;\n    }\n    return Boolean(this.traceEngineData?.Warnings.perEvent.get(event));\n  }\n\n  private appendHeader(title: string, style: PerfUI.FlameChart.GroupStyle, selectable: boolean, expanded?: boolean):\n      PerfUI.FlameChart.Group {\n    const group =\n        ({startLevel: this.currentLevel, name: title, style: style, selectable: selectable, expanded} as\n         PerfUI.FlameChart.Group);\n    (this.timelineDataInternal as PerfUI.FlameChart.FlameChartTimelineData).groups.push(group);\n    return group;\n  }\n\n  #appendNewEngineFrame(frame: TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame): void {\n    const index = this.entryData.length;\n    this.entryData.push(frame);\n    const durationMilliseconds = TraceEngine.Helpers.Timing.microSecondsToMilliseconds(frame.duration);\n    this.entryIndexToTitle[index] = i18n.TimeUtilities.millisToString(durationMilliseconds, true);\n    if (!this.timelineDataInternal) {\n      return;\n    }\n    this.timelineDataInternal.entryLevels[index] = this.currentLevel;\n    this.timelineDataInternal.entryTotalTimes[index] = durationMilliseconds;\n    this.timelineDataInternal.entryStartTimes[index] =\n        TraceEngine.Helpers.Timing.microSecondsToMilliseconds(frame.startTime);\n  }\n\n  createSelection(entryIndex: number): TimelineSelection|null {\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    let timelineSelection: TimelineSelection|null = null;\n    const entry = this.entryData[entryIndex];\n    if (entry && TimelineFlameChartDataProvider.timelineEntryIsTraceEvent(entry)) {\n      timelineSelection = TimelineSelection.fromTraceEvent(entry);\n    } else if (entryType === EntryType.Frame) {\n      timelineSelection = TimelineSelection.fromFrame(\n          (this.entryData[entryIndex] as TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame));\n    }\n    if (timelineSelection) {\n      this.lastSelection = new Selection(timelineSelection, entryIndex);\n    }\n    return timelineSelection;\n  }\n\n  formatValue(value: number, precision?: number): string {\n    return i18n.TimeUtilities.preciseMillisToString(value, precision);\n  }\n\n  canJumpToEntry(_entryIndex: number): boolean {\n    return false;\n  }\n\n  entryIndexForSelection(selection: TimelineSelection|null): number {\n    if (!selection || TimelineSelection.isRangeSelection(selection.object) ||\n        TimelineSelection.isSyntheticNetworkRequestDetailsEventSelection(selection.object)) {\n      return -1;\n    }\n\n    if (this.lastSelection && this.lastSelection.timelineSelection.object === selection.object) {\n      return this.lastSelection.entryIndex;\n    }\n\n    // If the index is -1 and the selection is a TraceEvent, it might be\n    // the case that this Entry is hidden by the Context Menu action.\n    // Try revealing the entry and getting the index again.\n    if (this.entryData.indexOf(selection.object) === -1 && TimelineSelection.isTraceEventSelection(selection.object)) {\n      if (this.timelineDataInternal?.selectedGroup) {\n        ModificationsManager.ModificationsManager.ModificationsManager.activeManager()?.getEntriesFilter().revealEntry(\n            selection.object as TraceEngine.Types.TraceEvents.SyntheticTraceEntry);\n        this.timelineData(true);\n      }\n    }\n\n    const index = this.entryData.indexOf(selection.object);\n    if (index !== -1) {\n      this.lastSelection = new Selection(selection, index);\n    }\n    return index;\n  }\n\n  indexForEvent(targetEvent: TraceEngine.Types.TraceEvents.TraceEventData|\n                TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame): number|null {\n    // Gets the index for the given event by walking through the array of entryData.\n    // This may seem inefficient - but we have seen that by building up large\n    // maps keyed by trace events that this has a significant impact on the\n    // performance of the panel.\n    // Therefore, we strike a middle ground: look up the event the first time,\n    // but then cache the result.\n    const fromCache = this.#eventIndexByEvent.get(targetEvent);\n    if (fromCache) {\n      return fromCache;\n    }\n    const index = this.entryData.indexOf(targetEvent);\n    const result = index > -1 ? index : null;\n    this.#eventIndexByEvent.set(targetEvent, result);\n    return result;\n  }\n\n  /**\n   * Build the data for initiators and initiated entries.\n   * @param entryIndex\n   * @returns if we should re-render the flame chart (canvas)\n   */\n  buildFlowForInitiator(entryIndex: number): boolean {\n    if (!this.traceEngineData) {\n      return false;\n    }\n    if (!this.timelineDataInternal) {\n      return false;\n    }\n    if (this.lastInitiatorEntry === entryIndex) {\n      if (this.lastInitiatorsData) {\n        this.timelineDataInternal.initiatorsData = this.lastInitiatorsData;\n      }\n      return false;\n    }\n    if (!this.compatibilityTracksAppender) {\n      return false;\n    }\n\n    // Remove all previously assigned decorations indicating that the flow event entries are hidden\n    const previousInitiatorsDataLength = this.timelineDataInternal.initiatorsData.length;\n    // |entryIndex| equals -1 means there is no entry selected, just clear the\n    // initiator cache if there is any previous arrow and return true to\n    // re-render.\n    if (entryIndex === -1) {\n      this.lastInitiatorEntry = entryIndex;\n      if (previousInitiatorsDataLength === 0) {\n        // This means there is no arrow before, so we don't need to re-render.\n        return false;\n      }\n      // Reset to clear any previous arrows from the last event.\n      this.timelineDataInternal.resetFlowData();\n      return true;\n    }\n\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType !== EntryType.TrackAppender) {\n      return false;\n    }\n    const event = this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData;\n    // Reset to clear any previous arrows from the last event.\n    this.timelineDataInternal.resetFlowData();\n    this.lastInitiatorEntry = entryIndex;\n\n    const hiddenEvents: TraceEngine.Types.TraceEvents.TraceEventData[] =\n        ModificationsManager.ModificationsManager.ModificationsManager.activeManager()\n            ?.getEntriesFilter()\n            .invisibleEntries() ??\n        [];\n    const expandableEntries: TraceEngine.Types.TraceEvents.TraceEventData[] =\n        ModificationsManager.ModificationsManager.ModificationsManager.activeManager()\n            ?.getEntriesFilter()\n            .expandableEntries() ??\n        [];\n\n    const initiatorsData = initiatorsDataToDraw(\n        this.traceEngineData,\n        event,\n        hiddenEvents,\n        expandableEntries,\n    );\n    // This means there is no change for arrows.\n    if (previousInitiatorsDataLength === 0 && initiatorsData.length === 0) {\n      return false;\n    }\n    for (const intiatorData of initiatorsData) {\n      const eventIndex = this.indexForEvent(intiatorData.event);\n      const initiatorIndex = this.indexForEvent(intiatorData.initiator);\n      if (eventIndex === null || initiatorIndex === null) {\n        continue;\n      }\n      this.timelineDataInternal.initiatorsData.push({\n        initiatorIndex,\n        eventIndex,\n        isInitiatorHidden: intiatorData.isInitiatorHidden,\n        isEntryHidden: intiatorData.isEntryHidden,\n      });\n    }\n    this.lastInitiatorsData = this.timelineDataInternal.initiatorsData;\n    return true;\n  }\n\n  eventByIndex(entryIndex: number): TraceEngine.Types.TraceEvents.TraceEventData\n      |TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame|null {\n    if (entryIndex < 0) {\n      return null;\n    }\n    const entryType = this.#entryTypeForIndex(entryIndex);\n    if (entryType === EntryType.TrackAppender) {\n      return this.entryData[entryIndex] as TraceEngine.Types.TraceEvents.TraceEventData;\n    }\n    if (entryType === EntryType.Frame) {\n      return this.entryData[entryIndex] as TraceEngine.Handlers.ModelHandlers.Frames.TimelineFrame;\n    }\n    return null;\n  }\n}\n\nexport const InstantEventVisibleDurationMs = 0.001;\n\nexport const enum Events {\n  DataChanged = 'DataChanged',\n}\n\nexport type EventTypes = {\n  [Events.DataChanged]: void,\n};\n\n// an entry is a trace event, they are classified into \"entry types\"\n// because some events are rendered differently. For example, screenshot\n// events are rendered as images. Checks for entry types allow to have\n// different styles, names, etc. for events that look differently.\n// In the future we won't have this checks: instead we will forward\n// the event to the corresponding \"track appender\" and it will determine\n// how the event shall be rendered.\nexport const enum EntryType {\n  Frame = 'Frame',\n  TrackAppender = 'TrackAppender',\n  Screenshot = 'Screenshot',\n}\n"]}