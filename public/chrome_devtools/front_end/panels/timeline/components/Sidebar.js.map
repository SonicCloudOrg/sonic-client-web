{"version":3,"file":"Sidebar.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/Sidebar.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Root from '../../../core/root/root.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport sidebarStyles from './sidebar.css.js';\n\nconst COLLAPSED_WIDTH = 40;\nconst DEFAULT_EXPANDED_WIDTH = 240;\n\nconst enum SidebarTabsName {\n  INSIGHTS = 'Insights',\n  ANNOTATIONS = 'Annotations',\n}\n\nexport class SidebarWidget extends UI.SplitWidget.SplitWidget {\n  #sidebarExpanded: boolean = false;\n  #sidebarUI = new SidebarUI();\n\n  constructor() {\n    super(true /* isVertical */, false /* secondIsSidebar */, undefined /* settingName */, COLLAPSED_WIDTH);\n\n    if (Root.Runtime.experiments.isEnabled(Root.Runtime.ExperimentName.TIMELINE_SIDEBAR)) {\n      this.sidebarElement().append(this.#sidebarUI);\n    } else {\n      this.hideSidebar();\n    }\n\n    this.setResizable(this.#sidebarExpanded);\n    this.#sidebarUI.expanded = this.#sidebarExpanded;\n\n    this.#sidebarUI.addEventListener('togglebuttonclick', () => {\n      this.#sidebarExpanded = !this.#sidebarExpanded;\n\n      if (this.#sidebarExpanded) {\n        this.setResizable(true);\n        this.forceSetSidebarWidth(DEFAULT_EXPANDED_WIDTH);\n\n      } else {\n        this.setResizable(false);\n        this.forceSetSidebarWidth(COLLAPSED_WIDTH);\n      }\n\n      this.#sidebarUI.expanded = this.#sidebarExpanded;\n    });\n  }\n}\n\nexport class SidebarUI extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-performance-sidebar`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #activeTab: SidebarTabsName = SidebarTabsName.INSIGHTS;\n  #expanded: boolean = false;\n\n  #renderBound = this.#render.bind(this);\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [sidebarStyles];\n    // Force an immediate render of the default state (not expanded).\n    this.#render();\n  }\n\n  set expanded(expanded: boolean) {\n    if (expanded === this.#expanded) {\n      return;\n    }\n    this.#expanded = expanded;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#renderBound);\n  }\n\n  #toggleButtonClick(): void {\n    this.dispatchEvent(new Event('togglebuttonclick'));\n  }\n\n  #onTabHeaderClicked(activeTab: SidebarTabsName): void {\n    if (activeTab === this.#activeTab) {\n      return;\n    }\n    this.#activeTab = activeTab;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#renderBound);\n  }\n\n  #renderHeader(): LitHtml.LitTemplate {\n    // clang-format off\n    return LitHtml.html`\n      <div class=\"tabs-header\">\n        <input\n          type=\"button\"\n          value=${SidebarTabsName.INSIGHTS}\n          ?active=${this.#activeTab === SidebarTabsName.INSIGHTS}\n          @click=${()=>this.#onTabHeaderClicked(SidebarTabsName.INSIGHTS)}>\n        <input\n          type=\"button\"\n          value=${SidebarTabsName.ANNOTATIONS}\n          ?active=${this.#activeTab === SidebarTabsName.ANNOTATIONS}\n          @click=${()=>this.#onTabHeaderClicked(SidebarTabsName.ANNOTATIONS)}>\n      </div>\n    `;\n    // clang-format on\n  }\n\n  #renderInsightsTabContent(): LitHtml.TemplateResult {\n    // clang-format off\n    return LitHtml.html`\n      <h2>Content for Insights Tab</h2>\n      <p>This is the content of the Insights tab.</p>\n    `;\n    // clang-format on\n  }\n\n  #renderAnnotationTabContent(): LitHtml.TemplateResult {\n    // clang-format off\n    return LitHtml.html`\n      <h2>Content for Annotation Tab</h2>\n      <p>This is the content of the Annotation tab.</p>\n    `;\n    // clang-format on\n  }\n\n  #renderContent(): LitHtml.TemplateResult|null {\n    switch (this.#activeTab) {\n      case SidebarTabsName.INSIGHTS:\n        return this.#renderInsightsTabContent();\n      case SidebarTabsName.ANNOTATIONS:\n        return this.#renderAnnotationTabContent();\n      default:\n        return null;\n    }\n  }\n\n  #updateActiveIndicatorPosition(): void {\n    const insightsTabHeaderElement = this.#shadow.querySelector('.tabs-header input:nth-child(1)');\n    const annotationTabHeaderElement = this.#shadow.querySelector('.tabs-header input:nth-child(2)');\n    const tabSliderElement = this.#shadow.querySelector<HTMLElement>('.tab-slider');\n    if (insightsTabHeaderElement && annotationTabHeaderElement && tabSliderElement) {\n      const insightsTabHeaderWidth = insightsTabHeaderElement.getBoundingClientRect().width;\n      const annotationTabHeaderWidth = annotationTabHeaderElement.getBoundingClientRect().width;\n\n      switch (this.#activeTab) {\n        case SidebarTabsName.INSIGHTS:\n          tabSliderElement.style.left = '0';\n          tabSliderElement.style.width = `${insightsTabHeaderWidth}px`;\n          return;\n        case SidebarTabsName.ANNOTATIONS:\n          tabSliderElement.style.left = `${insightsTabHeaderWidth}px`;\n          tabSliderElement.style.width = `${annotationTabHeaderWidth}px`;\n          return;\n      }\n    }\n  }\n\n  #render(): void {\n    const toggleIcon = this.#expanded ? 'left-panel-close' : 'left-panel-open';\n    // clang-format off\n    const output = LitHtml.html`<div class=${LitHtml.Directives.classMap({\n      sidebar: true,\n      'is-expanded': this.#expanded,\n      'is-closed': !this.#expanded,\n    })}>\n      <div class=\"tab-bar\">\n        ${this.#expanded? this.#renderHeader() : LitHtml.nothing}\n        <${IconButton.Icon.Icon.litTagName}\n          name=${toggleIcon}\n          @click=${this.#toggleButtonClick}\n          class=\"sidebar-toggle-button\"\n          jslog=${VisualLogging.action('performance.sidebar-toggle').track({click: true})}\n        ></${IconButton.Icon.Icon.litTagName}>\n      </div>\n      <div class=\"tab-slider\" ?hidden=${!this.#expanded}></div>\n      <div class=\"tab-headers-bottom-line\" ?hidden=${!this.#expanded}></div>\n      ${this.#expanded ? LitHtml.html`<div class=\"sidebar-body\">${this.#renderContent()}</div>` : LitHtml.nothing}\n    </div>`;\n    // clang-format on\n    LitHtml.render(output, this.#shadow, {host: this});\n    this.#updateActiveIndicatorPosition();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-performance-sidebar': SidebarWidget;\n  }\n}\n\ncustomElements.define('devtools-performance-sidebar', SidebarUI);\n"]}