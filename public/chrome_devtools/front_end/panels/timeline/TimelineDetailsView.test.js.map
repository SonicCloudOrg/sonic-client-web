{"version":3,"file":"TimelineDetailsView.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineDetailsView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as TraceEngine from '../../models/trace/trace.js';\nimport {describeWithEnvironment} from '../../testing/EnvironmentHelpers.js';\nimport {TraceLoader} from '../../testing/TraceLoader.js';\n\nimport * as Timeline from './timeline.js';\n\nclass MockViewDelegate implements Timeline.TimelinePanel.TimelineModeViewDelegate {\n  select(_selection: Timeline.TimelineSelection.TimelineSelection|null): void {\n  }\n  selectEntryAtTime(_events: TraceEngine.Types.TraceEvents.TraceEventData[]|null, _time: number): void {\n  }\n  highlightEvent(_event: TraceEngine.Types.TraceEvents.TraceEventData|null): void {\n  }\n}\n\nfunction getRowDataForDetailsElement(details: HTMLElement) {\n  return Array.from(details.querySelectorAll<HTMLDivElement>('.timeline-details-view-row')).map(row => {\n    const title = row.querySelector<HTMLDivElement>('.timeline-details-view-row-title')?.innerText;\n    const value = row.querySelector<HTMLDivElement>('.timeline-details-view-row-value')?.innerText;\n    return {title, value};\n  });\n}\n\ndescribeWithEnvironment('TimelineDetailsView', function() {\n  const mockViewDelegate = new MockViewDelegate();\n  it('displays the details of a network request event correctly', async function() {\n    const traceParsedData = await TraceLoader.traceEngine(this, 'lcp-web-font.json.gz');\n    const detailsView = new Timeline.TimelineDetailsView.TimelineDetailsView(mockViewDelegate);\n\n    const networkRequests = traceParsedData.NetworkRequests.byTime;\n    const cssRequest = networkRequests.find(request => {\n      return request.args.data.url === 'https://chromedevtools.github.io/performance-stories/lcp-web-font/app.css';\n    });\n    if (!cssRequest) {\n      throw new Error('Could not find expected network request.');\n    }\n    const selection = Timeline.TimelineSelection.TimelineSelection.fromTraceEvent(cssRequest);\n\n    await detailsView.setModel(traceParsedData, null);\n    await detailsView.setSelection(selection);\n\n    const detailsContentElement = detailsView.getDetailsContentElementForTest();\n    assert.strictEqual(detailsContentElement.childNodes.length, 1);\n    const rowData = getRowDataForDetailsElement(detailsContentElement);\n\n    assert.deepEqual(\n        rowData,\n        [\n          {title: 'URL', value: 'chromedevtools.github.io/performance-stories/lcp-web-font/app.css'},\n          {title: 'Duration', value: '12.58\\xA0ms (8.29\\xA0ms load from cache + 4.29\\xA0ms resource loading)'},\n          {title: 'Request Method', value: 'GET'},\n          {title: 'Initial Priority', value: 'Highest'},\n          {title: 'Priority', value: 'Highest'},\n          {title: 'Mime Type', value: 'text/css'},\n          {title: 'Encoded Data', value: ' (from cache)'},\n          {title: 'Decoded Body', value: '96Â B'},\n        ],\n    );\n  });\n});\n"]}