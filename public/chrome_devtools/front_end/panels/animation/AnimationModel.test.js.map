{"version":3,"file":"AnimationModel.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationModel.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Protocol from '../../generated/protocol.js';\nimport {createTarget} from '../../testing/EnvironmentHelpers.js';\nimport {\n  clearAllMockConnectionResponseHandlers,\n  describeWithMockConnection,\n  setMockConnectionResponseHandler,\n} from '../../testing/MockConnection.js';\n\nimport * as Animation from './animation.js';\n\ndescribeWithMockConnection('AnimationModel', () => {\n  afterEach(() => {\n    clearAllMockConnectionResponseHandlers();\n  });\n\n  it('can be instantiated', () => {\n    assert.doesNotThrow(() => {\n      const target = createTarget();\n      new Animation.AnimationModel.AnimationModel(target);\n    });\n  });\n\n  describe('AnimationImpl', () => {\n    it('setPayload should update values returned from the relevant value functions for time based animations',\n       async () => {\n         const target = createTarget();\n         const model = new Animation.AnimationModel.AnimationModel(target);\n         const animationImpl = await Animation.AnimationModel.AnimationImpl.parsePayload(model, {\n           id: '1',\n           name: 'animation-name',\n           pausedState: false,\n           playbackRate: 1,\n           startTime: 0,\n           currentTime: 0,\n           type: Protocol.Animation.AnimationType.CSSAnimation,\n           playState: 'running',\n           source: {\n             delay: 0,\n             endDelay: 0,\n             iterationStart: 0,\n             iterations: 1,\n             duration: 100,\n             direction: 'forward',\n             fill: 'forwards',\n             easing: 'linear',\n           },\n         });\n         assert.strictEqual(animationImpl.name(), 'animation-name');\n         assert.strictEqual(animationImpl.paused(), false);\n         assert.strictEqual(animationImpl.playState(), 'running');\n         assert.strictEqual(animationImpl.playbackRate(), 1);\n         assert.strictEqual(animationImpl.startTime(), 0);\n         assert.strictEqual(animationImpl.currentTime(), 0);\n         assert.strictEqual(animationImpl.iterationDuration(), 100);\n         assert.strictEqual(animationImpl.delayOrStartTime(), 0);\n         assert.strictEqual(animationImpl.type(), Protocol.Animation.AnimationType.CSSAnimation);\n\n         await animationImpl.setPayload({\n           id: '1',\n           name: 'updated-name',\n           pausedState: true,\n           playbackRate: 2,\n           startTime: 100,\n           currentTime: 120,\n           type: Protocol.Animation.AnimationType.CSSTransition,\n           playState: 'paused',\n           source: {\n             delay: 10,\n             endDelay: 10,\n             iterationStart: 20,\n             iterations: 2,\n             duration: 120,\n             direction: 'reverse',\n             fill: 'backward',\n             easing: 'ease',\n           },\n         });\n\n         assert.strictEqual(animationImpl.name(), 'updated-name');\n         assert.strictEqual(animationImpl.paused(), true);\n         assert.strictEqual(animationImpl.playState(), 'paused');\n         assert.strictEqual(animationImpl.playbackRate(), 2);\n         assert.strictEqual(animationImpl.startTime(), 100);\n         assert.strictEqual(animationImpl.currentTime(), 120);\n         assert.strictEqual(animationImpl.iterationDuration(), 120);\n         assert.strictEqual(animationImpl.delayOrStartTime(), 10);\n         assert.strictEqual(animationImpl.type(), Protocol.Animation.AnimationType.CSSTransition);\n       });\n\n    it('setPayload should update values returned from the relevant value functions for scroll based animations',\n       async () => {\n         setMockConnectionResponseHandler('Runtime.evaluate', () => {\n           return {\n             result: {\n               type: 'number',\n               value: 1,\n             },\n           };\n         });\n         const target = createTarget();\n         const model = new Animation.AnimationModel.AnimationModel(target);\n         const animationImpl = await Animation.AnimationModel.AnimationImpl.parsePayload(model, {\n           id: '1',\n           name: 'animation-name',\n           pausedState: false,\n           playbackRate: 1,\n           startTime: 0,\n           currentTime: 0,\n           type: Protocol.Animation.AnimationType.CSSAnimation,\n           playState: 'running',\n           source: {\n             delay: 0,\n             endDelay: 0,\n             iterationStart: 0,\n             iterations: 1,\n             duration: 100,\n             direction: 'forward',\n             fill: 'forwards',\n             easing: 'linear',\n           },\n           viewOrScrollTimeline: {\n             axis: Protocol.DOM.ScrollOrientation.Vertical,\n             startOffset: 100,\n             endOffset: 200,\n             sourceNodeId: 1 as Protocol.DOM.BackendNodeId,\n           },\n         });\n         assert.strictEqual(animationImpl.name(), 'animation-name');\n         assert.strictEqual(animationImpl.paused(), false);\n         assert.strictEqual(animationImpl.playState(), 'running');\n         assert.strictEqual(animationImpl.playbackRate(), 1);\n         assert.strictEqual(animationImpl.startTime(), 100);  // in pixels\n         assert.strictEqual(animationImpl.currentTime(), 0);\n         assert.strictEqual(animationImpl.iterationDuration(), 100);  // in pixels\n         assert.strictEqual(animationImpl.delayOrStartTime(), 100);   // in pixels\n\n         await animationImpl.setPayload({\n           id: '1',\n           name: 'updated-name',\n           pausedState: true,\n           playbackRate: 2,\n           startTime: 0,\n           currentTime: 120,\n           type: Protocol.Animation.AnimationType.CSSAnimation,\n           playState: 'paused',\n           source: {\n             delay: 10,\n             endDelay: 10,\n             iterationStart: 20,\n             iterations: 2,\n             duration: 20,\n             direction: 'reverse',\n             fill: 'backward',\n             easing: 'ease',\n           },\n           viewOrScrollTimeline: {\n             axis: Protocol.DOM.ScrollOrientation.Horizontal,\n             startOffset: 0,\n             endOffset: 100,\n             sourceNodeId: 1 as Protocol.DOM.BackendNodeId,\n           },\n         });\n\n         assert.strictEqual(animationImpl.name(), 'updated-name');\n         assert.strictEqual(animationImpl.paused(), true);\n         assert.strictEqual(animationImpl.playState(), 'paused');\n         assert.strictEqual(animationImpl.playbackRate(), 2);\n         assert.strictEqual(animationImpl.startTime(), 0);           // in pixels\n         assert.strictEqual(animationImpl.currentTime(), 120);       // in pixels\n         assert.strictEqual(animationImpl.iterationDuration(), 20);  // in pixels\n         assert.strictEqual(animationImpl.delayOrStartTime(), 0);    // in pixels\n       });\n  });\n});\n"]}