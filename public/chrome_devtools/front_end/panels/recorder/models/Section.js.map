{"version":3,"file":"Section.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/models/Section.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAa7B,SAAS,eAAe,CAAC,IAAU;IACjC,MAAM,eAAe,GAAG,IAAI,CAAC,cAAc,EAAE,IAAI,CAC7C,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,KAAK,YAAY,CACvC,CAAC;IACF,IAAI,IAAI,CAAC,IAAI,KAAK,UAAU,EAAE,CAAC;QAC7B,OAAO;YACL,KAAK,EAAE,eAAe,EAAE,KAAK,IAAI,EAAE;YACnC,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,KAAK,EAAE,EAAE;YACT,WAAW,EAAE,IAAI;SAClB,CAAC;IACJ,CAAC;IACD,IAAI,eAAe,EAAE,CAAC;QACpB,OAAO;YACL,KAAK,EAAE,eAAe,CAAC,KAAK,IAAI,EAAE;YAClC,GAAG,EAAE,eAAe,CAAC,GAAG,IAAI,EAAE;YAC9B,KAAK,EAAE,EAAE;SACV,CAAC;IACJ,CAAC;IACD,OAAO,IAAI,CAAC;AACd,CAAC;AAED,MAAM,UAAU,aAAa,CAAC,KAAa;IACzC,IAAI,cAAc,GAAiB,IAAI,CAAC;IACxC,MAAM,QAAQ,GAAc,EAAE,CAAC;IAC/B,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;QACzB,IAAI,cAAc,EAAE,CAAC;YACnB,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClC,CAAC;aAAM,IAAI,IAAI,CAAC,IAAI,KAAK,UAAU,EAAE,CAAC;YACpC,cAAc,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;YACvC,SAAS;QACX,CAAC;aAAM,CAAC;YACN,cAAc,GAAG,EAAC,KAAK,EAAE,cAAc,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,EAAC,CAAC;QACnE,CAAC;QACD,MAAM,WAAW,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,WAAW,EAAE,CAAC;YAChB,IAAI,cAAc,EAAE,CAAC;gBACnB,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YAChC,CAAC;YACD,cAAc,GAAG,WAAW,CAAC;QAC/B,CAAC;IACH,CAAC;IACD,IAAI,cAAc,IAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,IAAI,cAAc,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC;QACxE,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IAChC,CAAC;IACD,OAAO,QAAQ,CAAC;AAClB,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {type Step} from './Schema.js';\nimport {type Screenshot} from './ScreenshotStorage.js';\n\nexport interface Section {\n  title: string;\n  steps: Step[];\n  url: string;\n  screenshot?: Screenshot;\n  causingStep?: Step;\n}\n\nfunction startNewSection(step: Step): Section|null {\n  const navigationEvent = step.assertedEvents?.find(\n      event => event.type === 'navigation',\n  );\n  if (step.type === 'navigate') {\n    return {\n      title: navigationEvent?.title || '',\n      url: step.url,\n      steps: [],\n      causingStep: step,\n    };\n  }\n  if (navigationEvent) {\n    return {\n      title: navigationEvent.title || '',\n      url: navigationEvent.url || '',\n      steps: [],\n    };\n  }\n  return null;\n}\n\nexport function buildSections(steps: Step[]): Section[] {\n  let currentSection: Section|null = null;\n  const sections: Section[] = [];\n  for (const step of steps) {\n    if (currentSection) {\n      currentSection.steps.push(step);\n    } else if (step.type === 'navigate') {\n      currentSection = startNewSection(step);\n      continue;\n    } else {\n      currentSection = {title: 'Current page', url: '', steps: [step]};\n    }\n    const nextSection = startNewSection(step);\n    if (nextSection) {\n      if (currentSection) {\n        sections.push(currentSection);\n      }\n      currentSection = nextSection;\n    }\n  }\n  if (currentSection && (!sections.length || currentSection.steps.length)) {\n    sections.push(currentSection);\n  }\n  return sections;\n}\n"]}