{"version":3,"file":"RecordingListView.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/components/RecordingListView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {dispatchClickEvent, dispatchKeyDownEvent, renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {\n  describeWithEnvironment,\n  setupActionRegistry,\n} from '../../../testing/EnvironmentHelpers.js';\nimport * as Coordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\n\nimport * as Components from './components.js';\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\ndescribeWithEnvironment('RecordingListView', () => {\n  setupActionRegistry();\n\n  it('should open a recording on Enter', async () => {\n    const view = new Components.RecordingListView.RecordingListView();\n    renderElementIntoDOM(view);\n    view.recordings = [{storageName: 'storage-test', name: 'test'}];\n    await coordinator.done();\n    const recording = view.shadowRoot?.querySelector('.row') as HTMLDivElement;\n    assert.ok(recording);\n    const eventSent = new Promise<Components.RecordingListView.OpenRecordingEvent>(\n        resolve => {\n          view.addEventListener('openrecording', resolve, {once: true});\n        },\n    );\n    dispatchKeyDownEvent(recording, {key: 'Enter'});\n    const event = await eventSent;\n    assert.strictEqual(event.storageName, 'storage-test');\n  });\n\n  it('should delete a recording', async () => {\n    const view = new Components.RecordingListView.RecordingListView();\n    renderElementIntoDOM(view);\n    view.recordings = [{storageName: 'storage-test', name: 'test'}];\n    await coordinator.done();\n    const deleteButton = view.shadowRoot?.querySelector(\n                             '.delete-recording-button',\n                             ) as HTMLButtonElement;\n    assert.ok(deleteButton);\n    const eventSent = new Promise<Components.RecordingListView.DeleteRecordingEvent>(\n        resolve => {\n          view.addEventListener('deleterecording', resolve, {once: true});\n        },\n    );\n    dispatchClickEvent(deleteButton);\n    const event = await eventSent;\n    assert.strictEqual(event.storageName, 'storage-test');\n  });\n\n  it('should not open a recording on Enter on the delete button', async () => {\n    const view = new Components.RecordingListView.RecordingListView();\n    renderElementIntoDOM(view);\n    view.recordings = [{storageName: 'storage-test', name: 'test'}];\n    await coordinator.done();\n    const deleteButton = view.shadowRoot?.querySelector(\n                             '.delete-recording-button',\n                             ) as HTMLDivElement;\n    assert.ok(deleteButton);\n    let forceResolve: Function|undefined;\n    const eventSent = new Promise<Components.RecordingListView.OpenRecordingEvent>(\n        resolve => {\n          forceResolve = resolve;\n          view.addEventListener('openrecording', resolve, {once: true});\n        },\n    );\n    dispatchKeyDownEvent(deleteButton, {key: 'Enter', bubbles: true});\n    const maybeEvent = await Promise.race([\n      eventSent,\n      new Promise(resolve => queueMicrotask(() => resolve('timeout'))),\n    ]);\n    assert.strictEqual(maybeEvent, 'timeout');\n    forceResolve?.();\n  });\n});\n"]}