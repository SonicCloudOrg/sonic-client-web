{"version":3,"file":"StepEditor.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/components/StepEditor.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Platform from '../../../core/platform/platform.js';\nimport type * as Puppeteer from '../../../third_party/puppeteer/puppeteer.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as SuggestionInput from '../../../ui/components/suggestion_input/suggestion_input.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\nimport * as Controllers from '../controllers/controllers.js';\nimport * as Models from '../models/models.js';\nimport * as Util from '../util/util.js';\n\nimport stepEditorStyles from './stepEditor.css.js';\nimport {\n  ArrayAssignments,\n  assert,\n  type Assignments,\n  deepFreeze,\n  type DeepImmutable,\n  type DeepPartial,\n  immutableDeepAssign,\n  InsertAssignment,\n  type Keys,\n  type OptionalKeys,\n  type RequiredKeys,\n} from './util.js';\n\nconst {html, Decorators, Directives, LitElement} = LitHtml;\nconst {customElement, property, state} = Decorators;\nconst {live} = Directives;\n\ntype StepFor<Type> = Extract<Models.Schema.Step, {type: Type}>;\ntype Attribute = Keys<Models.Schema.Step>;\n\ntype DataType<A extends Attribute> = ReturnType<typeof typeConverters[typeof dataTypeByAttribute[A]]>;\n\nconst typeConverters = Object.freeze({\n  string: (value: string) => value.trim(),\n  number: (value: string) => {\n    const number = parseFloat(value);\n    if (Number.isNaN(number)) {\n      return 0;\n    }\n    return number;\n  },\n  boolean: (value: string) => {\n    if (value.toLowerCase() === 'true') {\n      return true;\n    }\n    return false;\n  },\n});\n\nconst dataTypeByAttribute = Object.freeze({\n  selectors: 'string',\n  offsetX: 'number',\n  offsetY: 'number',\n  target: 'string',\n  frame: 'number',\n  assertedEvents: 'string',\n  value: 'string',\n  key: 'string',\n  operator: 'string',\n  count: 'number',\n  expression: 'string',\n  x: 'number',\n  y: 'number',\n  url: 'string',\n  type: 'string',\n  timeout: 'number',\n  duration: 'number',\n  button: 'string',\n  deviceType: 'string',\n  width: 'number',\n  height: 'number',\n  deviceScaleFactor: 'number',\n  isMobile: 'boolean',\n  hasTouch: 'boolean',\n  isLandscape: 'boolean',\n  download: 'number',\n  upload: 'number',\n  latency: 'number',\n  name: 'string',\n  parameters: 'string',\n  visible: 'boolean',\n  properties: 'string',\n  attributes: 'string',\n} as const);\n\nconst defaultValuesByAttribute = deepFreeze({\n  selectors: [['.cls']],\n  offsetX: 1,\n  offsetY: 1,\n  target: 'main',\n  frame: [0],\n  assertedEvents: [\n    {type: 'navigation', url: 'https://example.com', title: 'Title'},\n  ],\n  value: 'Value',\n  key: 'Enter',\n  operator: '>=',\n  count: 1,\n  expression: 'true',\n  x: 0,\n  y: 0,\n  url: 'https://example.com',\n  timeout: 5000,\n  duration: 50,\n  deviceType: 'mouse',\n  button: 'primary',\n  type: 'click',\n  width: 800,\n  height: 600,\n  deviceScaleFactor: 1,\n  isMobile: false,\n  hasTouch: false,\n  isLandscape: true,\n  download: 1000,\n  upload: 1000,\n  latency: 25,\n  name: 'customParam',\n  parameters: '{}',\n  properties: '{}',\n  attributes: [{name: 'attribute', value: 'value'}],\n  visible: true,\n});\n\nconst attributesByType = deepFreeze<{\n  [Type in Models.Schema.StepType]:\n      {required: Exclude<RequiredKeys<StepFor<Type>>, 'type'>[], optional: OptionalKeys<StepFor<Type>>[]};\n}>({\n  [Models.Schema.StepType.Click]: {\n    required: ['selectors', 'offsetX', 'offsetY'],\n    optional: [\n      'assertedEvents',\n      'button',\n      'deviceType',\n      'duration',\n      'frame',\n      'target',\n      'timeout',\n    ],\n  },\n  [Models.Schema.StepType.DoubleClick]: {\n    required: ['offsetX', 'offsetY', 'selectors'],\n    optional: [\n      'assertedEvents',\n      'button',\n      'deviceType',\n      'frame',\n      'target',\n      'timeout',\n    ],\n  },\n  [Models.Schema.StepType.Hover]: {\n    required: ['selectors'],\n    optional: ['assertedEvents', 'frame', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.Change]: {\n    required: ['selectors', 'value'],\n    optional: ['assertedEvents', 'frame', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.KeyDown]: {\n    required: ['key'],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.KeyUp]: {\n    required: ['key'],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.Scroll]: {\n    required: [],\n    optional: ['assertedEvents', 'frame', 'target', 'timeout', 'x', 'y'],\n  },\n  [Models.Schema.StepType.Close]: {\n    required: [],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.Navigate]: {\n    required: ['url'],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.WaitForElement]: {\n    required: ['selectors'],\n    optional: [\n      'assertedEvents',\n      'attributes',\n      'count',\n      'frame',\n      'operator',\n      'properties',\n      'target',\n      'timeout',\n      'visible',\n    ],\n  },\n  [Models.Schema.StepType.WaitForExpression]: {\n    required: ['expression'],\n    optional: ['assertedEvents', 'frame', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.CustomStep]: {\n    required: ['name', 'parameters'],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.EmulateNetworkConditions]: {\n    required: ['download', 'latency', 'upload'],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n  [Models.Schema.StepType.SetViewport]: {\n    required: [\n      'deviceScaleFactor',\n      'hasTouch',\n      'height',\n      'isLandscape',\n      'isMobile',\n      'width',\n    ],\n    optional: ['assertedEvents', 'target', 'timeout'],\n  },\n});\n\nconst UIStrings = {\n  /**\n   *@description The text that is disabled when the steps were not saved due to an error. The error message itself is always in English and not translated.\n   *@example {Saving failed} error\n   */\n  notSaved: 'Not saved: {error}',\n  /**\n   *@description The button title that adds a new attribute to the form.\n   *@example {timeout} attributeName\n   */\n  addAttribute: 'Add {attributeName}',\n  /**\n   *@description The title of a button that deletes an attribute from the form.\n   */\n  deleteRow: 'Delete row',\n  /**\n   *@description The title of a button that allows you to select an element on the page and update CSS/ARIA selectors.\n   */\n  selectorPicker: 'Select an element in the page to update selectors',\n  /**\n   *@description The title of a button that adds a new input field for the entry of the frame index. Frame index is the number of the frame within the page's frame tree.\n   */\n  addFrameIndex: 'Add frame index within the frame tree',\n  /**\n   *@description The title of a button that removes a frame index field from the form.\n   */\n  removeFrameIndex: 'Remove frame index',\n  /**\n   *@description The title of a button that adds a field to input a part of a selector in the editor form.\n   */\n  addSelectorPart: 'Add a selector part',\n  /**\n   *@description The title of a button that removes a field to input a part of a selector in the editor form.\n   */\n  removeSelectorPart: 'Remove a selector part',\n  /**\n   *@description The title of a button that adds a field to input a selector in the editor form.\n   */\n  addSelector: 'Add a selector',\n  /**\n   *@description The title of a button that removes a field to input a selector in the editor form.\n   */\n  removeSelector: 'Remove a selector',\n  /**\n   *@description The error message display when a user enters a type in the input not associates with any existing types.\n   */\n  unknownActionType: 'Unknown action type.',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/recorder/components/StepEditor.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-recorder-step-editor': StepEditor;\n    'devtools-recorder-selector-picker-button': RecorderSelectorPickerButton;\n  }\n}\n\nexport class StepEditedEvent extends Event {\n  static readonly eventName = 'stepedited';\n  data: Models.Schema.Step;\n\n  constructor(step: Models.Schema.Step) {\n    super(StepEditedEvent.eventName, {bubbles: true, composed: true});\n    this.data = step;\n  }\n}\n\nexport interface EditorState {\n  type: Models.Schema.StepType;\n  target?: string;\n  selectors?: string[][];\n  frame?: number[];\n  x?: number;\n  y?: number;\n  offsetX?: number;\n  offsetY?: number;\n  key?: string;\n  expression?: string;\n  value?: string;\n  operator?: string;\n  count?: number;\n  assertedEvents?: Models.Schema.AssertedEvent[];\n  url?: string;\n  timeout?: number;\n  button?: string;\n  duration?: number;\n  deviceType?: string;\n  width?: number;\n  height?: number;\n  deviceScaleFactor?: number;\n  isMobile?: boolean;\n  hasTouch?: boolean;\n  isLandscape?: boolean;\n  download?: number;\n  upload?: number;\n  latency?: number;\n  name?: string;\n  parameters?: string;\n  visible?: boolean;\n  properties?: string;\n  attributes?: Array<{name: string, value: string}>;\n}\n\n// Makes use of the fact that JSON values get their undefined values cleaned\n// after stringification.\nconst cleanUndefineds = <T>(value: T): T => {\n  return JSON.parse(JSON.stringify(value));\n};\n\ninterface Puppeteer {\n  page: Puppeteer.Page;\n  browser: Puppeteer.Browser;\n}\n\nexport class EditorState {\n  static #puppeteer: Util.SharedObject.SharedObject<Puppeteer> = new Util.SharedObject.SharedObject(\n      () => Models.RecordingPlayer.RecordingPlayer.connectPuppeteer(),\n      ({browser}) => Models.RecordingPlayer.RecordingPlayer.disconnectPuppeteer(browser));\n\n  static async default(type: Models.Schema.StepType): Promise<DeepImmutable<EditorState>> {\n    const state = {type};\n    const attributes = attributesByType[state.type];\n    let promise: Promise<unknown> = Promise.resolve();\n    for (const attribute of attributes.required) {\n      promise = Promise.all([\n        promise,\n        (async () => Object.assign(state, {\n          [attribute]: await this.defaultByAttribute(state, attribute),\n        }))(),\n      ]);\n    }\n    await promise;\n    return Object.freeze(state);\n  }\n\n  static async defaultByAttribute<Attribute extends keyof typeof defaultValuesByAttribute>(\n      state: DeepImmutable<EditorState>,\n      attribute: Attribute): Promise<DeepImmutable<typeof defaultValuesByAttribute[Attribute]>>;\n  static async defaultByAttribute(_state: DeepImmutable<EditorState>, attribute: keyof typeof defaultValuesByAttribute):\n      Promise<unknown> {\n    return this.#puppeteer.run(puppeteer => {\n      switch (attribute) {\n        case 'assertedEvents': {\n          return immutableDeepAssign(defaultValuesByAttribute.assertedEvents, new ArrayAssignments({\n                                       0: {\n                                         url: puppeteer.page.url() || defaultValuesByAttribute.assertedEvents[0].url,\n                                       },\n                                     }));\n        }\n        case 'url': {\n          return puppeteer.page.url() || defaultValuesByAttribute.url;\n        }\n        case 'height': {\n          return (\n              puppeteer.page.evaluate(() => (visualViewport as VisualViewport).height) ||\n              defaultValuesByAttribute.height);\n        }\n        case 'width': {\n          return (\n              puppeteer.page.evaluate(() => (visualViewport as VisualViewport).width) ||\n              defaultValuesByAttribute.width);\n        }\n        default: {\n          return defaultValuesByAttribute[attribute];\n        }\n      }\n    });\n  }\n\n  static fromStep(step: DeepImmutable<Models.Schema.Step>): DeepImmutable<EditorState> {\n    const state = structuredClone(step) as EditorState;\n    for (const key of ['parameters', 'properties'] as Array<'properties'>) {\n      if (key in step && step[key] !== undefined) {\n        state[key] = JSON.stringify(step[key]);\n      }\n    }\n    if ('attributes' in step && step.attributes) {\n      state.attributes = [];\n      for (const [name, value] of Object.entries(step.attributes)) {\n        state.attributes.push({name, value});\n      }\n    }\n    if ('selectors' in step) {\n      state.selectors = step.selectors.map(selector => {\n        if (typeof selector === 'string') {\n          return [selector];\n        }\n        return [...selector];\n      });\n    }\n    return deepFreeze(state as EditorState);\n  }\n\n  static toStep(state: DeepImmutable<EditorState>): Models.Schema.Step {\n    const step = structuredClone(state) as Models.Schema.Step;\n    for (const key of ['parameters', 'properties'] as Array<'properties'>) {\n      const value = state[key];\n      if (value) {\n        Object.assign(step, {[key]: JSON.parse(value)});\n      }\n    }\n    if (state.attributes) {\n      if (state.attributes.length !== 0) {\n        const attributes = {};\n        for (const {name, value} of state.attributes) {\n          Object.assign(attributes, {[name]: value});\n        }\n        Object.assign(step, {attributes});\n      } else if ('attributes' in step) {\n        delete step.attributes;\n      }\n    }\n    if (state.selectors) {\n      const selectors = state.selectors.filter(selector => selector.length > 0).map(selector => {\n        if (selector.length === 1) {\n          return selector[0];\n        }\n        return [...selector];\n      });\n      if (selectors.length !== 0) {\n        Object.assign(step, {selectors});\n      } else if ('selectors' in step) {\n        // @ts-expect-error We want to trigger an error in the parsing phase.\n        delete step.selectors;\n      }\n    }\n    if (state.frame && state.frame.length === 0 && 'frame' in step) {\n      delete step.frame;\n    }\n    return cleanUndefineds(Models.SchemaUtils.parseStep(step));\n  }\n}\n\n/**\n * @fires RequestSelectorAttributeEvent#requestselectorattribute\n * @fires SelectorPickedEvent#selectorpicked\n */\n@customElement('devtools-recorder-selector-picker-button')\nclass RecorderSelectorPickerButton extends LitElement {\n  static override styles = [stepEditorStyles];\n\n  @property() declare disabled: boolean;\n\n  #picker = new Controllers.SelectorPicker.SelectorPicker(this);\n\n  constructor() {\n    super();\n    this.disabled = false;\n  }\n\n  #handleClickEvent = (event: MouseEvent): void => {\n    event.preventDefault();\n    event.stopPropagation();\n    void this.#picker.toggle();\n  };\n\n  override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    void this.#picker.stop();\n  }\n\n  protected override render(): LitHtml.TemplateResult|undefined {\n    if (this.disabled) {\n      return;\n    }\n    return html`<devtools-button\n      @click=${this.#handleClickEvent}\n      .title=${i18nString(UIStrings.selectorPicker)}\n      class=\"selector-picker\"\n      .size=${Buttons.Button.Size.SMALL}\n      .iconName=${'select-element'}\n      .active=${this.#picker.active}\n      .variant=${Buttons.Button.Variant.ICON}\n      jslog=${VisualLogging.toggle('selector-picker').track({\n      click: true,\n    })}\n    ></devtools-button>`;\n  }\n}\n\n/**\n * @fires RequestSelectorAttributeEvent#requestselectorattribute\n * @fires StepEditedEvent#stepedited\n */\n@customElement('devtools-recorder-step-editor')\nexport class StepEditor extends LitElement {\n  static override styles = [stepEditorStyles];\n\n  @state() private declare state: DeepImmutable<EditorState>;\n  @state() private declare error: string|undefined;\n\n  @property() declare isTypeEditable: boolean;\n  @property() declare disabled: boolean;\n\n  #renderedAttributes: Set<Attribute> = new Set();\n\n  constructor() {\n    super();\n\n    this.state = {type: Models.Schema.StepType.WaitForElement};\n\n    this.isTypeEditable = true;\n    this.disabled = false;\n  }\n\n  protected override createRenderRoot(): HTMLElement|DocumentFragment {\n    const root = super.createRenderRoot();\n    root.addEventListener('keydown', this.#handleKeyDownEvent);\n    return root;\n  }\n\n  set step(step: DeepImmutable<Models.Schema.Step>) {\n    this.state = deepFreeze(EditorState.fromStep(step));\n    this.error = undefined;\n  }\n\n  #commit(updatedState: DeepImmutable<EditorState>): void {\n    try {\n      this.dispatchEvent(new StepEditedEvent(EditorState.toStep(updatedState)));\n      // Note we don't need to update this variable since it will come from up\n      // the tree, but processing up the tree is asynchronous implying we cannot\n      // reliably know when the state will come back down. Since we need to\n      // focus the DOM elements that may be created as a result of this new\n      // state, we set it here for waiting on the updateComplete promise later.\n      this.state = updatedState;\n    } catch (error) {\n      this.error = error.message;\n    }\n  }\n\n  #handleSelectorPickedEvent = (event: Controllers.SelectorPicker.SelectorPickedEvent): void => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.#commit(immutableDeepAssign(this.state, {\n      target: event.data.target,\n      frame: event.data.frame,\n      selectors: event.data.selectors.map(selector => typeof selector === 'string' ? [selector] : selector),\n      offsetX: event.data.offsetX,\n      offsetY: event.data.offsetY,\n    }));\n  };\n\n  #handleAddOrRemoveClick =\n      (assignments: DeepImmutable<DeepPartial<Assignments<EditorState>>>, query: string,\n       metric: Host.UserMetrics.RecordingEdited): ((event: Event) => void) => event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        this.#commit(immutableDeepAssign(this.state, assignments));\n\n        this.#ensureFocus(query);\n\n        if (metric) {\n          Host.userMetrics.recordingEdited(metric);\n        }\n      };\n\n  #handleKeyDownEvent = (event: Event): void => {\n    assert(event instanceof KeyboardEvent);\n    if (event.target instanceof SuggestionInput.SuggestionInput.SuggestionInput && event.key === 'Enter') {\n      event.preventDefault();\n      event.stopPropagation();\n      const elements = this.renderRoot.querySelectorAll('devtools-suggestion-input');\n      const element = [...elements].findIndex(value => value === event.target);\n      if (element >= 0 && element + 1 < elements.length) {\n        elements[element + 1].focus();\n      } else {\n        event.target.blur();\n      }\n    }\n  };\n\n  #handleInputBlur = <A extends Attribute>(opts: {\n    attribute: A,\n    // If there are not assignments, then we should ignore the event.\n    from(this: StepEditor, value: DataType<A>): DeepImmutable<DeepPartial<Assignments<EditorState>>>|undefined,\n    metric: Host.UserMetrics.RecordingEdited,\n  }): ((event: Event) => void) => event => {\n    assert(event.target instanceof SuggestionInput.SuggestionInput.SuggestionInput);\n    if (event.target.disabled) {\n      return;\n    }\n\n    const dataType = dataTypeByAttribute[opts.attribute];\n    const value = typeConverters[dataType](event.target.value) as DataType<A>;\n    const assignments = opts.from.bind(this)(value);\n    if (!assignments) {\n      return;\n    }\n    this.#commit(immutableDeepAssign(this.state, assignments));\n\n    if (opts.metric) {\n      Host.userMetrics.recordingEdited(opts.metric);\n    }\n  };\n\n  #handleTypeInputBlur = async(event: Event): Promise<void> => {\n    assert(event.target instanceof SuggestionInput.SuggestionInput.SuggestionInput);\n    if (event.target.disabled) {\n      return;\n    }\n\n    const value = event.target.value as Models.Schema.StepType;\n    if (value === this.state.type) {\n      return;\n    }\n    if (!Object.values(Models.Schema.StepType).includes(value)) {\n      this.error = i18nString(UIStrings.unknownActionType);\n      return;\n    }\n    this.#commit(await EditorState.default(value));\n    Host.userMetrics.recordingEdited(Host.UserMetrics.RecordingEdited.TypeChanged);\n  };\n\n  #handleAddRowClickEvent = async(event: MouseEvent): Promise<void> => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const attribute = (event.target as HTMLElement).dataset.attribute as Attribute;\n\n    this.#commit(immutableDeepAssign(this.state, {\n      [attribute]: await EditorState.defaultByAttribute(this.state, attribute),\n    }));\n\n    this.#ensureFocus(`[data-attribute=${attribute}].attribute devtools-suggestion-input`);\n  };\n\n  #renderInlineButton(opts: {class: string, title: string, iconName: string, onClick: (event: MouseEvent) => void}):\n      LitHtml.TemplateResult|undefined {\n    if (this.disabled) {\n      return;\n    }\n    return html`\n      <devtools-button\n        title=${opts.title}\n        .size=${Buttons.Button.Size.SMALL}\n        .iconName=${opts.iconName}\n        .variant=${Buttons.Button.Variant.ICON}\n        jslog=${VisualLogging.action(opts.class).track({\n      click: true,\n    })}\n        class=\"inline-button ${opts.class}\"\n        @click=${opts.onClick}\n      ></devtools-button>\n    `;\n  }\n\n  #renderDeleteButton(attribute: Attribute): LitHtml.TemplateResult|undefined {\n    if (this.disabled) {\n      return;\n    }\n\n    const attributes = attributesByType[this.state.type];\n    const optional = [...attributes.optional].includes(attribute as typeof attributes.optional[number]);\n    if (!optional || this.disabled) {\n      return;\n    }\n\n    // clang-format off\n    return html`<devtools-button\n      .size=${Buttons.Button.Size.SMALL}\n      .iconName=${'bin'}\n      .variant=${Buttons.Button.Variant.ICON}\n      .title=${i18nString(UIStrings.deleteRow)}\n      class=\"inline-button delete-row\"\n      data-attribute=${attribute}\n      jslog=${VisualLogging.action('delete').track({click: true})}\n      @click=${(event: MouseEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        this.#commit(\n          immutableDeepAssign(this.state, { [attribute]: undefined }),\n        );\n      }}\n    ></devtools-button>`;\n    // clang-format on\n  }\n\n  #renderTypeRow(editable: boolean): LitHtml.TemplateResult {\n    this.#renderedAttributes.add('type');\n    // clang-format off\n    return html`<div class=\"row attribute\" data-attribute=\"type\" jslog=${VisualLogging.treeItem('type')}>\n      <div>type<span class=\"separator\">:</span></div>\n      <devtools-suggestion-input\n        .disabled=${!editable || this.disabled}\n        .options=${Object.values(Models.Schema.StepType)}\n        .placeholder=${defaultValuesByAttribute.type}\n        .value=${live(this.state.type)}\n        @blur=${this.#handleTypeInputBlur}\n      ></devtools-suggestion-input>\n    </div>`;\n    // clang-format on\n  }\n\n  #renderRow(attribute: Attribute): LitHtml.TemplateResult|undefined {\n    this.#renderedAttributes.add(attribute);\n    const attributeValue = this.state[attribute]?.toString();\n    if (attributeValue === undefined) {\n      return;\n    }\n    // clang-format off\n    return html`<div class=\"row attribute\" data-attribute=${attribute} jslog=${VisualLogging.treeItem(Platform.StringUtilities.toKebabCase(attribute))}>\n      <div>${attribute}<span class=\"separator\">:</span></div>\n      <devtools-suggestion-input\n        .disabled=${this.disabled}\n        .placeholder=${defaultValuesByAttribute[attribute].toString()}\n        .value=${live(attributeValue)}\n        .mimeType=${(() => {\n          switch (attribute) {\n            case 'expression':\n              return 'text/javascript';\n            case 'properties':\n              return 'application/json';\n            default:\n              return '';\n          }\n        })()}\n        @blur=${this.#handleInputBlur({\n      attribute,\n      from(value) {\n        if (this.state[attribute] === undefined) {\n          return;\n        }\n        switch (attribute) {\n          case 'properties':\n            Host.userMetrics.recordingAssertion(Host.UserMetrics.RecordingAssertion.PropertyAssertionEdited);\n            break;\n        }\n        return {[attribute]: value};\n      },\n      metric: Host.UserMetrics.RecordingEdited.OtherEditing,\n    })}\n      ></devtools-suggestion-input>\n      ${this.#renderDeleteButton(attribute)}\n    </div>`;\n    // clang-format on\n  }\n\n  #renderFrameRow(): LitHtml.TemplateResult|undefined {\n    this.#renderedAttributes.add('frame');\n    if (this.state.frame === undefined) {\n      return;\n    }\n    // clang-format off\n    return html`\n      <div class=\"attribute\" data-attribute=\"frame\" jslog=${VisualLogging.treeItem('frame')}>\n        <div class=\"row\">\n          <div>frame<span class=\"separator\">:</span></div>\n          ${this.#renderDeleteButton('frame')}\n        </div>\n        ${this.state.frame.map((frame, index, frames) => {\n          return html`\n            <div class=\"padded row\">\n              <devtools-suggestion-input\n                .disabled=${this.disabled}\n                .placeholder=${defaultValuesByAttribute.frame[0].toString()}\n                .value=${live(frame.toString())}\n                data-path=${`frame.${index}`}\n                @blur=${this.#handleInputBlur({\n                  attribute: 'frame',\n                  from(value) {\n                    if (this.state.frame?.[index] === undefined) {\n                      return;\n                    }\n                    return {\n                      frame: new ArrayAssignments({ [index]: value }),\n                    };\n                  },\n                  metric: Host.UserMetrics.RecordingEdited.OtherEditing,\n                })}\n              ></devtools-suggestion-input>\n              ${this.#renderInlineButton({\n                class: 'add-frame',\n                title: i18nString(UIStrings.addFrameIndex),\n                iconName: 'plus',\n                onClick: this.#handleAddOrRemoveClick(\n                  {\n                    frame: new ArrayAssignments({\n                      [index + 1]: new InsertAssignment(\n                        defaultValuesByAttribute.frame[0],\n                      ),\n                    }),\n                  },\n                  `devtools-suggestion-input[data-path=\"frame.${index + 1}\"]`,\n                  Host.UserMetrics.RecordingEdited.OtherEditing,\n                ),\n              })}\n              ${this.#renderInlineButton({\n                class: 'remove-frame',\n                title: i18nString(UIStrings.removeFrameIndex),\n                iconName: 'minus',\n                onClick: this.#handleAddOrRemoveClick(\n                  {\n                    frame: new ArrayAssignments({ [index]: undefined }),\n                  },\n                  `devtools-suggestion-input[data-path=\"frame.${Math.min(\n                    index,\n                    frames.length - 2,\n                  )}\"]`,\n                  Host.UserMetrics.RecordingEdited.OtherEditing,\n                ),\n              })}\n            </div>\n          `;\n        })}\n      </div>\n    `;\n    // clang-format on\n  }\n\n  #renderSelectorsRow(): LitHtml.TemplateResult|undefined {\n    this.#renderedAttributes.add('selectors');\n    if (this.state.selectors === undefined) {\n      return;\n    }\n    // clang-format off\n    return html`<div class=\"attribute\" data-attribute=\"selectors\" jslog=${VisualLogging.treeItem('selectors')}>\n      <div class=\"row\">\n        <div>selectors<span class=\"separator\">:</span></div>\n        <devtools-recorder-selector-picker-button\n          @selectorpicked=${this.#handleSelectorPickedEvent}\n          .disabled=${this.disabled}\n        ></devtools-recorder-selector-picker-button>\n        ${this.#renderDeleteButton('selectors')}\n      </div>\n      ${this.state.selectors.map((selector, index, selectors) => {\n        return html`<div class=\"padded row\" data-selector-path=${index}>\n            <div>selector #${index + 1}<span class=\"separator\">:</span></div>\n            ${this.#renderInlineButton({\n              class: 'add-selector',\n              title: i18nString(UIStrings.addSelector),\n              iconName: 'plus',\n              onClick: this.#handleAddOrRemoveClick(\n                {\n                  selectors: new ArrayAssignments({\n                    [index + 1]: new InsertAssignment(\n                      structuredClone(defaultValuesByAttribute.selectors[0]),\n                    ),\n                  }),\n                },\n                `devtools-suggestion-input[data-path=\"selectors.${index + 1}.0\"]`,\n                Host.UserMetrics.RecordingEdited.SelectorAdded,\n              ),\n            })}\n            ${this.#renderInlineButton({\n              class: 'remove-selector',\n              title: i18nString(UIStrings.removeSelector),\n              iconName: 'minus',\n              onClick: this.#handleAddOrRemoveClick(\n                { selectors: new ArrayAssignments({ [index]: undefined }) },\n                `devtools-suggestion-input[data-path=\"selectors.${Math.min(\n                  index,\n                  selectors.length - 2,\n                )}.0\"]`,\n                Host.UserMetrics.RecordingEdited.SelectorRemoved,\n              ),\n            })}\n          </div>\n          ${selector.map((part, partIndex, parts) => {\n            return html`<div\n              class=\"double padded row\"\n              data-selector-path=\"${index}.${partIndex}\"\n            >\n              <devtools-suggestion-input\n                .disabled=${this.disabled}\n                .placeholder=${defaultValuesByAttribute.selectors[0][0]}\n                .value=${live(part)}\n                data-path=${`selectors.${index}.${partIndex}`}\n                @blur=${this.#handleInputBlur({\n                  attribute: 'selectors',\n                  from(value) {\n                    if (\n                      this.state.selectors?.[index]?.[partIndex] === undefined\n                    ) {\n                      return;\n                    }\n                    return {\n                      selectors: new ArrayAssignments({\n                        [index]: new ArrayAssignments({\n                          [partIndex]: value,\n                        }),\n                      }),\n                    };\n                  },\n                  metric: Host.UserMetrics.RecordingEdited.SelectorPartEdited,\n                })}\n              ></devtools-suggestion-input>\n              ${this.#renderInlineButton({\n                class: 'add-selector-part',\n                title: i18nString(UIStrings.addSelectorPart),\n                iconName: 'plus',\n                onClick: this.#handleAddOrRemoveClick(\n                  {\n                    selectors: new ArrayAssignments({\n                      [index]: new ArrayAssignments({\n                        [partIndex + 1]: new InsertAssignment(\n                          defaultValuesByAttribute.selectors[0][0],\n                        ),\n                      }),\n                    }),\n                  },\n                  `devtools-suggestion-input[data-path=\"selectors.${index}.${\n                    partIndex + 1\n                  }\"]`,\n                  Host.UserMetrics.RecordingEdited.SelectorPartAdded,\n                ),\n              })}\n              ${this.#renderInlineButton({\n                class: 'remove-selector-part',\n                title: i18nString(UIStrings.removeSelectorPart),\n                iconName: 'minus',\n                onClick: this.#handleAddOrRemoveClick(\n                  {\n                    selectors: new ArrayAssignments({\n                      [index]: new ArrayAssignments({\n                        [partIndex]: undefined,\n                      }),\n                    }),\n                  },\n                  `devtools-suggestion-input[data-path=\"selectors.${index}.${Math.min(\n                    partIndex,\n                    parts.length - 2,\n                  )}\"]`,\n                  Host.UserMetrics.RecordingEdited.SelectorPartRemoved,\n                ),\n              })}\n            </div>`;\n          })}`;\n      })}\n    </div>`;\n    // clang-format on\n  }\n\n  #renderAssertedEvents(): LitHtml.TemplateResult|undefined {\n    this.#renderedAttributes.add('assertedEvents');\n    if (this.state.assertedEvents === undefined) {\n      return;\n    }\n    // clang-format off\n    return html`<div class=\"attribute\" data-attribute=\"assertedEvents\" jslog=${VisualLogging.treeItem('asserted-events')}>\n      <div class=\"row\">\n        <div>asserted events<span class=\"separator\">:</span></div>\n        ${this.#renderDeleteButton('assertedEvents')}\n      </div>\n      ${this.state.assertedEvents.map((event, index) => {\n        return html` <div class=\"padded row\" jslog=${VisualLogging.treeItem('event-type')}>\n            <div>type<span class=\"separator\">:</span></div>\n            <div>${event.type}</div>\n          </div>\n          <div class=\"padded row\" jslog=${VisualLogging.treeItem('event-title')}>\n            <div>title<span class=\"separator\">:</span></div>\n            <devtools-suggestion-input\n              .disabled=${this.disabled}\n              .placeholder=${defaultValuesByAttribute.assertedEvents[0].title}\n              .value=${live(event.title ?? '')}\n              @blur=${this.#handleInputBlur({\n                attribute: 'assertedEvents',\n                from(value) {\n                  if (this.state.assertedEvents?.[index]?.title === undefined) {\n                    return;\n                  }\n                  return {\n                    assertedEvents: new ArrayAssignments({\n                      [index]: { title: value },\n                    }),\n                  };\n                },\n                metric: Host.UserMetrics.RecordingEdited.OtherEditing,\n              })}\n            ></devtools-suggestion-input>\n          </div>\n          <div class=\"padded row\" jslog=${VisualLogging.treeItem('event-url')}>\n            <div>url<span class=\"separator\">:</span></div>\n            <devtools-suggestion-input\n              .disabled=${this.disabled}\n              .placeholder=${defaultValuesByAttribute.assertedEvents[0].url}\n              .value=${live(event.url ?? '')}\n              @blur=${this.#handleInputBlur({\n                attribute: 'url',\n                from(value) {\n                  if (this.state.assertedEvents?.[index]?.url === undefined) {\n                    return;\n                  }\n                  return {\n                    assertedEvents: new ArrayAssignments({\n                      [index]: { url: value },\n                    }),\n                  };\n                },\n                metric: Host.UserMetrics.RecordingEdited.OtherEditing,\n              })}\n            ></devtools-suggestion-input>\n          </div>`;\n      })}\n    </div> `;\n    // clang-format on\n  }\n\n  #renderAttributesRow(): LitHtml.TemplateResult|undefined {\n    this.#renderedAttributes.add('attributes');\n    if (this.state.attributes === undefined) {\n      return;\n    }\n    // clang-format off\n    return html`<div class=\"attribute\" data-attribute=\"attributes\" jslog=${VisualLogging.treeItem('attributes')}>\n      <div class=\"row\">\n        <div>attributes<span class=\"separator\">:</span></div>\n        ${this.#renderDeleteButton('attributes')}\n      </div>\n      ${this.state.attributes.map(({ name, value }, index, attributes) => {\n        return html`<div class=\"padded row\" jslog=${VisualLogging.treeItem('attribute')}>\n          <devtools-suggestion-input\n            .disabled=${this.disabled}\n            .placeholder=${defaultValuesByAttribute.attributes[0].name}\n            .value=${live(name)}\n            data-path=${`attributes.${index}.name`}\n            jslog=${VisualLogging.key().track({change: true})}\n            @blur=${this.#handleInputBlur({\n              attribute: 'attributes',\n              from(name) {\n                if (this.state.attributes?.[index]?.name === undefined) {\n                  return;\n                }\n                Host.userMetrics.recordingAssertion(\n                  Host.UserMetrics.RecordingAssertion.AttributeAssertionEdited,\n                );\n                return {\n                  attributes: new ArrayAssignments({ [index]: { name } }),\n                };\n              },\n              metric: Host.UserMetrics.RecordingEdited.OtherEditing,\n            })}\n          ></devtools-suggestion-input>\n          <span class=\"separator\">:</span>\n          <devtools-suggestion-input\n            .disabled=${this.disabled}\n            .placeholder=${defaultValuesByAttribute.attributes[0].value}\n            .value=${live(value)}\n            data-path=${`attributes.${index}.value`}\n            @blur=${this.#handleInputBlur({\n              attribute: 'attributes',\n              from(value) {\n                if (this.state.attributes?.[index]?.value === undefined) {\n                  return;\n                }\n                Host.userMetrics.recordingAssertion(\n                  Host.UserMetrics.RecordingAssertion.AttributeAssertionEdited,\n                );\n                return {\n                  attributes: new ArrayAssignments({ [index]: { value } }),\n                };\n              },\n              metric: Host.UserMetrics.RecordingEdited.OtherEditing,\n            })}\n          ></devtools-suggestion-input>\n          ${this.#renderInlineButton({\n            class: 'add-attribute-assertion',\n            title: i18nString(UIStrings.addSelectorPart),\n            iconName: 'plus',\n            onClick: this.#handleAddOrRemoveClick(\n              {\n                attributes: new ArrayAssignments({\n                  [index + 1]: new InsertAssignment(\n                    (() => {\n                      {\n                        const names = new Set(\n                          attributes.map(({ name }) => name),\n                        );\n                        const defaultAttribute =\n                          defaultValuesByAttribute.attributes[0];\n                        let name = defaultAttribute.name;\n                        let i = 0;\n                        while (names.has(name)) {\n                          ++i;\n                          name = `${defaultAttribute.name}-${i}`;\n                        }\n                        return { ...defaultAttribute, name };\n                      }\n                    })(),\n                  ),\n                }),\n              },\n              `devtools-suggestion-input[data-path=\"attributes.${\n                index + 1\n              }.name\"]`,\n              Host.UserMetrics.RecordingEdited.OtherEditing,\n            ),\n          })}\n          ${this.#renderInlineButton({\n            class: 'remove-attribute-assertion',\n            title: i18nString(UIStrings.removeSelectorPart),\n            iconName: 'minus',\n            onClick: this.#handleAddOrRemoveClick(\n              { attributes: new ArrayAssignments({ [index]: undefined }) },\n              `devtools-suggestion-input[data-path=\"attributes.${Math.min(\n                index,\n                attributes.length - 2,\n              )}.value\"]`,\n              Host.UserMetrics.RecordingEdited.OtherEditing,\n            ),\n          })}\n        </div>`;\n      })}\n    </div>`;\n    // clang-format on\n  }\n\n  #renderAddRowButtons(): Array<LitHtml.TemplateResult|undefined> {\n    const attributes = attributesByType[this.state.type];\n    return [...attributes.optional].filter(attr => this.state[attr] === undefined).map(attr => {\n      // clang-format off\n        return html`<devtools-button\n          .variant=${Buttons.Button.Variant.OUTLINED}\n          class=\"add-row\"\n          data-attribute=${attr}\n          jslog=${VisualLogging.action(`add-${Platform.StringUtilities.toKebabCase(attr)}`)}\n          @click=${this.#handleAddRowClickEvent}\n        >\n          ${i18nString(UIStrings.addAttribute, {\n            attributeName: attr,\n          })}\n        </devtools-button>`;\n      // clang-format on\n    });\n  }\n\n  #ensureFocus = (query: string): void => {\n    void this.updateComplete.then(() => {\n      const node = this.renderRoot.querySelector<HTMLElement>(query);\n      node?.focus();\n    });\n  };\n\n  protected override render(): LitHtml.TemplateResult {\n    this.#renderedAttributes = new Set();\n\n    // clang-format off\n    const result = html`\n      <div class=\"wrapper\" jslog=${VisualLogging.tree('step-editor')}>\n        ${this.#renderTypeRow(this.isTypeEditable)} ${this.#renderRow('target')}\n        ${this.#renderFrameRow()} ${this.#renderSelectorsRow()}\n        ${this.#renderRow('deviceType')} ${this.#renderRow('button')}\n        ${this.#renderRow('url')} ${this.#renderRow('x')}\n        ${this.#renderRow('y')} ${this.#renderRow('offsetX')}\n        ${this.#renderRow('offsetY')} ${this.#renderRow('value')}\n        ${this.#renderRow('key')} ${this.#renderRow('operator')}\n        ${this.#renderRow('count')} ${this.#renderRow('expression')}\n        ${this.#renderRow('duration')} ${this.#renderAssertedEvents()}\n        ${this.#renderRow('timeout')} ${this.#renderRow('width')}\n        ${this.#renderRow('height')} ${this.#renderRow('deviceScaleFactor')}\n        ${this.#renderRow('isMobile')} ${this.#renderRow('hasTouch')}\n        ${this.#renderRow('isLandscape')} ${this.#renderRow('download')}\n        ${this.#renderRow('upload')} ${this.#renderRow('latency')}\n        ${this.#renderRow('name')} ${this.#renderRow('parameters')}\n        ${this.#renderRow('visible')} ${this.#renderRow('properties')}\n        ${this.#renderAttributesRow()}\n        ${this.error\n          ? html`\n              <div class=\"error\">\n                ${i18nString(UIStrings.notSaved, {\n                  error: this.error,\n                })}\n              </div>\n            `\n          : undefined}\n        ${!this.disabled\n          ? html`<div\n              class=\"row-buttons wrapped gap row regular-font no-margin\"\n            >\n              ${this.#renderAddRowButtons()}\n            </div>`\n          : undefined}\n      </div>\n    `;\n\n    // clang-format on\n    for (const key of Object.keys(dataTypeByAttribute)) {\n      if (!this.#renderedAttributes.has(key as Attribute)) {\n        throw new Error(`The editable attribute ${key} does not have UI`);\n      }\n    }\n\n    return result;\n  }\n}\n"]}