{"version":3,"file":"StorageMetadataView.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/application/components/StorageMetadataView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as SDK from '../../../core/sdk/sdk.js';\nimport * as Protocol from '../../../generated/protocol.js';\nimport {\n  getCleanTextContentFromElements,\n  getElementWithinComponent,\n  renderElementIntoDOM,\n} from '../../../testing/DOMHelpers.js';\nimport {describeWithLocale} from '../../../testing/EnvironmentHelpers.js';\nimport * as Coordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\nimport * as ReportView from '../../../ui/components/report_view/report_view.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\n\nimport * as ApplicationComponents from './components.js';\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\nasync function makeView(\n    storageKeyOrBucketInfo: string|Protocol.Storage.StorageBucketInfo,\n    storageBucketsModel?: SDK.StorageBucketsModel.StorageBucketsModel) {\n  const component = new ApplicationComponents.StorageMetadataView.StorageMetadataView();\n  renderElementIntoDOM(component);\n  if (storageBucketsModel) {\n    component.enableStorageBucketControls(storageBucketsModel);\n  }\n  if (typeof storageKeyOrBucketInfo === 'string') {\n    component.setStorageKey(storageKeyOrBucketInfo);\n  } else {\n    component.setStorageBucket(storageKeyOrBucketInfo);\n  }\n  await coordinator.done();\n  return component;\n}\n\ndescribeWithLocale('SharedStorageMetadataView', () => {\n  it('renders with an origin only', async () => {\n    const component = await makeView('https://example.com/');\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    const {textContent} = report.shadowRoot!.querySelector('.report-title')!;\n    assert.strictEqual(textContent, 'https://example.com');\n\n    assert.isNotNull(component.shadowRoot);\n\n    const keys = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-key');\n    assert.deepEqual(keys, [\n      'Origin',\n    ]);\n\n    const values = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-value');\n    assert.deepEqual(values, [\n      'https://example.com',\n    ]);\n  });\n\n  it('renders with an top-level site', async () => {\n    const component = await makeView('https://example.com/^0https://test.example');\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    const {textContent} = report.shadowRoot!.querySelector('.report-title')!;\n    assert.strictEqual(textContent, 'https://example.com');\n\n    assert.isNotNull(component.shadowRoot);\n\n    const keys = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-key');\n    assert.deepEqual(keys, ['Origin', 'Top-level site', 'Is third-party']);\n\n    const values = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-value');\n    assert.deepEqual(\n        values,\n        ['https://example.com', 'https://test.example', 'Yes, because the origin is outside of the top-level site']);\n  });\n\n  it('renders with an opaque top-level site', async () => {\n    const component = await makeView('https://example.com/^43735928559^5110521^6');\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    const {textContent} = report.shadowRoot!.querySelector('.report-title')!;\n    assert.strictEqual(textContent, 'https://example.com');\n\n    assert.isNotNull(component.shadowRoot);\n\n    const keys = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-key');\n    assert.deepEqual(keys, ['Origin', 'Top-level site', 'Is third-party', 'Is opaque']);\n\n    const values = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-value');\n    assert.deepEqual(values, [\n      'https://example.com',\n      '(opaque)',\n      'Yes, because the top-level site is opaque',\n      'Yes, because the top-level site is opaque',\n    ]);\n  });\n\n  it('renders with an opaque key', async () => {\n    const component = await makeView('https://example.com/^13735928559^2110521');\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    const {textContent} = report.shadowRoot!.querySelector('.report-title')!;\n    assert.strictEqual(textContent, 'https://example.com');\n\n    assert.isNotNull(component.shadowRoot);\n\n    const keys = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-key');\n    assert.deepEqual(keys, ['Origin', 'Is third-party', 'Is opaque']);\n\n    const values = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-value');\n    assert.deepEqual(values, ['https://example.com', 'Yes, because the storage key is opaque', 'Yes']);\n  });\n\n  it('renders with a cross-site ancestor chain', async () => {\n    const component = await makeView('https://example.com/^31');\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    const {textContent} = report.shadowRoot!.querySelector('.report-title')!;\n    assert.strictEqual(textContent, 'https://example.com');\n\n    assert.isNotNull(component.shadowRoot);\n\n    const keys = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-key');\n    assert.deepEqual(keys, ['Origin', 'Is third-party']);\n\n    const values = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-value');\n    assert.deepEqual(values, ['https://example.com', 'Yes, because the ancestry chain contains a third-party origin']);\n  });\n\n  it('renders with a bucket', async () => {\n    const component = await makeView({\n      bucket: {storageKey: 'https://example.com/^31', name: 'My Bucket'},\n      id: 'BUCKET_ID',\n      persistent: true,\n      durability: Protocol.Storage.StorageBucketsDurability.Relaxed,\n      quota: 4096,\n      expiration: 42,\n    });\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    const {textContent} = report.shadowRoot!.querySelector('.report-title')!;\n    assert.strictEqual(textContent, 'https://example.com');\n\n    assert.isNotNull(component.shadowRoot);\n\n    const keys = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-key');\n    assert.deepEqual(\n        keys, ['Origin', 'Is third-party', 'Bucket name', 'Is persistent', 'Durability', 'Quota', 'Expiration']);\n\n    const values = getCleanTextContentFromElements(component.shadowRoot, 'devtools-report-value');\n    assert.deepEqual(values, [\n      'https://example.com',\n      'Yes, because the ancestry chain contains a third-party origin',\n      'My Bucket',\n      'Yes',\n      'relaxed',\n      '4.1Â kB',\n      (new Date(42000)).toLocaleString(),\n    ]);\n  });\n\n  it('renders with an emtpy string title', async () => {\n    const component = await makeView('');\n\n    const report = getElementWithinComponent(component, 'devtools-report', ReportView.ReportView.Report);\n    assert.isNull(report.shadowRoot!.querySelector('.report-title'));\n  });\n\n  it('renders bucket controls', async () => {\n    const storageBucketsModel = {\n      deleteBucket: sinon.spy(),\n      target: () => ({\n        model: () => ({\n          getBucketByName: () => null,\n        }),\n      }),\n    };\n\n    const storageBucket = {\n      storageKey: 'https://example.com/^31',\n      name: 'My Bucket',\n    };\n\n    const component = await makeView(\n        {\n          bucket: storageBucket,\n          id: 'BUCKET_ID',\n          persistent: true,\n          durability: Protocol.Storage.StorageBucketsDurability.Relaxed,\n          quota: 4096,\n          expiration: 42,\n        },\n        storageBucketsModel as unknown as SDK.StorageBucketsModel.StorageBucketsModel);\n\n    const buttons = component.shadowRoot!.querySelectorAll('devtools-button');\n\n    assert.strictEqual(buttons.length, 1);\n\n    const [deleteButton] = buttons;\n    assert.instanceOf(deleteButton, HTMLElement);\n    assert.strictEqual(deleteButton.textContent!.trim(), 'Delete bucket');\n\n    const showDialog = sinon.stub(UI.UIUtils.ConfirmDialog, 'show').resolves(true);\n    deleteButton.click();\n    assert.isTrue(showDialog.calledOnce);\n\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.isTrue(storageBucketsModel.deleteBucket.calledOnceWithExactly(storageBucket));\n  });\n});\n"]}