{"version":3,"file":"TopLayerContainer.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/elements/TopLayerContainer.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAI7B,OAAO,EAAC,YAAY,EAAC,MAAM,qCAAqC,CAAC;AACjE,OAAO,EAAC,0BAA0B,EAAC,MAAM,iCAAiC,CAAC;AAC3E,OAAO,KAAK,QAAQ,MAAM,0CAA0C,CAAC;AAErE,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAC;AAE1C,MAAM,mBAAmB,GAAG,CAAC,QAAgB,EAAE,aAAqB,EAAE,aAAuC,EAAE,EAAE;IAC/G,OAAO;QACL,QAAQ,EAAE,GAAG,EAAE,CAAC,QAAQ;QACxB,aAAa,EAAE,GAAG,EAAE,CAAC,aAAa;QAClC,aAAa;KACU,CAAC;AAC5B,CAAC,CAAC;AAEF,MAAM,uBAAuB,GAAG,GAAG,EAAE;IACnC,OAAO;QACL,KAAK,EAAE,CAAC,OAAuB,EAAE,EAAE,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE;KACf,CAAC;AACxD,CAAC,CAAC;AAEF,0BAA0B,CAAC,mBAAmB,EAAE,GAAG,EAAE;IACnD,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;QAC1D,MAAM,YAAY,GAAG,EAA8B,CAAC;QACpD,MAAM,gBAAgB,GAAG,mBAAmB,CAAC,QAAQ,EAAE,CAAC,EAAE,YAAY,CAAC,CAAC;QACxE,MAAM,gBAAgB,GAAG,mBAAmB,CAAC,KAAK,EAAE,CAAC,EAAE,YAAY,CAAC,CAAC;QACrE,MAAM,QAAQ,GAAG;YACf,MAAM,EAAE,GAAG,EAAE,CAAC,YAAY,EAAE;YAC5B,mBAAmB,EAAE,KAAK,IAAI,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAwB,EAAE,CAAwB,CAAC,CAAC;YACtG,WAAW,EAAE,IAAI,GAAG,CAAC;gBACnB,CAAC,CAAC,EAAE,gBAAgB,CAAC;gBACrB,CAAC,CAAC,EAAE,gBAAgB,CAAC;aACtB,CAAC;SACsB,CAAC;QAC3B,YAAY,CAAC,QAAQ,GAAG,GAAG,EAAE,CAAC,QAAQ,CAAC;QAEvC,MAAM,iBAAiB,GAAG,uBAAuB,EAAE,CAAC;QACpD,MAAM,iBAAiB,GAAG,uBAAuB,EAAE,CAAC;QACpD,MAAM,IAAI,GAAG;YACX,iBAAiB,EAAE,IAAI,OAAO,CAAC;gBAC7B,CAAC,gBAAgB,EAAE,iBAAiB,CAAC;gBACrC,CAAC,gBAAgB,EAAE,iBAAiB,CAAC;aACtC,CAAC;SACiD,CAAC;QAEtD,MAAM,iBAAiB,GAAG,IAAI,QAAQ,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;QAC/F,MAAM,iBAAiB,CAAC,sBAAsB,EAAE,CAAC;QACjD,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IACxE,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport {createTarget} from '../../testing/EnvironmentHelpers.js';\nimport {describeWithMockConnection} from '../../testing/MockConnection.js';\nimport * as Adorners from '../../ui/components/adorners/adorners.js';\n\nimport * as Elements from './elements.js';\n\nconst stubTopLayerDOMNode = (nodeName: string, backendNodeId: number, ownerDocument: SDK.DOMModel.DOMDocument) => {\n  return {\n    nodeName: () => nodeName,\n    backendNodeId: () => backendNodeId,\n    ownerDocument,\n  } as SDK.DOMModel.DOMNode;\n};\n\nconst stubElementsTreeElement = () => {\n  return {\n    adorn: (_unused: {name: string}) => new Adorners.Adorner.Adorner(),\n  } as Elements.ElementsTreeElement.ElementsTreeElement;\n};\n\ndescribeWithMockConnection('TopLayerContainer', () => {\n  it('should update top layer elements correctly', async () => {\n    const stubDocument = {} as SDK.DOMModel.DOMDocument;\n    const topLayerDOMNode1 = stubTopLayerDOMNode('dialog', 1, stubDocument);\n    const topLayerDOMNode2 = stubTopLayerDOMNode('div', 2, stubDocument);\n    const domModel = {\n      target: () => createTarget(),\n      getTopLayerElements: async () => Promise.resolve([1 as Protocol.DOM.NodeId, 2 as Protocol.DOM.NodeId]),\n      idToDOMNode: new Map([\n        [1, topLayerDOMNode1],\n        [2, topLayerDOMNode2],\n      ]),\n    } as SDK.DOMModel.DOMModel;\n    stubDocument.domModel = () => domModel;\n\n    const topLayerTreeNode1 = stubElementsTreeElement();\n    const topLayerTreeNode2 = stubElementsTreeElement();\n    const tree = {\n      treeElementByNode: new WeakMap([\n        [topLayerDOMNode1, topLayerTreeNode1],\n        [topLayerDOMNode2, topLayerTreeNode2],\n      ]),\n    } as Elements.ElementsTreeOutline.ElementsTreeOutline;\n\n    const topLayerContainer = new Elements.TopLayerContainer.TopLayerContainer(tree, stubDocument);\n    await topLayerContainer.updateTopLayerElements();\n    assert.strictEqual(topLayerContainer.currentTopLayerDOMNodes.size, 2);\n  });\n});\n"]}