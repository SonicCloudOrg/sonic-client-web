{"version":3,"file":"WebCustomData.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/elements/WebCustomData.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAC;AAE1C,QAAQ,CAAC,eAAe,EAAE,GAAG,EAAE;IAC7B,IAAI,SAA0B,CAAC;IAC/B,IAAI,YAAqC,CAAC;IAC1C,IAAI,WAAqC,CAAC;IAE1C,UAAU,CAAC,GAAG,EAAE;QACd,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QACxC,SAAS,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;YACzC,WAAW,GAAG,GAAG,CAAC;YAClB,qEAAqE;YACrE,YAAY,GAAG,CAAC,KAAa,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;gBACxE,MAAM,EAAE,GAAG;gBACX,OAAO,EAAE,EAAC,cAAc,EAAE,kBAAkB,EAAC;aAC9C,CAAC,CAAC,CAAC;QACN,CAAC,CAAC,CAAC,CAAC;IACN,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACb,YAAY,CAAC,EAAE,CAAC,CAAC,CAAE,6CAA6C;QAChE,SAAS,CAAC,OAAO,EAAE,CAAC;IACtB,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE;QAC/B,EAAE,CAAC,0BAA0B,EAAE,KAAK,IAAI,EAAE;YACxC,MAAM,aAAa,GAAG,IAAI,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC;YAC9F,YAAY,CAAC;gBACX,UAAU,EAAE;oBACV,EAAC,IAAI,EAAE,SAAS,EAAE,WAAW,EAAE,oCAAoC,EAAC;iBACrE;aACF,CAAC,CAAC;YACH,MAAM,aAAa,CAAC,mBAAmB,CAAC;YAExC,MAAM,QAAQ,GAAG,aAAa,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;YAE1D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACxB,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YAC7C,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,WAAW,EAAE,oCAAoC,CAAC,CAAC;QACjF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;YAC5D,MAAM,aAAa,GAAG,IAAI,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC;YAE9F,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+CAA+C,EAAE,KAAK,IAAI,EAAE;YAC7D,MAAM,aAAa,GAAG,IAAI,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC;YAC9F,WAAW,CAAC,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACzC,IAAI,CAAC;gBACH,MAAM,aAAa,CAAC,mBAAmB,CAAC;gBACxC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,yBAAyB,CAAC,CAAC;YAClD,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;YACb,CAAC;YAED,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,KAAK,IAAI,EAAE;YAClE,MAAM,aAAa,GAAG,IAAI,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC;YAC9F,YAAY,CAAC;gBACX,UAAU,EAAE;oBACV,EAAC,IAAI,EAAE,SAAS,EAAC;oBACjB,EAAC,IAAI,EAAE,MAAM,EAAC;iBACf;aACF,CAAC,CAAC;YACH,MAAM,aAAa,CAAC,mBAAmB,CAAC;YAExC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC,CAAC;QAClE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Elements from './elements.js';\n\ndescribe('WebCustomData', () => {\n  let fetchStub: sinon.SinonStub;\n  let fetchResolve: (value: object) => void;\n  let fetchReject: (error: unknown) => void;\n\n  beforeEach(() => {\n    fetchStub = sinon.stub(window, 'fetch');\n    fetchStub.returns(new Promise((res, rej) => {\n      fetchReject = rej;\n      // Allow users to provide the plain JSON. We turn it into a response.\n      fetchResolve = (value: object) => res(new Response(JSON.stringify(value), {\n        status: 200,\n        headers: {'Content-type': 'application/json'},\n      }));\n    }));\n  });\n\n  afterEach(() => {\n    fetchResolve({});  // Resolve for our pending promise detection.\n    fetchStub.restore();\n  });\n\n  describe('findCssProperty', () => {\n    it('returns the correct info', async () => {\n      const webCustomData = new Elements.WebCustomData.WebCustomData('http://does-not-matter.com/');\n      fetchResolve({\n        properties: [\n          {name: 'display', description: 'In combiniation with \\'float\\' ...'},\n        ],\n      });\n      await webCustomData.fetchPromiseForTest;\n\n      const property = webCustomData.findCssProperty('display');\n\n      assert.exists(property);\n      assert.strictEqual(property.name, 'display');\n      assert.strictEqual(property.description, 'In combiniation with \\'float\\' ...');\n    });\n\n    it('returns undefined while the .json is loading', async () => {\n      const webCustomData = new Elements.WebCustomData.WebCustomData('http://does-not-matter.com/');\n\n      assert.isUndefined(webCustomData.findCssProperty('display'));\n    });\n\n    it('returns undefined if the .json loading failed', async () => {\n      const webCustomData = new Elements.WebCustomData.WebCustomData('http://does-not-matter.com/');\n      fetchReject(new Error('failed to load'));\n      try {\n        await webCustomData.fetchPromiseForTest;\n        assert.isTrue(false, 'Expected await to throw');\n      } catch (e) {\n      }\n\n      assert.isUndefined(webCustomData.findCssProperty('display'));\n    });\n\n    it('returns undefind if the CSS property was not found', async () => {\n      const webCustomData = new Elements.WebCustomData.WebCustomData('http://does-not-matter.com/');\n      fetchResolve({\n        properties: [\n          {name: 'display'},\n          {name: 'flex'},\n        ],\n      });\n      await webCustomData.fetchPromiseForTest;\n\n      assert.isUndefined(webCustomData.findCssProperty('funky-prop'));\n    });\n  });\n});\n"]}