{"version":3,"file":"StylePropertyHighlighter.js","sourceRoot":"","sources":["../../../../../../front_end/panels/elements/StylePropertyHighlighter.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport {PanelUtils} from '../utils/utils.js';\n\nimport {type StylePropertiesSection} from './StylePropertiesSection.js';\nimport {StylePropertyTreeElement} from './StylePropertyTreeElement.js';\nimport {type StylesSidebarPane} from './StylesSidebarPane.js';\n\nexport class StylePropertyHighlighter {\n  private readonly styleSidebarPane: StylesSidebarPane;\n  constructor(ssp: StylesSidebarPane) {\n    this.styleSidebarPane = ssp;\n  }\n\n  /**\n   * Expand all shorthands, find the given property, scroll to it and highlight it.\n   */\n  highlightProperty(cssProperty: SDK.CSSProperty.CSSProperty): void {\n    // Expand all shorthands.\n    for (const section of this.styleSidebarPane.allSections()) {\n      for (let treeElement = section.propertiesTreeOutline.firstChild(); treeElement;\n           treeElement = treeElement.nextSibling) {\n        void treeElement.onpopulate();\n      }\n    }\n\n    const section =\n        this.styleSidebarPane.allSections().find(section => section.style().leadingProperties().includes(cssProperty));\n    if (!section) {\n      return;\n    }\n    section.showAllItems();\n\n    const treeElement = this.findTreeElementFromSection(treeElement => treeElement.property === cssProperty, section);\n    if (treeElement) {\n      treeElement.parent && treeElement.parent.expand();\n      this.scrollAndHighlightTreeElement(treeElement);\n      section.element.focus();\n    }\n  }\n\n  findAndHighlightSectionBlock(sectionBlockName: string): void {\n    const block = this.styleSidebarPane.getSectionBlockByName(sectionBlockName);\n    if (!block || block.sections.length === 0) {\n      return;\n    }\n    const [section] = block.sections;\n    section.showAllItems();\n    PanelUtils.highlightElement(block.titleElement() as HTMLElement);\n  }\n\n  findAndHighlightSection(sectionName: string, blockName: string): void {\n    const block = this.styleSidebarPane.getSectionBlockByName(blockName);\n    const section = block?.sections.find(section => section.headerText() === sectionName);\n    if (!section || !block) {\n      return;\n    }\n    block.expand(true);\n    section.showAllItems();\n    PanelUtils.highlightElement(section.element);\n  }\n\n  /**\n   * Find the first non-overridden property that matches the provided name, scroll to it and highlight it.\n   */\n  findAndHighlightPropertyName(propertyName: string, sectionName?: string, blockName?: string): boolean {\n    const block = blockName ? this.styleSidebarPane.getSectionBlockByName(blockName) : undefined;\n    const sections = block?.sections ?? this.styleSidebarPane.allSections();\n    if (!sections) {\n      return false;\n    }\n    for (const section of sections) {\n      if (sectionName && section.headerText() !== sectionName) {\n        continue;\n      }\n      if (!section.style().hasActiveProperty(propertyName)) {\n        continue;\n      }\n      block?.expand(true);\n      section.showAllItems();\n      const treeElement = this.findTreeElementFromSection(\n          treeElement => treeElement.property.name === propertyName && !treeElement.overloaded(), section);\n      if (treeElement) {\n        this.scrollAndHighlightTreeElement(treeElement);\n        section.element.focus();\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Traverse the styles pane tree, execute the provided callback for every tree element found, and\n   * return the first tree element and corresponding section for which the callback returns a truthy value.\n   */\n  private findTreeElementAndSection(compareCb: (arg0: StylePropertyTreeElement) => boolean): {\n    treeElement: StylePropertyTreeElement|null,\n    section: StylePropertiesSection|null,\n  } {\n    for (const section of this.styleSidebarPane.allSections()) {\n      const treeElement = this.findTreeElementFromSection(compareCb, section);\n      if (treeElement) {\n        return {treeElement, section};\n      }\n    }\n    return {treeElement: null, section: null};\n  }\n\n  private findTreeElementFromSection(\n      compareCb: (arg0: StylePropertyTreeElement) => boolean, section: StylePropertiesSection): StylePropertyTreeElement\n      |null {\n    let treeElement = section.propertiesTreeOutline.firstChild();\n    while (treeElement && (treeElement instanceof StylePropertyTreeElement)) {\n      if (compareCb(treeElement)) {\n        return treeElement;\n      }\n      treeElement = treeElement.traverseNextTreeElement(false, null, true);\n    }\n    return null;\n  }\n\n  private scrollAndHighlightTreeElement(treeElement: StylePropertyTreeElement): void {\n    PanelUtils.highlightElement(treeElement.listItemElement);\n  }\n}\n"]}