{"version":3,"file":"AnchorFunctionLinkSwatch.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/AnchorFunctionLinkSwatch.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as SDK from '../../../core/sdk/sdk.js';\nimport * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as InlineEditor from '../../../ui/legacy/components/inline_editor/inline_editor.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport anchorFunctionLinkSwatchStyles from './anchorFunctionLinkSwatch.css.js';\n\nconst UIStrings = {\n  /**\n   *@description Title in the styles tab for the icon button for jumping to the anchor node.\n   */\n  jumpToAnchorNode: 'Jump to anchor node',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/components/AnchorFunctionLinkSwatch.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {render, html} = LitHtml;\n\n// Clang format is messing up the formatting of the functions below. It's best\n// to leave formatting off for this type declaration.\n// clang-format off\nexport type AnchorFunctionLinkSwatchData = {\n  // The dashed identifier for the anchor function.\n  // It is undefined when we're rendering for implicit or default anchor cases.\n  identifier?: string,\n  // The anchor node, it is undefined when it is not resolved correctly.\n  anchorNode?: SDK.DOMModel.DOMNode,\n  // Whether to add a space after the link or not. This is needed because for some cases,\n  // even though the link swatch is created; there might not be any links rendered for it.\n  // So adding the space from the outside causes an unnecessary space to be rendered for these cases.\n  // That's the reason we're controlling space behavior from the inside.\n  // However for `position-anchor: --dashed-ident` case, there is no space needed at all.\n  // That's why we need the parameter so that we don't render a space for that case.\n  needsSpace?: boolean,\n  onLinkActivate: () => void,\n  onMouseEnter: () => void,\n  onMouseLeave: () => void,\n};\n// clang-format on\n\nexport class AnchorFunctionLinkSwatch extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-anchor-function-link-swatch`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #data: AnchorFunctionLinkSwatchData;\n\n  constructor(data: AnchorFunctionLinkSwatchData) {\n    super();\n    this.#data = data;\n  }\n\n  dataForTest(): AnchorFunctionLinkSwatchData {\n    return this.#data;\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [anchorFunctionLinkSwatchStyles];\n    this.render();\n  }\n\n  set data(data: AnchorFunctionLinkSwatchData) {\n    this.#data = data;\n    this.render();\n  }\n\n  #handleIconClick(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.#data.onLinkActivate();\n  }\n\n  #renderIdentifierLink(): LitHtml.LitTemplate {\n    // clang-format off\n    return html`<${InlineEditor.LinkSwatch.LinkSwatch.litTagName}\n      @mouseenter=${this.#data.onMouseEnter}\n      @mouseleave=${this.#data.onMouseLeave}\n      .data=${{\n        text: this.#data.identifier,\n        isDefined: Boolean(this.#data.anchorNode),\n        jslogContext: 'anchor-link',\n        onLinkActivate: this.#data.onLinkActivate,\n      } as InlineEditor.LinkSwatch.LinkSwatchRenderData}></${InlineEditor.LinkSwatch.LinkSwatch.litTagName}>`;\n    // clang-format on\n  }\n\n  #renderIconLink(): LitHtml.LitTemplate {\n    // clang-format off\n    return html`<${IconButton.Icon.Icon.litTagName}\n      role='button'\n      title=${i18nString(UIStrings.jumpToAnchorNode)}\n      class='icon-link'\n      name='open-externally'\n      jslog=${VisualLogging.action('jump-to-anchor-node').track({click: true})}\n      @mouseenter=${this.#data.onMouseEnter}\n      @mouseleave=${this.#data.onMouseLeave}\n      @mousedown=${(ev: MouseEvent) => ev.stopPropagation()}\n      @click=${this.#handleIconClick}\n    ></${IconButton.Icon.Icon.litTagName}>`;\n    // clang-format on\n  }\n\n  protected render(): void {\n    if (!this.#data.identifier && !this.#data.anchorNode) {\n      return;\n    }\n\n    if (this.#data.identifier) {\n      // clang-format off\n      render(html`${this.#renderIdentifierLink()}${this.#data.needsSpace ? ' ' : ''}`, this.#shadow, {host: this});\n      // clang-format on\n    } else {\n      // clang-format off\n      render(html`${this.#renderIconLink()}${this.#data.needsSpace ? ' ' : ''}`, this.#shadow, {host: this});\n      // clang-format on\n    }\n  }\n}\n\ncustomElements.define('devtools-anchor-function-link-swatch', AnchorFunctionLinkSwatch);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-anchor-function-link-swatch': AnchorFunctionLinkSwatch;\n  }\n}\n"]}