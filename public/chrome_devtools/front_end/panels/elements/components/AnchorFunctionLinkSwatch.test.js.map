{"version":3,"file":"AnchorFunctionLinkSwatch.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/AnchorFunctionLinkSwatch.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport {renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport * as InlineEditor from '../../../ui/legacy/components/inline_editor/inline_editor.js';\n\nimport * as ElementsComponents from './components.js';\n\nfunction createAnchorFunctionLinkSwatch(\n    props: Partial<ElementsComponents.AnchorFunctionLinkSwatch.AnchorFunctionLinkSwatchData> = {}):\n    ElementsComponents.AnchorFunctionLinkSwatch.AnchorFunctionLinkSwatch {\n  return new ElementsComponents.AnchorFunctionLinkSwatch.AnchorFunctionLinkSwatch({\n    onLinkActivate: () => {},\n    onMouseEnter: () => {},\n    onMouseLeave: () => {},\n    ...props,\n  });\n}\n\ndescribeWithEnvironment('AnchorFunctionLinkSwatch', () => {\n  describe('when identifier exists', () => {\n    let linkSwatchDataStub: {\n      set: sinon.SinonSpy,\n    };\n\n    beforeEach(() => {\n      linkSwatchDataStub = sinon.spy(InlineEditor.LinkSwatch.LinkSwatch.prototype, 'data', ['set']);\n    });\n\n    afterEach(() => {\n      linkSwatchDataStub.set.restore();\n    });\n\n    it('should render a defined link when `anchorNode` is resolved correctly', () => {\n      const component = createAnchorFunctionLinkSwatch({\n        identifier: '--identifier',\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n      });\n\n      renderElementIntoDOM(component);\n\n      assert.isTrue(linkSwatchDataStub.set.calledWith({\n        text: '--identifier',\n        isDefined: true,\n        jslogContext: 'anchor-link',\n        onLinkActivate: sinon.match.func,\n      }));\n    });\n\n    it('should render an undefined link when `anchorNode` is not resolved correctly', () => {\n      const component = createAnchorFunctionLinkSwatch({\n        identifier: '--identifier',\n        anchorNode: undefined,\n      });\n\n      renderElementIntoDOM(component);\n\n      assert.isTrue(linkSwatchDataStub.set.calledWith({\n        text: '--identifier',\n        isDefined: false,\n        jslogContext: 'anchor-link',\n        onLinkActivate: sinon.match.func,\n      }));\n    });\n\n    it('should call `onMouseEnter` when mouse enters linkSwatch', () => {\n      const data = {\n        identifier: '--identifier',\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n        onMouseEnter: sinon.mock(),\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n      const linkSwatch = component.shadowRoot!.querySelector('devtools-link-swatch')!;\n      linkSwatch.dispatchEvent(new Event('mouseenter'));\n\n      assert.isTrue(data.onMouseEnter.calledOnce);\n    });\n\n    it('should call `onMouseLeave` when mouse leaves linkSwatch', () => {\n      const data = {\n        identifier: '--identifier',\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n        onMouseLeave: sinon.mock(),\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n      const linkSwatch = component.shadowRoot!.querySelector('devtools-link-swatch')!;\n      linkSwatch.dispatchEvent(new Event('mouseleave'));\n\n      assert.isTrue(data.onMouseLeave.calledOnce);\n    });\n  });\n\n  describe('when identifier does not exist', () => {\n    it('should not render anything when `anchorNode` is not resolved correctly', () => {\n      const data = {\n        identifier: undefined,\n        anchorNode: undefined,\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n\n      assert.isEmpty(component.shadowRoot!.innerHTML);\n    });\n\n    it('should render icon link when `anchorNode` is resolved correctly', () => {\n      const data = {\n        identifier: undefined,\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n      const icon = component.shadowRoot?.querySelector('devtools-icon');\n\n      assert.exists(icon);\n    });\n\n    it('should call `onMouseEnter` when mouse enters the icon', () => {\n      const data = {\n        identifier: undefined,\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n        onMouseEnter: sinon.mock(),\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n      const icon = component.shadowRoot!.querySelector('devtools-icon')!;\n      icon?.dispatchEvent(new Event('mouseenter'));\n\n      assert.isTrue(data.onMouseEnter.calledOnce);\n    });\n\n    it('should call `onMouseLeave` when mouse leaves the icon', () => {\n      const data = {\n        identifier: undefined,\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n        onMouseLeave: sinon.mock(),\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n      const icon = component.shadowRoot!.querySelector('devtools-icon')!;\n      icon?.dispatchEvent(new Event('mouseleave'));\n\n      assert.isTrue(data.onMouseLeave.calledOnce);\n    });\n\n    it('should call `onLinkActivate` when clicking on the icon', () => {\n      const data = {\n        identifier: undefined,\n        anchorNode: sinon.createStubInstance(SDK.DOMModel.DOMNode),\n        onLinkActivate: sinon.mock(),\n      };\n      const component = createAnchorFunctionLinkSwatch(data);\n\n      renderElementIntoDOM(component);\n      const icon = component.shadowRoot!.querySelector('devtools-icon')!;\n      icon?.dispatchEvent(new Event('click'));\n\n      assert.isTrue(data.onLinkActivate.calledOnce);\n    });\n  });\n});\n"]}