{"version":3,"file":"NetworkOverview.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/NetworkOverview.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Common from '../../core/common/common.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport {createTarget} from '../../testing/EnvironmentHelpers.js';\nimport {describeWithMockConnection} from '../../testing/MockConnection.js';\nimport * as Coordinator from '../../ui/components/render_coordinator/render_coordinator.js';\nimport type * as PerfUI from '../../ui/legacy/components/perf_ui/perf_ui.js';\n\nimport * as Network from './network.js';\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\ndescribeWithMockConnection('NetworkOverview', () => {\n  let target: SDK.Target.Target;\n  let networkOverview: Network.NetworkOverview.NetworkOverview;\n\n  beforeEach(() => {\n    networkOverview = new Network.NetworkOverview.NetworkOverview();\n    target = createTarget();\n  });\n\n  const updatesOnEvent = <T extends keyof SDK.ResourceTreeModel.EventTypes>(\n      event: Platform.TypeScriptUtilities.NoUnion<T>, inScope: boolean) => async () => {\n    SDK.TargetManager.TargetManager.instance().setScopeTarget(inScope ? target : null);\n    const calculator = {\n      computePosition: sinon.stub(),\n      setDisplayWidth: sinon.stub(),\n      positionToTime: sinon.stub(),\n      setBounds: sinon.stub(),\n      setNavStartTimes: sinon.stub(),\n      reset: sinon.stub(),\n      formatValue: sinon.stub(),\n      maximumBoundary: sinon.stub(),\n      minimumBoundary: sinon.stub(),\n      zeroTime: sinon.stub(),\n      boundarySpan: sinon.stub(),\n    };\n    networkOverview.setCalculator(\n        calculator as unknown as PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator);\n    networkOverview.markAsRoot();\n    networkOverview.show(document.body);\n    const resourceTreeModel = target.model(SDK.ResourceTreeModel.ResourceTreeModel);\n    assert.exists(resourceTreeModel);\n    assert.isFalse(calculator.computePosition.called);\n    resourceTreeModel.dispatchEventToListeners(\n        event,\n        ...[{loadTime: 42}] as Common.EventTarget.EventPayloadToRestParameters<SDK.ResourceTreeModel.EventTypes, T>);\n    await coordinator.done();\n    assert.strictEqual(calculator.computePosition.called, inScope);\n    networkOverview.detach();\n  };\n\n  it('updates on in scope load event', updatesOnEvent(SDK.ResourceTreeModel.Events.Load, true));\n  it('does not update on out of scope load event', updatesOnEvent(SDK.ResourceTreeModel.Events.Load, false));\n  it('updates on in scope DOM content load event', updatesOnEvent(SDK.ResourceTreeModel.Events.DOMContentLoaded, true));\n  it('does not update on out of scope DOM content load event',\n     updatesOnEvent(SDK.ResourceTreeModel.Events.DOMContentLoaded, false));\n});\n"]}