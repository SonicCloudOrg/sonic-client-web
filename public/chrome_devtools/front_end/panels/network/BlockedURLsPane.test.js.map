{"version":3,"file":"BlockedURLsPane.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/BlockedURLsPane.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAG7B,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAC7C,OAAO,KAAK,IAAI,MAAM,2BAA2B,CAAC;AAClD,OAAO,EAAC,YAAY,EAAE,mBAAmB,EAAC,MAAM,qCAAqC,CAAC;AACtF,OAAO,EAAC,0BAA0B,EAAC,MAAM,iCAAiC,CAAC;AAE3E,OAAO,KAAK,OAAO,MAAM,cAAc,CAAC;AAExC,0BAA0B,CAAC,iBAAiB,EAAE,GAAG,EAAE;IACjD,UAAU,CAAC,GAAG,EAAE;QACd,mBAAmB,CAAC;YAClB,8CAA8C;YAC9C,sDAAsD;SACvD,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,QAAQ,EAAE,GAAG,EAAE;QACtB,MAAM,6BAA6B,GAAG,CAAC,OAAgB,EAAE,EAAE,CAAC,GAAG,EAAE;YAC/D,MAAM,MAAM,GAAG,YAAY,EAAE,CAAC;YAC9B,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YACnF,MAAM,cAAc,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;YACvE,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;YAC9B,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;YAEzD,MAAM,OAAO,GAAG,KAAK,CAAC,kBAAkB,CAAC,GAAG,CAAC,cAAc,CAAC,cAAc,EAAE;gBAC1E,UAAU,EAAE,IAAI;gBAChB,GAAG,EAAE,oBAAuD;aAC7D,CAAC,CAAC;YACH,cAAc,CAAC,wBAAwB,CAAC,GAAG,CAAC,cAAc,CAAC,MAAM,CAAC,eAAe,EAAE,OAAO,CAAC,CAAC;YAE5F,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QACrD,CAAC,CAAC;QAEF,EAAE,CAAC,gEAAgE,EAAE,6BAA6B,CAAC,IAAI,CAAC,CAAC,CAAC;QAC1G,EAAE,CAAC,oEAAoE,EAAE,6BAA6B,CAAC,KAAK,CAAC,CAAC,CAAC;QAE/G,EAAE,CAAC,4BAA4B,EAAE,GAAG,EAAE;YACpC,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;YAEzD,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC,wBAAwB,CAC1D,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,EAAC,gBAAgB,EAAE,IAAI,EAAC,CAAC,CAAC;YAE5D,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Logs from '../../models/logs/logs.js';\nimport {createTarget, registerNoopActions} from '../../testing/EnvironmentHelpers.js';\nimport {describeWithMockConnection} from '../../testing/MockConnection.js';\n\nimport * as Network from './network.js';\n\ndescribeWithMockConnection('BlockedURLsPane', () => {\n  beforeEach(() => {\n    registerNoopActions([\n      'network.add-network-request-blocking-pattern',\n      'network.remove-all-network-request-blocking-patterns',\n    ]);\n  });\n\n  describe('update', () => {\n    const updatesOnRequestFinishedEvent = (inScope: boolean) => () => {\n      const target = createTarget();\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      SDK.TargetManager.TargetManager.instance().setScopeTarget(inScope ? target : null);\n      const networkManager = target.model(SDK.NetworkManager.NetworkManager);\n      assert.exists(networkManager);\n      const updateStub = sinon.stub(blockedURLsPane, 'update');\n\n      const request = sinon.createStubInstance(SDK.NetworkRequest.NetworkRequest, {\n        wasBlocked: true,\n        url: 'http://example.com' as Platform.DevToolsPath.UrlString,\n      });\n      networkManager.dispatchEventToListeners(SDK.NetworkManager.Events.RequestFinished, request);\n\n      assert.strictEqual(updateStub.calledOnce, inScope);\n    };\n\n    it('is called upon RequestFinished event (when target is in scope)', updatesOnRequestFinishedEvent(true));\n    it('is called upon RequestFinished event (when target is out of scope)', updatesOnRequestFinishedEvent(false));\n\n    it('is called upon Reset event', () => {\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      const updateStub = sinon.stub(blockedURLsPane, 'update');\n\n      Logs.NetworkLog.NetworkLog.instance().dispatchEventToListeners(\n          Logs.NetworkLog.Events.Reset, {clearIfPreserved: true});\n\n      assert.isTrue(updateStub.calledOnce);\n    });\n  });\n});\n"]}