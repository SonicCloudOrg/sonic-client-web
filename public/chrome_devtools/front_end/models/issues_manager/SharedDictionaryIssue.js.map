{"version":3,"file":"SharedDictionaryIssue.js","sourceRoot":"","sources":["../../../../../../front_end/models/issues_manager/SharedDictionaryIssue.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\n\nimport {Issue, IssueCategory, IssueKind} from './Issue.js';\nimport {\n  type LazyMarkdownIssueDescription,\n  type MarkdownIssueDescription,\n  resolveLazyDescription,\n} from './MarkdownIssueDescription.js';\n\nconst UIStrings = {\n  /**\n   *@description Title for Compression Dictionary Transport specification url link\n   */\n  compressionDictionaryTransport: 'Compression Dictionary Transport',\n};\nconst str_ = i18n.i18n.registerUIStrings('models/issues_manager/SharedDictionaryIssue.ts', UIStrings);\nconst i18nLazyString = i18n.i18n.getLazilyComputedLocalizedString.bind(undefined, str_);\n\nexport const enum IssueCode {\n  UseErrorCrossOriginNoCorsRequest = 'SharedDictionaryIssue::UseErrorCrossOriginNoCorsRequest',\n  UseErrorDictionaryLoadFailure = 'SharedDictionaryIssue::UseErrorDictionaryLoadFailure',\n  UseErrorMatchingDictionaryNotUsed = 'SharedDictionaryIssue::UseErrorMatchingDictionaryNotUsed',\n  UseErrorUnexpectedContentDictionaryHeader = 'SharedDictionaryIssue::UseErrorUnexpectedContentDictionaryHeader',\n  WriteErrorCossOriginNoCorsRequest = 'SharedDictionaryIssue::WriteErrorCossOriginNoCorsRequest',\n  WriteErrorDisallowedBySettings = 'SharedDictionaryIssue::WriteErrorDisallowedBySettings',\n  WriteErrorExpiredResponse = 'SharedDictionaryIssue::WriteErrorExpiredResponse',\n  WriteErrorFeatureDisabled = 'SharedDictionaryIssue::WriteErrorFeatureDisabled',\n  WriteErrorInsufficientResources = 'SharedDictionaryIssue::WriteErrorInsufficientResources',\n  WriteErrorInvalidMatchField = 'SharedDictionaryIssue::WriteErrorInvalidMatchField',\n  WriteErrorInvalidStructuredHeader = 'SharedDictionaryIssue::WriteErrorInvalidStructuredHeader',\n  WriteErrorNavigationRequest = 'SharedDictionaryIssue::WriteErrorNavigationRequest',\n  WriteErrorNoMatchField = 'SharedDictionaryIssue::WriteErrorNoMatchField',\n  WriteErrorNonListMatchDestField = 'SharedDictionaryIssue::WriteErrorNonListMatchDestField',\n  WriteErrorNonSecureContext = 'SharedDictionaryIssue::WriteErrorNonSecureContext',\n  WriteErrorNonStringIdField = 'SharedDictionaryIssue::WriteErrorNonStringIdField',\n  WriteErrorNonStringInMatchDestList = 'SharedDictionaryIssue::WriteErrorNonStringInMatchDestList',\n  WriteErrorNonStringMatchField = 'SharedDictionaryIssue::WriteErrorNonStringMatchField',\n  WriteErrorNonTokenTypeField = 'SharedDictionaryIssue::WriteErrorNonTokenTypeField',\n  WriteErrorRequestAborted = 'SharedDictionaryIssue::WriteErrorRequestAborted',\n  WriteErrorShuttingDown = 'SharedDictionaryIssue::WriteErrorShuttingDown',\n  WriteErrorTooLongIdField = 'SharedDictionaryIssue::WriteErrorTooLongIdField',\n  WriteErrorUnsupportedType = 'SharedDictionaryIssue::WriteErrorUnsupportedType',\n  Unknown = 'SharedDictionaryIssue::WriteErrorUnknown',\n}\n\nfunction getIssueCode(details: Protocol.Audits.SharedDictionaryIssueDetails): IssueCode {\n  switch (details.sharedDictionaryError) {\n    case Protocol.Audits.SharedDictionaryError.UseErrorCrossOriginNoCorsRequest:\n      return IssueCode.UseErrorCrossOriginNoCorsRequest;\n    case Protocol.Audits.SharedDictionaryError.UseErrorDictionaryLoadFailure:\n      return IssueCode.UseErrorDictionaryLoadFailure;\n    case Protocol.Audits.SharedDictionaryError.UseErrorMatchingDictionaryNotUsed:\n      return IssueCode.UseErrorMatchingDictionaryNotUsed;\n    case Protocol.Audits.SharedDictionaryError.UseErrorUnexpectedContentDictionaryHeader:\n      return IssueCode.UseErrorUnexpectedContentDictionaryHeader;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorCossOriginNoCorsRequest:\n      return IssueCode.WriteErrorCossOriginNoCorsRequest;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorDisallowedBySettings:\n      return IssueCode.WriteErrorDisallowedBySettings;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorExpiredResponse:\n      return IssueCode.WriteErrorExpiredResponse;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorFeatureDisabled:\n      return IssueCode.WriteErrorFeatureDisabled;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorInsufficientResources:\n      return IssueCode.WriteErrorInsufficientResources;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorInvalidMatchField:\n      return IssueCode.WriteErrorInvalidMatchField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorInvalidStructuredHeader:\n      return IssueCode.WriteErrorInvalidStructuredHeader;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNavigationRequest:\n      return IssueCode.WriteErrorNavigationRequest;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNoMatchField:\n      return IssueCode.WriteErrorNoMatchField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNonListMatchDestField:\n      return IssueCode.WriteErrorNonListMatchDestField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNonSecureContext:\n      return IssueCode.WriteErrorNonSecureContext;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNonStringIdField:\n      return IssueCode.WriteErrorNonStringIdField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNonStringInMatchDestList:\n      return IssueCode.WriteErrorNonStringInMatchDestList;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNonStringMatchField:\n      return IssueCode.WriteErrorNonStringMatchField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorNonTokenTypeField:\n      return IssueCode.WriteErrorNonTokenTypeField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorRequestAborted:\n      return IssueCode.WriteErrorRequestAborted;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorShuttingDown:\n      return IssueCode.WriteErrorShuttingDown;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorTooLongIdField:\n      return IssueCode.WriteErrorTooLongIdField;\n    case Protocol.Audits.SharedDictionaryError.WriteErrorUnsupportedType:\n      return IssueCode.WriteErrorUnsupportedType;\n    default:\n      return IssueCode.Unknown;\n  }\n}\n\nexport class SharedDictionaryIssue extends Issue {\n  readonly #issueDetails: Protocol.Audits.SharedDictionaryIssueDetails;\n\n  constructor(issueDetails: Protocol.Audits.SharedDictionaryIssueDetails, issuesModel: SDK.IssuesModel.IssuesModel) {\n    super(\n        {\n          code: getIssueCode(issueDetails),\n          umaCode: [\n            Protocol.Audits.InspectorIssueCode.SharedDictionaryIssue,\n            issueDetails.sharedDictionaryError,\n          ].join('::'),\n        },\n        issuesModel);\n    this.#issueDetails = issueDetails;\n  }\n\n  override requests(): Iterable<Protocol.Audits.AffectedRequest> {\n    if (this.#issueDetails.request) {\n      return [this.#issueDetails.request];\n    }\n    return [];\n  }\n\n  getCategory(): IssueCategory {\n    return IssueCategory.Other;\n  }\n\n  details(): Protocol.Audits.SharedDictionaryIssueDetails {\n    return this.#issueDetails;\n  }\n\n  getDescription(): MarkdownIssueDescription|null {\n    const description = issueDescriptions.get(this.#issueDetails.sharedDictionaryError);\n    if (!description) {\n      return null;\n    }\n    return resolveLazyDescription(description);\n  }\n\n  primaryKey(): string {\n    return JSON.stringify(this.#issueDetails);\n  }\n\n  getKind(): IssueKind {\n    return IssueKind.PageError;\n  }\n\n  static fromInspectorIssue(issuesModel: SDK.IssuesModel.IssuesModel, inspectorIssue: Protocol.Audits.InspectorIssue):\n      SharedDictionaryIssue[] {\n    const details = inspectorIssue.details.sharedDictionaryIssueDetails;\n    if (!details) {\n      console.warn('Shared Dictionary issue without details received.');\n      return [];\n    }\n    return [new SharedDictionaryIssue(details, issuesModel)];\n  }\n}\nconst specLinks = [{\n  link: 'https://datatracker.ietf.org/doc/draft-ietf-httpbis-compression-dictionary/',\n  linkTitle: i18nLazyString(UIStrings.compressionDictionaryTransport),\n}];\n\nconst issueDescriptions: Map<Protocol.Audits.SharedDictionaryError, LazyMarkdownIssueDescription> = new Map([\n\n  [\n    Protocol.Audits.SharedDictionaryError.UseErrorCrossOriginNoCorsRequest,\n    {\n      file: 'sharedDictionaryUseErrorCrossOriginNoCorsRequest.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.UseErrorDictionaryLoadFailure,\n    {\n      file: 'sharedDictionaryUseErrorDictionaryLoadFailure.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.UseErrorMatchingDictionaryNotUsed,\n    {\n      file: 'sharedDictionaryUseErrorMatchingDictionaryNotUsed.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.UseErrorUnexpectedContentDictionaryHeader,\n    {\n      file: 'sharedDictionaryUseErrorUnexpectedContentDictionaryHeader.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorCossOriginNoCorsRequest,\n    {\n      file: 'sharedDictionaryWriteErrorCossOriginNoCorsRequest.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorDisallowedBySettings,\n    {\n      file: 'sharedDictionaryWriteErrorDisallowedBySettings.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorExpiredResponse,\n    {\n      file: 'sharedDictionaryWriteErrorExpiredResponse.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorFeatureDisabled,\n    {\n      file: 'sharedDictionaryWriteErrorFeatureDisabled.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorInsufficientResources,\n    {\n      file: 'sharedDictionaryWriteErrorInsufficientResources.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorInvalidMatchField,\n    {\n      file: 'sharedDictionaryWriteErrorInvalidMatchField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorInvalidStructuredHeader,\n    {\n      file: 'sharedDictionaryWriteErrorInvalidStructuredHeader.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNavigationRequest,\n    {\n      file: 'sharedDictionaryWriteErrorNavigationRequest.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNoMatchField,\n    {\n      file: 'sharedDictionaryWriteErrorNoMatchField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNonListMatchDestField,\n    {\n      file: 'sharedDictionaryWriteErrorNonListMatchDestField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNonSecureContext,\n    {\n      file: 'sharedDictionaryWriteErrorNonSecureContext.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNonStringIdField,\n    {\n      file: 'sharedDictionaryWriteErrorNonStringIdField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNonStringInMatchDestList,\n    {\n      file: 'sharedDictionaryWriteErrorNonStringInMatchDestList.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNonStringMatchField,\n    {\n      file: 'sharedDictionaryWriteErrorNonStringMatchField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorNonTokenTypeField,\n    {\n      file: 'sharedDictionaryWriteErrorNonTokenTypeField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorRequestAborted,\n    {\n      file: 'sharedDictionaryWriteErrorRequestAborted.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorShuttingDown,\n    {\n      file: 'sharedDictionaryWriteErrorShuttingDown.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorTooLongIdField,\n    {\n      file: 'sharedDictionaryWriteErrorTooLongIdField.md',\n      links: specLinks,\n    },\n  ],\n  [\n    Protocol.Audits.SharedDictionaryError.WriteErrorUnsupportedType,\n    {\n      file: 'sharedDictionaryWriteErrorUnsupportedType.md',\n      links: specLinks,\n    },\n  ],\n]);\n"]}