{"version":3,"file":"Automapping.js","sourceRoot":"","sources":["../../../../../../front_end/models/persistence/Automapping.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Bindings from '../bindings/bindings.js';\nimport * as TextUtils from '../text_utils/text_utils.js';\nimport * as Workspace from '../workspace/workspace.js';\n\nimport {type FileSystem, FileSystemWorkspaceBinding} from './FileSystemWorkspaceBinding.js';\nimport {PersistenceImpl} from './PersistenceImpl.js';\n\nexport class Automapping {\n  private readonly workspace: Workspace.Workspace.WorkspaceImpl;\n  private readonly onStatusAdded: (arg0: AutomappingStatus) => Promise<void>;\n  private readonly onStatusRemoved: (arg0: AutomappingStatus) => Promise<void>;\n  private readonly statuses: Set<AutomappingStatus>;\n  private readonly fileSystemUISourceCodes: FileSystemUISourceCodes;\n  private readonly sweepThrottler: Common.Throttler.Throttler;\n  private readonly sourceCodeToProcessingPromiseMap: WeakMap<Workspace.UISourceCode.UISourceCode, Promise<void>>;\n  private readonly sourceCodeToAutoMappingStatusMap: WeakMap<Workspace.UISourceCode.UISourceCode, AutomappingStatus>;\n  private readonly sourceCodeToMetadataMap:\n      WeakMap<Workspace.UISourceCode.UISourceCode, Workspace.UISourceCode.UISourceCodeMetadata|null>;\n  private readonly filesIndex: FilePathIndex;\n  private readonly projectFoldersIndex: FolderIndex;\n  private readonly activeFoldersIndex: FolderIndex;\n  private readonly interceptors: ((arg0: Workspace.UISourceCode.UISourceCode) => boolean)[];\n  constructor(\n      workspace: Workspace.Workspace.WorkspaceImpl, onStatusAdded: (arg0: AutomappingStatus) => Promise<void>,\n      onStatusRemoved: (arg0: AutomappingStatus) => Promise<void>) {\n    this.workspace = workspace;\n\n    this.onStatusAdded = onStatusAdded;\n    this.onStatusRemoved = onStatusRemoved;\n    this.statuses = new Set();\n\n    this.fileSystemUISourceCodes = new FileSystemUISourceCodes();\n    this.sweepThrottler = new Common.Throttler.Throttler(100);\n\n    this.sourceCodeToProcessingPromiseMap = new WeakMap();\n    this.sourceCodeToAutoMappingStatusMap = new WeakMap();\n    this.sourceCodeToMetadataMap = new WeakMap();\n\n    this.filesIndex = new FilePathIndex();\n    this.projectFoldersIndex = new FolderIndex();\n    this.activeFoldersIndex = new FolderIndex();\n\n    this.interceptors = [];\n\n    this.workspace.addEventListener(\n        Workspace.Workspace.Events.UISourceCodeAdded, event => this.onUISourceCodeAdded(event.data));\n    this.workspace.addEventListener(\n        Workspace.Workspace.Events.UISourceCodeRemoved, event => this.onUISourceCodeRemoved(event.data));\n    this.workspace.addEventListener(Workspace.Workspace.Events.UISourceCodeRenamed, this.onUISourceCodeRenamed, this);\n    this.workspace.addEventListener(\n        Workspace.Workspace.Events.ProjectAdded, event => this.onProjectAdded(event.data), this);\n    this.workspace.addEventListener(\n        Workspace.Workspace.Events.ProjectRemoved, event => this.onProjectRemoved(event.data), this);\n\n    for (const fileSystem of workspace.projects()) {\n      this.onProjectAdded(fileSystem);\n    }\n    for (const uiSourceCode of workspace.uiSourceCodes()) {\n      this.onUISourceCodeAdded(uiSourceCode);\n    }\n  }\n\n  addNetworkInterceptor(interceptor: (arg0: Workspace.UISourceCode.UISourceCode) => boolean): void {\n    this.interceptors.push(interceptor);\n    this.scheduleRemap();\n  }\n\n  scheduleRemap(): void {\n    for (const status of this.statuses.values()) {\n      this.clearNetworkStatus(status.network);\n    }\n    this.scheduleSweep();\n  }\n\n  private scheduleSweep(): void {\n    void this.sweepThrottler.schedule(sweepUnmapped.bind(this));\n\n    function sweepUnmapped(this: Automapping): Promise<void> {\n      const networkProjects = this.workspace.projectsForType(Workspace.Workspace.projectTypes.Network);\n      for (const networkProject of networkProjects) {\n        for (const uiSourceCode of networkProject.uiSourceCodes()) {\n          void this.computeNetworkStatus(uiSourceCode);\n        }\n      }\n      this.onSweepHappenedForTest();\n      return Promise.resolve();\n    }\n  }\n\n  private onSweepHappenedForTest(): void {\n  }\n\n  private onProjectRemoved(project: Workspace.Workspace.Project): void {\n    for (const uiSourceCode of project.uiSourceCodes()) {\n      this.onUISourceCodeRemoved(uiSourceCode);\n    }\n    if (project.type() !== Workspace.Workspace.projectTypes.FileSystem) {\n      return;\n    }\n    const fileSystem = project as FileSystem;\n    for (const gitFolder of fileSystem.initialGitFolders()) {\n      this.projectFoldersIndex.removeFolder(gitFolder);\n    }\n    this.projectFoldersIndex.removeFolder(fileSystem.fileSystemPath());\n    this.scheduleRemap();\n  }\n\n  private onProjectAdded(project: Workspace.Workspace.Project): void {\n    if (project.type() !== Workspace.Workspace.projectTypes.FileSystem) {\n      return;\n    }\n    const fileSystem = project as FileSystem;\n    for (const gitFolder of fileSystem.initialGitFolders()) {\n      this.projectFoldersIndex.addFolder(gitFolder);\n    }\n    this.projectFoldersIndex.addFolder(fileSystem.fileSystemPath());\n    for (const uiSourceCode of project.uiSourceCodes()) {\n      this.onUISourceCodeAdded(uiSourceCode);\n    }\n    this.scheduleRemap();\n  }\n\n  private onUISourceCodeAdded(uiSourceCode: Workspace.UISourceCode.UISourceCode): void {\n    const project = uiSourceCode.project();\n    if (project.type() === Workspace.Workspace.projectTypes.FileSystem) {\n      if (!FileSystemWorkspaceBinding.fileSystemSupportsAutomapping(project)) {\n        return;\n      }\n      this.filesIndex.addPath(uiSourceCode.url());\n      this.fileSystemUISourceCodes.add(uiSourceCode);\n      this.scheduleSweep();\n    } else if (project.type() === Workspace.Workspace.projectTypes.Network) {\n      void this.computeNetworkStatus(uiSourceCode);\n    }\n  }\n\n  private onUISourceCodeRemoved(uiSourceCode: Workspace.UISourceCode.UISourceCode): void {\n    if (uiSourceCode.project().type() === Workspace.Workspace.projectTypes.FileSystem) {\n      this.filesIndex.removePath(uiSourceCode.url());\n      this.fileSystemUISourceCodes.delete(uiSourceCode.url());\n      const status = this.sourceCodeToAutoMappingStatusMap.get(uiSourceCode);\n      if (status) {\n        this.clearNetworkStatus(status.network);\n      }\n    } else if (uiSourceCode.project().type() === Workspace.Workspace.projectTypes.Network) {\n      this.clearNetworkStatus(uiSourceCode);\n    }\n  }\n\n  private onUISourceCodeRenamed(\n      event: Common.EventTarget.EventTargetEvent<Workspace.Workspace.UISourceCodeRenamedEvent>): void {\n    const {uiSourceCode, oldURL} = event.data;\n    if (uiSourceCode.project().type() !== Workspace.Workspace.projectTypes.FileSystem) {\n      return;\n    }\n\n    this.filesIndex.removePath(oldURL);\n    this.fileSystemUISourceCodes.delete(oldURL);\n    const status = this.sourceCodeToAutoMappingStatusMap.get(uiSourceCode);\n    if (status) {\n      this.clearNetworkStatus(status.network);\n    }\n\n    this.filesIndex.addPath(uiSourceCode.url());\n    this.fileSystemUISourceCodes.add(uiSourceCode);\n    this.scheduleSweep();\n  }\n\n  computeNetworkStatus(networkSourceCode: Workspace.UISourceCode.UISourceCode): Promise<void> {\n    const processingPromise = this.sourceCodeToProcessingPromiseMap.get(networkSourceCode);\n    if (processingPromise) {\n      return processingPromise;\n    }\n    if (this.sourceCodeToAutoMappingStatusMap.has(networkSourceCode)) {\n      return Promise.resolve();\n    }\n    if (this.interceptors.some(interceptor => interceptor(networkSourceCode))) {\n      return Promise.resolve();\n    }\n    if (Common.ParsedURL.schemeIs(networkSourceCode.url(), 'wasm:')) {\n      return Promise.resolve();\n    }\n    const createBindingPromise =\n        this.createBinding(networkSourceCode).then(validateStatus.bind(this)).then(onStatus.bind(this));\n    this.sourceCodeToProcessingPromiseMap.set(networkSourceCode, createBindingPromise);\n    return createBindingPromise;\n\n    async function validateStatus(this: Automapping, status: AutomappingStatus|null): Promise<AutomappingStatus|null> {\n      if (!status) {\n        return null;\n      }\n      if (this.sourceCodeToProcessingPromiseMap.get(networkSourceCode) !== createBindingPromise) {\n        return null;\n      }\n      if (status.network.contentType().isFromSourceMap() || !status.fileSystem.contentType().isTextType()) {\n        return status;\n      }\n\n      // At the time binding comes, there are multiple user scenarios:\n      // 1. Both network and fileSystem files are **not** dirty.\n      //    This is a typical scenario when user hasn't done any edits yet to the\n      //    files in question.\n      // 2. FileSystem file has unsaved changes, network is clear.\n      //    This typically happens with CSS files editing. Consider the following\n      //    scenario:\n      //      - user edits file that has been successfully mapped before\n      //      - user doesn't save the file\n      //      - user hits reload\n      // 3. Network file has either unsaved changes or commits, but fileSystem file is clear.\n      //    This typically happens when we've been editing file and then realized we'd like to drop\n      //    a folder and persist all the changes.\n      // 4. Network file has either unsaved changes or commits, and fileSystem file has unsaved changes.\n      //    We consider this to be un-realistic scenario and in this case just fail gracefully.\n      //\n      // To support usecase (3), we need to validate against original network content.\n      if (status.fileSystem.isDirty() && (status.network.isDirty() || status.network.hasCommits())) {\n        return null;\n      }\n\n      const [fileSystemContent, networkContent] = (await Promise.all([\n                                                    status.fileSystem.requestContentData(),\n                                                    status.network.project().requestFileContent(status.network),\n                                                  ])).map(TextUtils.ContentData.ContentData.asDeferredContent);\n      if (fileSystemContent.content === null || networkContent === null) {\n        return null;\n      }\n\n      if (this.sourceCodeToProcessingPromiseMap.get(networkSourceCode) !== createBindingPromise) {\n        return null;\n      }\n\n      const target = Bindings.NetworkProject.NetworkProject.targetForUISourceCode(status.network);\n      let isValid = false;\n      const fileContent = fileSystemContent.content;\n      if (target && target.type() === SDK.Target.Type.Node) {\n        if (networkContent.content) {\n          const rewrappedNetworkContent =\n              PersistenceImpl.rewrapNodeJSContent(status.fileSystem, fileContent, networkContent.content);\n          isValid = fileContent === rewrappedNetworkContent;\n        }\n      } else {\n        if (networkContent.content) {\n          // Trim trailing whitespaces because V8 adds trailing newline.\n          isValid = fileContent.trimEnd() === networkContent.content.trimEnd();\n        }\n      }\n      if (!isValid) {\n        this.prevalidationFailedForTest(status);\n        return null;\n      }\n      return status;\n    }\n\n    async function onStatus(this: Automapping, status: AutomappingStatus|null): Promise<void> {\n      if (this.sourceCodeToProcessingPromiseMap.get(networkSourceCode) !== createBindingPromise) {\n        return;\n      }\n      if (!status) {\n        this.onBindingFailedForTest();\n        this.sourceCodeToProcessingPromiseMap.delete(networkSourceCode);\n        return;\n      }\n      // TODO(lushnikov): remove this check once there's a single uiSourceCode per url. @see crbug.com/670180\n      if (this.sourceCodeToAutoMappingStatusMap.has(status.network) ||\n          this.sourceCodeToAutoMappingStatusMap.has(status.fileSystem)) {\n        this.sourceCodeToProcessingPromiseMap.delete(networkSourceCode);\n        return;\n      }\n\n      this.statuses.add(status);\n      this.sourceCodeToAutoMappingStatusMap.set(status.network, status);\n      this.sourceCodeToAutoMappingStatusMap.set(status.fileSystem, status);\n      if (status.exactMatch) {\n        const projectFolder = this.projectFoldersIndex.closestParentFolder(status.fileSystem.url());\n        const newFolderAdded = projectFolder ? this.activeFoldersIndex.addFolder(projectFolder) : false;\n        if (newFolderAdded) {\n          this.scheduleSweep();\n        }\n      }\n      await this.onStatusAdded.call(null, status);\n      this.sourceCodeToProcessingPromiseMap.delete(networkSourceCode);\n    }\n  }\n\n  private prevalidationFailedForTest(_binding: AutomappingStatus): void {\n  }\n\n  private onBindingFailedForTest(): void {\n  }\n\n  private clearNetworkStatus(networkSourceCode: Workspace.UISourceCode.UISourceCode): void {\n    if (this.sourceCodeToProcessingPromiseMap.has(networkSourceCode)) {\n      this.sourceCodeToProcessingPromiseMap.delete(networkSourceCode);\n      return;\n    }\n    const status = this.sourceCodeToAutoMappingStatusMap.get(networkSourceCode);\n    if (!status) {\n      return;\n    }\n\n    this.statuses.delete(status);\n    this.sourceCodeToAutoMappingStatusMap.delete(status.network);\n    this.sourceCodeToAutoMappingStatusMap.delete(status.fileSystem);\n    if (status.exactMatch) {\n      const projectFolder = this.projectFoldersIndex.closestParentFolder(status.fileSystem.url());\n      if (projectFolder) {\n        this.activeFoldersIndex.removeFolder(projectFolder);\n      }\n    }\n    void this.onStatusRemoved.call(null, status);\n  }\n\n  private async createBinding(networkSourceCode: Workspace.UISourceCode.UISourceCode): Promise<AutomappingStatus|null> {\n    const url = networkSourceCode.url();\n    if (Common.ParsedURL.schemeIs(url, 'file:') || Common.ParsedURL.schemeIs(url, 'snippet:')) {\n      const fileSourceCode = this.fileSystemUISourceCodes.get(url);\n      const status = fileSourceCode ? new AutomappingStatus(networkSourceCode, fileSourceCode, false) : null;\n      return status;\n    }\n\n    let networkPath = Common.ParsedURL.ParsedURL.extractPath(url);\n    if (networkPath === null) {\n      return null;\n    }\n\n    if (networkPath.endsWith('/')) {\n      networkPath = Common.ParsedURL.ParsedURL.concatenate(networkPath, 'index.html');\n    }\n\n    const similarFiles =\n        this.filesIndex.similarFiles(networkPath).map(path => this.fileSystemUISourceCodes.get(path)) as\n        Workspace.UISourceCode.UISourceCode[];\n    if (!similarFiles.length) {\n      return null;\n    }\n\n    await Promise.all(similarFiles.concat(networkSourceCode).map(async sourceCode => {\n      this.sourceCodeToMetadataMap.set(sourceCode, await sourceCode.requestMetadata());\n    }));\n\n    const activeFiles = similarFiles.filter(file => Boolean(this.activeFoldersIndex.closestParentFolder(file.url())));\n    const networkMetadata = this.sourceCodeToMetadataMap.get(networkSourceCode);\n    if (!networkMetadata || (!networkMetadata.modificationTime && typeof networkMetadata.contentSize !== 'number')) {\n      // If networkSourceCode does not have metadata, try to match against active folders.\n      if (activeFiles.length !== 1) {\n        return null;\n      }\n      return new AutomappingStatus(networkSourceCode, activeFiles[0], false);\n    }\n\n    // Try to find exact matches, prioritizing active folders.\n    let exactMatches = this.filterWithMetadata(activeFiles, networkMetadata);\n    if (!exactMatches.length) {\n      exactMatches = this.filterWithMetadata(similarFiles, networkMetadata);\n    }\n    if (exactMatches.length !== 1) {\n      return null;\n    }\n    return new AutomappingStatus(networkSourceCode, exactMatches[0], true);\n  }\n\n  private filterWithMetadata(\n      files: Workspace.UISourceCode.UISourceCode[],\n      networkMetadata: Workspace.UISourceCode.UISourceCodeMetadata): Workspace.UISourceCode.UISourceCode[] {\n    return files.filter(file => {\n      const fileMetadata = this.sourceCodeToMetadataMap.get(file);\n      if (!fileMetadata) {\n        return false;\n      }\n      // Allow a second of difference due to network timestamps lack of precision.\n      const timeMatches = !networkMetadata.modificationTime || !fileMetadata.modificationTime ||\n          Math.abs(networkMetadata.modificationTime.getTime() - fileMetadata.modificationTime.getTime()) < 1000;\n      const contentMatches = !networkMetadata.contentSize || fileMetadata.contentSize === networkMetadata.contentSize;\n      return timeMatches && contentMatches;\n    });\n  }\n}\n\nclass FilePathIndex {\n  readonly #reversedIndex = Common.Trie.Trie.newArrayTrie<string[]>();\n\n  addPath(path: Platform.DevToolsPath.UrlString): void {\n    const reversePathParts = path.split('/').reverse();\n    this.#reversedIndex.add(reversePathParts);\n  }\n\n  removePath(path: Platform.DevToolsPath.UrlString): void {\n    const reversePathParts = path.split('/').reverse();\n    this.#reversedIndex.remove(reversePathParts);\n  }\n\n  similarFiles(networkPath: Platform.DevToolsPath.EncodedPathString): Platform.DevToolsPath.UrlString[] {\n    const reversePathParts = networkPath.split('/').reverse();\n    const longestCommonPrefix = this.#reversedIndex.longestPrefix(reversePathParts, false);\n    if (longestCommonPrefix.length === 0) {\n      return [];\n    }\n    return this.#reversedIndex.words(longestCommonPrefix)\n               .map(reversePathParts => reversePathParts.reverse().join('/')) as Platform.DevToolsPath.UrlString[];\n  }\n}\n\nclass FolderIndex {\n  readonly #index = Common.Trie.Trie.newArrayTrie<string[]>();\n  readonly #folderCount = new Map<string, number>();\n\n  addFolder(path: Platform.DevToolsPath.UrlString): boolean {\n    const pathParts = this.#removeTrailingSlash(path).split('/');\n    this.#index.add(pathParts);\n\n    const pathForCount = pathParts.join('/');\n    const count = this.#folderCount.get(pathForCount) ?? 0;\n    this.#folderCount.set(pathForCount, count + 1);\n    return count === 0;\n  }\n\n  removeFolder(path: Platform.DevToolsPath.UrlString): boolean {\n    const pathParts = this.#removeTrailingSlash(path).split('/');\n    const pathForCount = pathParts.join('/');\n    const count = this.#folderCount.get(pathForCount) ?? 0;\n    if (!count) {\n      return false;\n    }\n    if (count > 1) {\n      this.#folderCount.set(pathForCount, count - 1);\n      return false;\n    }\n    this.#index.remove(pathParts);\n    this.#folderCount.delete(pathForCount);\n    return true;\n  }\n\n  closestParentFolder(path: Platform.DevToolsPath.UrlString): Platform.DevToolsPath.UrlString {\n    const pathParts = path.split('/');\n    const commonPrefix = this.#index.longestPrefix(pathParts, /* fullWordOnly */ true);\n    return commonPrefix.join('/') as Platform.DevToolsPath.UrlString;\n  }\n\n  #removeTrailingSlash(path: Platform.DevToolsPath.UrlString): Platform.DevToolsPath.UrlString {\n    if (path.endsWith('/')) {\n      return Common.ParsedURL.ParsedURL.substring(path, 0, path.length - 1);\n    }\n    return path;\n  }\n}\n\nclass FileSystemUISourceCodes {\n  private readonly sourceCodes: Map<Platform.DevToolsPath.UrlString, Workspace.UISourceCode.UISourceCode>;\n\n  constructor() {\n    this.sourceCodes = new Map();\n  }\n\n  private getPlatformCanonicalFileUrl(path: Platform.DevToolsPath.UrlString): Platform.DevToolsPath.UrlString {\n    return Host.Platform.isWin() ? Common.ParsedURL.ParsedURL.toLowerCase(path) : path;\n  }\n\n  add(sourceCode: Workspace.UISourceCode.UISourceCode): void {\n    const fileUrl = this.getPlatformCanonicalFileUrl(sourceCode.url());\n    this.sourceCodes.set(fileUrl, sourceCode);\n  }\n\n  get(fileUrl: Platform.DevToolsPath.UrlString): Workspace.UISourceCode.UISourceCode|undefined {\n    fileUrl = this.getPlatformCanonicalFileUrl(fileUrl);\n    return this.sourceCodes.get(fileUrl);\n  }\n\n  delete(fileUrl: Platform.DevToolsPath.UrlString): void {\n    fileUrl = this.getPlatformCanonicalFileUrl(fileUrl);\n    this.sourceCodes.delete(fileUrl);\n  }\n}\n\nexport class AutomappingStatus {\n  network: Workspace.UISourceCode.UISourceCode;\n  fileSystem: Workspace.UISourceCode.UISourceCode;\n  exactMatch: boolean;\n  constructor(\n      network: Workspace.UISourceCode.UISourceCode, fileSystem: Workspace.UISourceCode.UISourceCode,\n      exactMatch: boolean) {\n    this.network = network;\n    this.fileSystem = fileSystem;\n    this.exactMatch = exactMatch;\n  }\n}\n"]}