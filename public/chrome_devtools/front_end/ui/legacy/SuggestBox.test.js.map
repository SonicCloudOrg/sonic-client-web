{"version":3,"file":"SuggestBox.test.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/SuggestBox.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {describeWithLocale} from '../../testing/EnvironmentHelpers.js';\n\nimport * as UI from './legacy.js';\n\nclass MockSuggestBoxDelegate implements UI.SuggestBox.SuggestBoxDelegate {\n  readonly appliedSuggestions: {suggestion: string, isIntermediateSuggestion?: boolean}[] = [];\n  readonly accceptedSuggestions: string[] = [];\n\n  private lastAppliedSuggestion!: UI.SuggestBox.Suggestion;\n\n  constructor(readonly element: HTMLElement) {\n  }\n\n  applySuggestion(suggestion: UI.SuggestBox.Suggestion|null, isIntermediateSuggestion?: boolean) {\n    if (!suggestion) {\n      throw new Error('All tests should pass a real suggestion to `applySuggestion`');\n    }\n    this.appliedSuggestions.push({suggestion: suggestion.text, isIntermediateSuggestion});\n    this.lastAppliedSuggestion = suggestion;\n  }\n\n  acceptSuggestion() {\n    this.accceptedSuggestions.push(this.lastAppliedSuggestion.text);\n  }\n\n  ownerElement() {\n    return this.element;\n  }\n}\n\nconst createKeyEvent = (key: string) => new KeyboardEvent('keydown', {bubbles: true, cancelable: true, key});\n\ndescribeWithLocale('SuggestBox', () => {\n  let delegate: MockSuggestBoxDelegate;\n  let div: HTMLElement;\n  let suggestBox: UI.SuggestBox.SuggestBox;\n  const anchorBox = new AnchorBox(50, 50, 400, 400);\n\n  beforeEach(() => {\n    div = document.createElement('div');\n    delegate = new MockSuggestBoxDelegate(div);\n    suggestBox = new UI.SuggestBox.SuggestBox(delegate);\n\n    // Needed to render the `SuggestBox`.\n    UI.GlassPane.GlassPane.setContainer(suggestBox.element);\n  });\n\n  afterEach(() => {\n    suggestBox.hide();\n    div.remove();\n  });\n\n  it('opens the controller element after updating suggestions', () => {\n    suggestBox.updateSuggestions(anchorBox, [{text: 'First'}, {text: 'Second'}], true, true, 'e');\n\n    assert.strictEqual(div.getAttribute('aria-expanded'), 'true');\n  });\n\n  it('selects the first item when no priority is specified', () => {\n    suggestBox.updateSuggestions(\n        anchorBox, [{text: 'First'}, {text: 'Hello'}, {text: 'The best suggestion'}], true, true, 'e');\n\n    assert.deepStrictEqual(delegate.appliedSuggestions, [{suggestion: 'First', isIntermediateSuggestion: true}]);\n  });\n\n  it('selects no item when \"canShowForSingleItem\" is false', () => {\n    suggestBox.updateSuggestions(\n        anchorBox, [{text: 'First'}, {text: 'Hello', priority: 2}, {text: 'The best suggestion', priority: 5}], false,\n        true, 'e');\n\n    assert.deepStrictEqual(delegate.appliedSuggestions, []);\n  });\n\n  it('selects the highest priority item', () => {\n    suggestBox.updateSuggestions(\n        anchorBox, [{text: 'First'}, {text: 'Hello', priority: 2}, {text: 'The best suggestion', priority: 5}], true,\n        true, 'e');\n\n    assert.deepStrictEqual(\n        delegate.appliedSuggestions, [{suggestion: 'The best suggestion', isIntermediateSuggestion: true}]);\n  });\n\n  it('allows arrow keys for selection', () => {\n    suggestBox.updateSuggestions(\n        anchorBox, [{text: 'First'}, {text: 'Hello', priority: 2}, {text: 'The best suggestion', priority: 5}], true,\n        true, 'e');\n\n    suggestBox.keyPressed(createKeyEvent('ArrowUp'));\n    suggestBox.keyPressed(createKeyEvent('ArrowUp'));\n    suggestBox.keyPressed(createKeyEvent('ArrowUp'));\n    suggestBox.keyPressed(createKeyEvent('ArrowDown'));\n    suggestBox.keyPressed(createKeyEvent('ArrowDown'));\n\n    assert.deepStrictEqual(delegate.appliedSuggestions, [\n      {suggestion: 'The best suggestion', isIntermediateSuggestion: true},\n      {suggestion: 'Hello', isIntermediateSuggestion: true},\n      {suggestion: 'First', isIntermediateSuggestion: true},\n      {suggestion: 'The best suggestion', isIntermediateSuggestion: true},\n      {suggestion: 'First', isIntermediateSuggestion: true},\n      {suggestion: 'Hello', isIntermediateSuggestion: true},\n    ]);\n  });\n\n  it('allows using the \"Enter\" key to accept a suggestions', () => {\n    suggestBox.updateSuggestions(\n        anchorBox, [{text: 'First'}, {text: 'Hello', priority: 2}, {text: 'The best suggestion', priority: 5}], true,\n        true, 'e');\n\n    suggestBox.keyPressed(createKeyEvent('Enter'));\n    assert.deepStrictEqual(delegate.accceptedSuggestions, ['The best suggestion']);\n  });\n\n  it('closes the controller element after accepting a suggestion', () => {\n    suggestBox.updateSuggestions(\n        anchorBox, [{text: 'First'}, {text: 'Hello', priority: 2}, {text: 'The best suggestion', priority: 5}], true,\n        true, 'e');\n\n    suggestBox.keyPressed(createKeyEvent('Enter'));\n\n    assert.strictEqual(div.getAttribute('aria-expanded'), 'false');\n  });\n});\n"]}