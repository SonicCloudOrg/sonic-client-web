{"version":3,"file":"HistoryInput.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/HistoryInput.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {Keys} from './KeyboardShortcut.js';\nimport {registerCustomElement} from './UIUtils.js';\n\nlet cachedConstructor: (() => Element)|null = null;\n\nexport class HistoryInput extends HTMLInputElement {\n  private history: string[];\n  private historyPosition: number;\n\n  constructor() {\n    super();\n    this.history = [''];\n    this.historyPosition = 0;\n    this.addEventListener('keydown', this.onKeyDown.bind(this), false);\n    this.addEventListener('input', this.onInput.bind(this), false);\n  }\n\n  static create(): HistoryInput {\n    if (!cachedConstructor) {\n      cachedConstructor = registerCustomElement('input', 'history-input', HistoryInput);\n    }\n\n    return cachedConstructor() as HistoryInput;\n  }\n\n  private onInput(_event: Event): void {\n    if (this.history.length === this.historyPosition + 1) {\n      this.history[this.history.length - 1] = this.value;\n    }\n  }\n\n  private onKeyDown(ev: Event): void {\n    const event = (ev as KeyboardEvent);\n    if (event.keyCode === Keys.Up.code) {\n      this.historyPosition = Math.max(this.historyPosition - 1, 0);\n      this.value = this.history[this.historyPosition];\n      this.dispatchEvent(new Event('input', {'bubbles': true, 'cancelable': true}));\n      event.consume(true);\n    } else if (event.keyCode === Keys.Down.code) {\n      this.historyPosition = Math.min(this.historyPosition + 1, this.history.length - 1);\n      this.value = this.history[this.historyPosition];\n      this.dispatchEvent(new Event('input', {'bubbles': true, 'cancelable': true}));\n      event.consume(true);\n    } else if (event.keyCode === Keys.Enter.code) {\n      this.saveToHistory();\n    }\n  }\n\n  private saveToHistory(): void {\n    if (this.history.length > 1 && this.history[this.history.length - 2] === this.value) {\n      return;\n    }\n    this.history[this.history.length - 1] = this.value;\n    this.historyPosition = this.history.length - 1;\n    this.history.push('');\n  }\n}\n"]}