{"version":3,"file":"LinkSwatch.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/inline_editor/LinkSwatch.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {renderElementIntoDOM} from '../../../../testing/DOMHelpers.js';\nimport {describeWithLocale} from '../../../../testing/EnvironmentHelpers.js';\n\nimport * as InlineEditor from './inline_editor.js';\n\nfunction assertVarSwatch(swatch: InlineEditor.LinkSwatch.CSSVarSwatch, expected: {\n  valueTooltip: string|null,\n  linkTooltip: string,\n  isDefined: boolean,\n  varText: string,\n  parsedColor?: string,\n}) {\n  const container = swatch.shadowRoot!.querySelector('span');\n  const link = container!.querySelector('devtools-base-link-swatch')!.shadowRoot!.querySelector('.link-swatch-link');\n\n  assert.strictEqual(\n      container!.getAttribute('data-title'), expected.valueTooltip || '', 'The computed values appears as a tooltip');\n  assert.strictEqual(\n      link!.classList.contains('undefined'), !expected.isDefined,\n      'The link only has the class undefined when the property is undefined');\n  assert.strictEqual(link!.getAttribute('data-title'), expected.linkTooltip, 'The link has the right tooltip');\n  assert.strictEqual(link!.textContent, expected.varText, 'The link has the right text content');\n}\n\ndescribeWithLocale('CSSVarSwatch', () => {\n  it('can be instantiated successfully', () => {\n    const component = new InlineEditor.LinkSwatch.CSSVarSwatch();\n    renderElementIntoDOM(component);\n\n    assert.instanceOf(component, HTMLElement, 'The swatch is an instance of HTMLElement');\n  });\n\n  it('renders a var function without fallback', () => {\n    const component = new InlineEditor.LinkSwatch.CSSVarSwatch();\n    renderElementIntoDOM(component);\n    component.data = {\n      variableName: '--test',\n      computedValue: '2px',\n      fromFallback: false,\n      fallbackText: null,\n      onLinkActivate: () => {},\n    };\n\n    assertVarSwatch(component, {\n      valueTooltip: '2px',\n      linkTooltip: '2px',\n      isDefined: true,\n      varText: '--test',\n    });\n  });\n\n  it('renders a var function with an undefined property without fallback', () => {\n    const component = new InlineEditor.LinkSwatch.CSSVarSwatch();\n    renderElementIntoDOM(component);\n    component.data = {\n      variableName: '--undefined',\n      computedValue: null,\n      fromFallback: false,\n      fallbackText: null,\n      onLinkActivate: () => {},\n    };\n\n    assertVarSwatch(component, {\n      valueTooltip: null,\n      linkTooltip: '--undefined is not defined',\n      isDefined: false,\n      varText: '--undefined',\n    });\n  });\n\n  it('renders a var function with an undefined property but fallback nodes', () => {\n    const component = new InlineEditor.LinkSwatch.CSSVarSwatch();\n    renderElementIntoDOM(component);\n    component.data = {\n      variableName: '--undefined',\n      computedValue: '3px 40px',\n      fromFallback: true,\n      fallbackText: '3px 40px',\n      onLinkActivate: () => {},\n    };\n\n    assertVarSwatch(component, {\n      valueTooltip: '3px 40px',\n      linkTooltip: '--undefined is not defined',\n      isDefined: false,\n      varText: '--undefined',\n    });\n  });\n});\n\nfunction assertLinkSwatch(swatch: InlineEditor.LinkSwatch.LinkSwatch, expected: {\n  text: string|null,\n  title: string|null,\n  isDefined: boolean,\n}) {\n  const container = swatch.shadowRoot!.querySelector('span');\n  const link = container!.querySelector('devtools-base-link-swatch')!.shadowRoot!.querySelector('.link-swatch-link');\n\n  assert.strictEqual(container!.getAttribute('title'), expected.text, 'The text appears as a tooltip');\n  assert.strictEqual(\n      link!.classList.contains('undefined'), !expected.isDefined,\n      'The link only has the class undefined when the property is undefined');\n  assert.strictEqual(link!.getAttribute('title'), expected.title, 'The link has the right tooltip');\n  assert.strictEqual(link!.textContent, expected.text, 'The link has the right text content');\n}\n\ndescribeWithLocale('LinkSwatch', () => {\n  it('can be instantiated successfully', () => {\n    const component = new InlineEditor.LinkSwatch.LinkSwatch();\n    renderElementIntoDOM(component);\n\n    assert.instanceOf(component, HTMLElement, 'The swatch is an instance of HTMLElement');\n  });\n\n  it('renders a simple text', () => {\n    const component = new InlineEditor.LinkSwatch.LinkSwatch();\n    component.data = {\n      text: 'test',\n      isDefined: true,\n      onLinkActivate: () => {},\n      jslogContext: 'test',\n    };\n    renderElementIntoDOM(component);\n\n    assertLinkSwatch(component, {\n      text: 'test',\n      title: 'test',\n      isDefined: true,\n    });\n  });\n\n  it('renders a missing test', () => {\n    const component = new InlineEditor.LinkSwatch.LinkSwatch();\n    component.data = {\n      text: 'test',\n      isDefined: false,\n      onLinkActivate: () => {},\n      jslogContext: 'test',\n    };\n    renderElementIntoDOM(component);\n\n    assertLinkSwatch(component, {\n      text: 'test',\n      title: 'test is not defined',\n      isDefined: false,\n    });\n  });\n\n  it('calls the onLinkActivate callback', async () => {\n    const component = new InlineEditor.LinkSwatch.LinkSwatch();\n    let callbackCalled = false;\n    component.data = {\n      text: 'testHandler',\n      isDefined: true,\n      onLinkActivate: () => {\n        callbackCalled = true;\n      },\n      jslogContext: 'test',\n    };\n\n    const element = renderElementIntoDOM(component)!.shadowRoot!.querySelector('devtools-base-link-swatch')!.shadowRoot!\n                        .querySelector('.link-swatch-link') as HTMLButtonElement;\n    element.click();\n\n    assert.isTrue(callbackCalled);\n  });\n});\n"]}