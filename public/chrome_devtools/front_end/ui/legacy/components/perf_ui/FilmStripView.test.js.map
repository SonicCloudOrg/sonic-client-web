{"version":3,"file":"FilmStripView.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/perf_ui/FilmStripView.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,WAAW,MAAM,mCAAmC,CAAC;AACjE,OAAO,EACL,kBAAkB,EAClB,oBAAoB,EACpB,2BAA2B,EAC3B,GAAG,EACH,oBAAoB,GACrB,MAAM,mCAAmC,CAAC;AAC3C,OAAO,EAAC,uBAAuB,EAAC,MAAM,2CAA2C,CAAC;AAClF,OAAO,EAAC,WAAW,EAAC,MAAM,oCAAoC,CAAC;AAE/D,OAAO,KAAK,MAAM,MAAM,cAAc,CAAC;AAEvC,uBAAuB,CAAC,eAAe,EAAE;IACvC,KAAK,UAAU,UAAU,CAAC,aAAgD;QAExE,MAAM,aAAa,GAAG,IAAI,MAAM,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC;QAC/D,aAAa,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QACtC,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAChD,oBAAoB,CAAC,SAAS,CAAC,CAAC;QAChC,aAAa,CAAC,UAAU,EAAE,CAAC;QAC3B,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC9B,sCAAsC;QACtC,MAAM,GAAG,EAAE,CAAC;QACZ,OAAO,aAAa,CAAC;IACvB,CAAC;IAED,EAAE,CAAC,iCAAiC,EAAE,KAAK;QACzC,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;QAC/E,MAAM,SAAS,GAAG,MAAM,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC,CAAC;QAChG,MAAM,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,gBAAgB,CAAc,cAAc,CAAC,CAAC,CAAC;QAC1G,MAAM,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;QACnC,MAAM,2BAA2B,GAAG;YAClC,KAAK;YACL,OAAO;YACP,OAAO;YACP,OAAO;YACP,OAAO;SACR,CAAC;QACF,2EAA2E;QAC3E,gDAAgD;QAChD,cAAc,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE;YACtC,MAAM,GAAG,GAAG,2BAA2B,CAAmB,KAAK,EAAE,KAAK,CAAC,CAAC;YACxE,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAEjF,MAAM,WAAW,GAAG,2BAA2B,CAAiB,KAAK,EAAE,OAAO,CAAC,CAAC;YAChF,kEAAkE;YAClE,iBAAiB;YACjB,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,2BAA2B,CAAC,KAAK,CAAC,CAAC,CAAC;QAClG,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,eAAe,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAE7B,SAAS,CAAC,MAAM,EAAE,CAAC;IACrB,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,sBAAsB,EAAE;QAC/B,KAAK,UAAU,2BAA2B,CACtC,SAA4C,EAC5C,kBAA0B;YAC5B,MAAM,YAAY,GAAG,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC;YAC9F,iCAAiC;YACjC,MAAM,GAAG,EAAE,CAAC;YAEZ,kGAAkG;YAClG,MAAM,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAiB,4BAA4B,CAAC,CAAC;YAC5F,MAAM,mBAAmB,GAAG,SAAS,EAAE,UAAU,CAAC;YAClD,IAAI,CAAC,mBAAmB,EAAE,CAAC;gBACzB,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;YAC1D,CAAC;YACD,OAAO,EAAC,MAAM,EAAE,YAAY,EAAE,UAAU,EAAE,mBAAmB,EAAC,CAAC;QACjE,CAAC;QAED,EAAE,CAAC,iDAAiD,EAAE,KAAK;YACzD,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC7E,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YACjG,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/F,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4EAA4E,EAAE,KAAK;YACpF,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC7E,MAAM,WAAW,GAAG,UAAU,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;YAChE,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,WAAW,KAAK,GAAG,IAAI,WAAW,EAAE,WAAW,KAAK,SAAS,CAAC,CAAC;YAC1F,IAAI,CAAC,WAAW,EAAE,CAAC;gBACjB,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;YACpD,CAAC;YACD,kBAAkB,CAAC,WAAW,CAAC,CAAC;YAChC,MAAM,GAAG,EAAE,CAAC;YACZ,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YACjG,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/F,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kEAAkE,EAAE,KAAK;YAC1E,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC7E,MAAM,WAAW,GAAG,UAAU,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;YAChE,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,WAAW,KAAK,GAAG,IAAI,WAAW,EAAE,WAAW,KAAK,SAAS,CAAC,CAAC;YAC1F,IAAI,CAAC,WAAW,EAAE,CAAC;gBACjB,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;YACpD,CAAC;YACD,kBAAkB,CAAC,WAAW,CAAC,CAAC;YAChC,MAAM,GAAG,EAAE,CAAC;YACZ,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YACjG,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/F,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qEAAqE,EAAE,KAAK;YAC7E,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC7E,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YACjG,IAAI,CAAC,aAAa,EAAE,CAAC;gBACnB,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;YAC1D,CAAC;YACD,oBAAoB,CAAC,aAAa,EAAE;gBAClC,GAAG,EAAE,WAAW;gBAChB,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YACH,MAAM,GAAG,EAAE,CAAC;YACZ,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/F,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kEAAkE,EAAE,KAAK;YAC1E,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAE7E,MAAM,OAAO,GAAG,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;YAClE,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,KAAK,GAAG,IAAI,OAAO,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC;YAChF,IAAI,CAAC,OAAO,EAAE,CAAC;gBACb,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;YAChD,CAAC;YACD,kBAAkB,CAAC,OAAO,CAAC,CAAC;YAC5B,MAAM,GAAG,EAAE,CAAC;YACZ,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YACjG,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/F,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,KAAK;YACxD,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,cAAc,GAAG,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC;YAC/C,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,cAAc,GAAG,CAAC,CAAC,CAAC;YAE9F,IAAI,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YAC/F,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAEhH,MAAM,OAAO,GAAG,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;YAClE,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,KAAK,GAAG,IAAI,OAAO,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC;YAChF,IAAI,CAAC,OAAO,EAAE,CAAC;gBACb,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;YAChD,CAAC;YACD,kBAAkB,CAAC,OAAO,CAAC,CAAC;YAC5B,MAAM,GAAG,EAAE,CAAC;YACZ,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YAC3F,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAChH,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qEAAqE,EAAE,KAAK;YAC7E,MAAM,eAAe,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC;YAC/E,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YAC9E,MAAM,EAAC,MAAM,EAAE,UAAU,EAAC,GAAG,MAAM,2BAA2B,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC7E,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAmB,8BAA8B,CAAC,CAAC;YACjG,IAAI,CAAC,aAAa,EAAE,CAAC;gBACnB,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;YAC1D,CAAC;YACD,oBAAoB,CAAC,aAAa,EAAE;gBAClC,GAAG,EAAE,YAAY;gBACjB,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YACH,MAAM,GAAG,EAAE,CAAC;YACZ,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/F,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as TraceEngine from '../../../../models/trace/trace.js';\nimport {\n  dispatchClickEvent,\n  dispatchKeyDownEvent,\n  querySelectorErrorOnMissing,\n  raf,\n  renderElementIntoDOM,\n} from '../../../../testing/DOMHelpers.js';\nimport {describeWithEnvironment} from '../../../../testing/EnvironmentHelpers.js';\nimport {TraceLoader} from '../../../../testing/TraceLoader.js';\n\nimport * as PerfUI from './perf_ui.js';\n\ndescribeWithEnvironment('FilmStripView', function() {\n  async function renderView(filmStripData: TraceEngine.Extras.FilmStrip.Data):\n      Promise<PerfUI.FilmStripView.FilmStripView> {\n    const filmStripView = new PerfUI.FilmStripView.FilmStripView();\n    filmStripView.setModel(filmStripData);\n    const container = document.createElement('div');\n    renderElementIntoDOM(container);\n    filmStripView.markAsRoot();\n    filmStripView.show(container);\n    // Give the film strip time to render.\n    await raf();\n    return filmStripView;\n  }\n\n  it('generates frames and timestamps', async function() {\n    const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n    const filmStrip = await renderView(TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData));\n    const renderedFrames = Array.from(filmStrip.contentElement.querySelectorAll<HTMLElement>('button.frame'));\n    assert.lengthOf(renderedFrames, 5);\n    const expectedTimeLabelsForFrames = [\n      '0ms',\n      '139ms',\n      '222ms',\n      '239ms',\n      '289ms',\n    ];\n    // Ensure for each frame that we rendered the right snapshot from the trace\n    // data. And that the time label is as expected.\n    renderedFrames.forEach((frame, index) => {\n      const img = querySelectorErrorOnMissing<HTMLImageElement>(frame, 'img');\n      assert.isTrue(img.src.includes(traceParsedData.Screenshots[index].args.dataUri));\n\n      const timeElement = querySelectorErrorOnMissing<HTMLDivElement>(frame, '.time');\n      // Remove whitespace to avoid having to compare with &nbsp; in the\n      // expected text.\n      assert.strictEqual(timeElement.innerText.replace(/\\s/, ''), expectedTimeLabelsForFrames[index]);\n    });\n    assert.deepStrictEqual(1, 1);\n\n    filmStrip.detach();\n  });\n\n  describe('FilmStripView Dialog', function() {\n    async function renderDialogWithTraceEngine(\n        filmStrip: TraceEngine.Extras.FilmStrip.Data,\n        selectedFrameIndex: number): Promise<{dialog: PerfUI.FilmStripView.Dialog, shadowRoot: ShadowRoot}> {\n      const dialogWidget = PerfUI.FilmStripView.Dialog.fromFilmStrip(filmStrip, selectedFrameIndex);\n      // Give the dialog time to render\n      await raf();\n\n      // Creating the dialog widget is enough to cause it to render, so now we can find the Dialog HTML.\n      const container = document.body.querySelector<HTMLDivElement>('[data-devtools-glass-pane]');\n      const containerShadowRoot = container?.shadowRoot;\n      if (!containerShadowRoot) {\n        throw new Error('Could not find the Dialog shadowRoot');\n      }\n      return {dialog: dialogWidget, shadowRoot: containerShadowRoot};\n    }\n\n    it('renders and shows the provided frame by default', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, 0);\n      const renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[0].args.dataUri));\n      dialog.hide();\n    });\n\n    it('does not let the user navigate back if they are at the first frame already', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, 0);\n      const previousBtn = shadowRoot.querySelector('devtools-button');\n      assert.isTrue(previousBtn?.textContent === '◀' || previousBtn?.textContent === '&#9664;');\n      if (!previousBtn) {\n        throw new Error('Could not find previous button');\n      }\n      dispatchClickEvent(previousBtn);\n      await raf();\n      const renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[0].args.dataUri));\n      dialog.hide();\n    });\n\n    it('lets the user navigate back to the previous frame with the mouse', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, 1);\n      const previousBtn = shadowRoot.querySelector('devtools-button');\n      assert.isTrue(previousBtn?.textContent === '◀' || previousBtn?.textContent === '&#9664;');\n      if (!previousBtn) {\n        throw new Error('Could not find previous button');\n      }\n      dispatchClickEvent(previousBtn);\n      await raf();\n      const renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[0].args.dataUri));\n      dialog.hide();\n    });\n\n    it('lets the user navigate back to the previous frame with the keyboard', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, 1);\n      const renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      if (!renderedImage) {\n        throw new Error('Could not find film-strip-dialog img');\n      }\n      dispatchKeyDownEvent(renderedImage, {\n        key: 'ArrowLeft',\n        bubbles: true,\n      });\n      await raf();\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[0].args.dataUri));\n      dialog.hide();\n    });\n\n    it('lets the user navigate forwards to the next frame with the mouse', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, 0);\n\n      const nextBtn = shadowRoot.querySelectorAll('devtools-button')[1];\n      assert.isTrue(nextBtn.textContent === '▶' || nextBtn.textContent === '&#9654;');\n      if (!nextBtn) {\n        throw new Error('Could not find next button');\n      }\n      dispatchClickEvent(nextBtn);\n      await raf();\n      const renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[1].args.dataUri));\n      dialog.hide();\n    });\n\n    it('does not let the user go beyond the last image', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const numberOfFrames = filmStrip.frames.length;\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, numberOfFrames - 1);\n\n      let renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[numberOfFrames - 1].args.dataUri));\n\n      const nextBtn = shadowRoot.querySelectorAll('devtools-button')[1];\n      assert.isTrue(nextBtn.textContent === '▶' || nextBtn.textContent === '&#9654;');\n      if (!nextBtn) {\n        throw new Error('Could not find next button');\n      }\n      dispatchClickEvent(nextBtn);\n      await raf();\n      renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[numberOfFrames - 1].args.dataUri));\n      dialog.hide();\n    });\n\n    it('lets the user navigate forwards to the next frame with the keyboard', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n      const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n      const {dialog, shadowRoot} = await renderDialogWithTraceEngine(filmStrip, 0);\n      const renderedImage = shadowRoot.querySelector<HTMLImageElement>('[data-film-strip-dialog-img]');\n      if (!renderedImage) {\n        throw new Error('Could not find film-strip-dialog img');\n      }\n      dispatchKeyDownEvent(renderedImage, {\n        key: 'ArrowRight',\n        bubbles: true,\n      });\n      await raf();\n      assert.isTrue(renderedImage?.currentSrc.includes(traceParsedData.Screenshots[1].args.dataUri));\n      dialog.hide();\n    });\n  });\n});\n"]}