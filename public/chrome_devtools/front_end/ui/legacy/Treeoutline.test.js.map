{"version":3,"file":"Treeoutline.test.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/Treeoutline.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../core/platform/platform.js';\nimport {dispatchKeyDownEvent, renderElementIntoDOM} from '../../testing/DOMHelpers.js';\n\nimport * as UI from './legacy.js';\n\ndescribe('TreeOutline', () => {\n  describe('correctly reacts to Enter key', () => {\n    it('by expanding collapsed parent nodes', () => {\n      const tree = new UI.TreeOutline.TreeOutlineInShadow();\n      renderElementIntoDOM(tree.element);\n\n      const parent = new UI.TreeOutline.TreeElement('parent', true);\n      parent.appendChild(new UI.TreeOutline.TreeElement('child', false));\n      tree.appendChild(parent);\n      parent.select();\n\n      dispatchKeyDownEvent(tree.contentElement, {bubbles: true, key: 'Enter'});\n      assert.isTrue(parent.expanded, 'Enter key was supposed to expand the parent node');\n    });\n\n    it('by collapsing expanded parent nodes', () => {\n      const tree = new UI.TreeOutline.TreeOutlineInShadow();\n      renderElementIntoDOM(tree.element);\n\n      const parent = new UI.TreeOutline.TreeElement('parent', true);\n      parent.appendChild(new UI.TreeOutline.TreeElement('child', false));\n      tree.appendChild(parent);\n      parent.select();\n      parent.expand();\n\n      dispatchKeyDownEvent(tree.contentElement, {bubbles: true, key: 'Enter'});\n      assert.isFalse(parent.expanded, 'Enter key was supposed to collapse the parent node');\n    });\n  });\n\n  it('responds correctly to navigation keys', () => {\n    const treeOutline = new UI.TreeOutline.TreeOutlineInShadow();\n    renderElementIntoDOM(treeOutline.element);\n\n    for (let i = 0; i < 10; i++) {\n      const treeElement = new UI.TreeOutline.TreeElement(String(i), true);\n      treeElement.appendChild(new UI.TreeOutline.TreeElement(String(i) + ' child'));\n      treeOutline.appendChild(treeElement);\n    }\n\n    let selectedTitles: string[] = [];\n    treeOutline.addEventListener(UI.TreeOutline.Events.ElementSelected, event => {\n      selectedTitles.push(String(event.data.title));\n    });\n\n    treeOutline.firstChild()!.select(false, true);\n\n    const distance = 25;\n\n    assert.deepEqual(selectedTitles, ['0']);\n    selectedTitles = [];\n\n    function sendKeyMultipleTimes(key: string, n: number) {\n      for (let i = 0; i < n; i++) {\n        sendKey(key);\n      }\n    }\n\n    sendKeyMultipleTimes('ArrowDown', distance);\n    assert.deepEqual(selectedTitles, ['1', '2', '3', '4', '5', '6', '7', '8', '9']);\n    selectedTitles = [];\n\n    sendKeyMultipleTimes('ArrowUp', distance);\n    assert.deepEqual(selectedTitles, ['8', '7', '6', '5', '4', '3', '2', '1', '0']);\n    selectedTitles = [];\n\n    sendKey('End');\n    assert.deepEqual(selectedTitles, ['9']);\n    selectedTitles = [];\n\n    sendKey('Home');\n    assert.deepEqual(selectedTitles, ['0']);\n    selectedTitles = [];\n\n    sendKeyMultipleTimes('ArrowRight', distance);\n    assert.deepEqual(selectedTitles, ['0 child']);\n    selectedTitles = [];\n\n    sendKeyMultipleTimes('ArrowLeft', distance);\n    assert.deepEqual(selectedTitles, ['0']);\n    selectedTitles = [];\n\n    const innerTreeOutline = new UI.TreeOutline.TreeOutlineInShadow();\n    const firstInnerChild = new UI.TreeOutline.TreeElement('First inner child');\n    const firstInnerGrandChild = new UI.TreeOutline.TreeElement('First inner grandchild');\n    innerTreeOutline.appendChild(firstInnerChild);\n    firstInnerChild.appendChild(firstInnerGrandChild);\n\n    const treeElementForNestedTree = new UI.TreeOutline.TreeElement(innerTreeOutline.element);\n    treeOutline.appendChild(treeElementForNestedTree);\n\n    innerTreeOutline.firstChild()!.select(false, true);\n\n    sendKey('ArrowRight');\n\n    assert.isTrue(innerTreeOutline.firstChild()!.expanded, 'child is not expanded');\n\n    function sendKey(key: string) {\n      const deepActiveElement = Platform.DOMUtilities.deepActiveElement(document);\n      deepActiveElement!.dispatchEvent(new KeyboardEvent('keydown', {bubbles: true, cancelable: true, key}));\n    }\n  });\n});\n"]}