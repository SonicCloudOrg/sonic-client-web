{"version":3,"file":"CodeBlock.test.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/markdown_view/CodeBlock.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport {\n  dispatchClickEvent,\n  renderElementIntoDOM,\n  resetTestDOM,\n} from '../../../testing/DOMHelpers.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\n\nimport * as MarkdownView from './markdown_view.js';\n\ndescribeWithEnvironment('CodeBlock', () => {\n  it('copies the code to clipboard', () => {\n    const component = new MarkdownView.CodeBlock.CodeBlock();\n    component.code = 'test';\n    renderElementIntoDOM(component);\n    const button = component.shadowRoot!.querySelector('.copy-button');\n    assert.exists(button);\n    const clock = sinon.useFakeTimers();\n    try {\n      assert.strictEqual(button.querySelector('span')?.innerText, 'Copy code');\n      const copyText = sinon\n                           .stub(\n                               Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n                               'copyText',\n                               )\n                           .returns();\n      dispatchClickEvent(button, {\n        bubbles: true,\n        composed: true,\n      });\n      assert.isTrue(copyText.calledWith('test'));\n      clock.tick(100);\n      assert.strictEqual(button.querySelector('span')!.innerText, 'Copied to clipboard');\n      clock.tick(1100);\n      assert.strictEqual(button.querySelector('span')!.innerText, 'Copy code');\n    } finally {\n      clock.restore();\n      resetTestDOM();\n    }\n  });\n\n  it('renders no legal notice by default', () => {\n    try {\n      const component = new MarkdownView.CodeBlock.CodeBlock();\n      component.code = 'test';\n      renderElementIntoDOM(component);\n      const notice = component.shadowRoot!.querySelector('.notice') as HTMLElement;\n      assert(notice === null, '.notice was found');\n    } finally {\n      resetTestDOM();\n    }\n  });\n\n  it('renders legal notice if configured', () => {\n    try {\n      const component = new MarkdownView.CodeBlock.CodeBlock();\n      component.code = 'test';\n      component.displayNotice = true;\n      renderElementIntoDOM(component);\n      const notice = component.shadowRoot!.querySelector('.notice') as HTMLElement;\n      assert.exists(notice);\n      assert.strictEqual(notice!.innerText, 'Use code snippets with caution');\n    } finally {\n      resetTestDOM();\n    }\n  });\n});\n"]}