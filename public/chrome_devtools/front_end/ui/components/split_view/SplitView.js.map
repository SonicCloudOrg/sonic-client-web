{"version":3,"file":"SplitView.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/split_view/SplitView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\n// clean-css does not compile this file correctly. So as a workaround adding styles inline.\nconst styles = `\n  :host {\n    --current-main-area-size: 50%;\n    --resizer-size: 3px;\n    --min-main-area-size: 200px;\n    --min-sidebar-size: 150px;\n    --main-area-size: calc(max(var(--current-main-area-size), var(--min-main-area-size)));\n\n    height: 100%;\n    width: 100%;\n    display: block;\n    overflow: auto;\n  }\n\n  .wrapper {\n    display: flex;\n    flex-direction: row;\n    height: 100%;\n    width: 100%;\n    container: sidebar / size; /* stylelint-disable-line property-no-unknown */\n  }\n\n  .container {\n    --resizer-position: calc(min(var(--main-area-size), calc(100% - var(--min-sidebar-size))));\n    --min-container-size: calc(var(--min-sidebar-size) + var(--min-main-area-size) + var(--resizer-size));\n\n    display: flex;\n    flex-direction: row;\n    height: 100%;\n    width: 100%;\n    position: relative;\n    gap: var(--resizer-size);\n\n    min-width: var(--min-container-size);\n  }\n\n  #resizer {\n    background-color: var(--sys-color-surface1);\n    position: absolute;\n    user-select: none;\n\n    /* horizontal */\n    width: var(--resizer-size);\n    cursor: col-resize;\n    left: var(--resizer-position);\n    bottom: 0;\n    top: 0;\n  }\n\n  slot {\n    overflow: auto;\n    display: block;\n  }\n\n  slot[name=\"main\"] {\n\n    /* horizontal */\n    width: var(--resizer-position);\n    min-width: var(--min-main-area-size);\n  }\n\n  slot[name=\"sidebar\"] {\n    flex: 1 0 0;\n\n    min-width: var(--min-sidebar-size);\n  }\n\n  .horizontal .container {\n    flex-direction: column;\n    min-height: var(--min-container-size);\n    min-width: auto;\n  }\n\n  .horizontal #resizer {\n    width: auto;\n    height: var(--resizer-size);\n    cursor: row-resize;\n    top: var(--resizer-position);\n    left: 0;\n    right: 0;\n  }\n\n  .horizontal slot[name=\"main\"] {\n    width: auto;\n    min-width: auto;\n    height: var(--resizer-position);\n    min-height: var(--min-main-area-size);\n  }\n\n  .horizontal slot[name=\"sidebar\"] {\n    min-width: auto;\n    min-height: var(--min-sidebar-size);\n  }\n`;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-split-view': SplitView;\n  }\n}\n\nconst splitViewStyles = new CSSStyleSheet();\nsplitViewStyles.replaceSync(styles);\n\nexport class SplitView extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-split-view`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #mousePos = [0, 0];\n  #mainAxisIdx = 0;\n  #mainDimensions = [0, 0];\n  #observer?: ResizeObserver;\n  #horizontal = false;\n\n  connectedCallback(): void {\n    this.style.setProperty('--current-main-area-size', '60%');\n    this.#shadow.adoptedStyleSheets = [splitViewStyles];\n    this.#observer = new ResizeObserver(\n        entries => this.#onResize(entries[0].contentRect),\n    );\n    this.#observer.observe(this);\n    this.#render();\n  }\n\n  get horizontal(): boolean {\n    return this.#horizontal;\n  }\n\n  set horizontal(horizontal: boolean) {\n    this.#horizontal = horizontal;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n  }\n\n  #onResize = (rect: DOMRectReadOnly): void => {\n    const prevMainAxisIdx = this.#mainAxisIdx;\n    if (rect.width <= 600 && rect.height >= 600 || this.#horizontal) {\n      this.#mainAxisIdx = 1;\n    } else {\n      this.#mainAxisIdx = 0;\n    }\n    if (this.#mainAxisIdx !== prevMainAxisIdx) {\n      void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n    }\n  };\n\n  #onMouseDown = (event: MouseEvent): void => {\n    const main = this.#shadow.querySelector('slot[name=main]');\n    if (!main) {\n      throw new Error('Main slot not found');\n    }\n    const rect = main.getBoundingClientRect();\n    this.#mainDimensions = [rect.width, rect.height];\n    this.#mousePos = [event.clientX, event.clientY];\n    window.addEventListener('mousemove', this.#onMouseMove, true);\n    window.addEventListener('mouseup', this.#onMouseUp, true);\n  };\n\n  #onMouseUp = (): void => {\n    window.removeEventListener('mousemove', this.#onMouseMove, true);\n    window.removeEventListener('mouseup', this.#onMouseUp, true);\n  };\n\n  #onMouseMove = (event: MouseEvent): void => {\n    const mousePos = [event.clientX, event.clientY];\n    const delta = mousePos[this.#mainAxisIdx] - this.#mousePos[this.#mainAxisIdx];\n    const rect = this.getBoundingClientRect();\n    const containerDimensions = [rect.width, rect.height];\n    const length = ((this.#mainDimensions[this.#mainAxisIdx] + delta) * 100) / containerDimensions[this.#mainAxisIdx];\n    this.style.setProperty('--current-main-area-size', length + '%');\n  };\n\n  #render = (): void => {\n    // clang-format off\n    LitHtml.render(\n      LitHtml.html`\n        <div class=\"wrapper ${this.#mainAxisIdx === 1 ? 'horizontal' : ''}\">\n          <div class=\"container\">\n            <slot name=\"main\"></slot>\n            <div id=\"resizer\" @mousedown=${this.#onMouseDown}></div>\n            <slot name=\"sidebar\"></slot>\n          </div>\n        </div>\n      `,\n      this.#shadow,\n      { host: this },\n    );\n    // clang-format on\n  };\n}\n\ncustomElements.define(\n    'devtools-split-view',\n    SplitView,\n);\n"]}