{"version":3,"file":"ShortcutDialog.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/dialogs/ShortcutDialog.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport {\n  type ClickOutsideDialogEvent,\n  Dialog as DialogElement,\n  DialogHorizontalAlignment,\n  DialogVerticalPosition,\n} from './Dialog.js';\nimport shortcutDialogStyles from './shortcutDialog.css.js';\n\nconst UIStrings = {\n\n  /**\n   * @description Title of question mark button for the shortcuts dialog.\n   */\n  showShortcutTitle: 'Show shortcuts',\n  /**\n   * @description Title of the keyboard shortcuts help menu.\n   */\n  dialogTitle: 'Keyboard shortcuts',\n  /**\n   * @description Title of close button for the shortcuts dialog.\n   */\n  close: 'Close',\n};\n\nconst str_ = i18n.i18n.registerUIStrings('ui/components/dialogs/ShortcutDialog.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-shortcut-dialog': ShortcutDialog;\n  }\n}\n\nexport class ShowDialog extends Event {\n  static readonly eventName = 'showdialog';\n\n  constructor() {\n    super(ShowDialog.eventName);\n  }\n}\n\nexport interface Shortcut {\n  title: string|Platform.UIString.LocalizedString;\n  bindings: string[];\n}\nexport interface ShortcutDialogData {\n  shortcuts: Shortcut[];\n  open?: boolean;\n}\n\nexport class ShortcutDialog extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-shortcut-dialog`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  readonly #renderBound = this.#render.bind(this);\n\n  #dialog: DialogElement|null = null;\n  #showButton: Buttons.Button.Button|null = null;\n  #shortcuts: Shortcut[] = [];\n  #openOnRender = false;\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [shortcutDialogStyles];\n  }\n\n  set data(data: ShortcutDialogData) {\n    this.#shortcuts = data.shortcuts;\n    if (data.open) {\n      this.#openOnRender = data.open;\n    }\n\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#renderBound);\n  }\n\n  #showDialog(): void {\n    if (!this.#dialog) {\n      throw new Error('Dialog not found');\n    }\n    void this.#dialog.setDialogVisible(true);\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#renderBound);\n    this.dispatchEvent(new ShowDialog());\n  }\n\n  #closeDialog(evt?: ClickOutsideDialogEvent): void {\n    if (!this.#dialog) {\n      throw new Error('Dialog not found');\n    }\n    void this.#dialog.setDialogVisible(false);\n    if (evt) {\n      evt.stopImmediatePropagation();\n    }\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#renderBound);\n  }\n\n  #render(): void {\n    if (!ComponentHelpers.ScheduledRender.isScheduledRender(this)) {\n      throw new Error('Shortcut dialog render was not scheduled');\n    }\n\n    // clang-format off\n    LitHtml.render(\n      LitHtml.html`\n      <${Buttons.Button.Button.litTagName}\n        @click=${this.#showDialog}\n        on-render=${ComponentHelpers.Directives.nodeRenderedCallback(node => {\n          this.#showButton = node as Buttons.Button.Button;\n        })}\n        .data=${{\n          variant: Buttons.Button.Variant.TOOLBAR,\n          iconName: 'help',\n          title: i18nString(UIStrings.showShortcutTitle),\n        } as Buttons.Button.ButtonData}\n      ></${Buttons.Button.Button.litTagName}>\n      <${DialogElement.litTagName}\n        @clickoutsidedialog=${this.#closeDialog}\n        .showConnector=${true}\n        .origin=${() => {\n          if (!this.#showButton) {\n            throw new Error('Button not found');\n          }\n          return this.#showButton;\n        }}\n        .position=${DialogVerticalPosition.BOTTOM}\n        .horizontalAlignment=${DialogHorizontalAlignment.RIGHT}\n        .jslogContext=${'shortcuts'}\n        on-render=${ComponentHelpers.Directives.nodeRenderedCallback(node => {\n          this.#dialog = node as DialogElement;\n        })}\n      >\n        <div class=\"keybinds-category-header\">\n          <span class=\"keybinds-category-header-text\">${i18nString(UIStrings.dialogTitle)}</span>\n          <${Buttons.Button.Button.litTagName}\n            @click=${this.#closeDialog}\n            class='close-icon'\n            .data=${{\n              variant: Buttons.Button.Variant.TOOLBAR,\n              iconName: 'cross',\n              title: i18nString(UIStrings.close),\n            } as Buttons.Button.ButtonData}\n            jslog=${VisualLogging.close().track({click: true})}\n          ></${Buttons.Button.Button.litTagName}>\n        </div>\n        <ul class=\"keybinds-list\">\n          ${this.#shortcuts.map(shortcut =>\n            LitHtml.html`\n              <li class=\"keybinds-list-item\">\n                <div class=\"keybinds-action-name keybinds-list-text\">${shortcut.title}</div>\n                ${shortcut.bindings.map((binding, index) =>\n                  LitHtml.html`\n                    <div class=\"keybinds-shortcut keybinds-list-text\">\n                      <span class=\"keybinds-key\">${binding}</span>\n                    </div>\n                    ${shortcut.bindings.at(index + 1) ?\n                      LitHtml.html`<span class=\"keybinds-shortcut-separator\"> - </span>`\n                      : LitHtml.nothing\n                    }\n                `)}\n              </li>`,\n          )}\n        </ul>\n      </${DialogElement.litTagName}>\n      `,\n      this.#shadow, {host: this});\n    // clang-format on\n\n    if (this.#openOnRender) {\n      this.#showDialog();\n      this.#openOnRender = false;\n    }\n  }\n}\n\ncustomElements.define('devtools-shortcut-dialog', ShortcutDialog);\n"]}