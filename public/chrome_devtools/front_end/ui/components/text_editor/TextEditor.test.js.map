{"version":3,"file":"TextEditor.test.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/text_editor/TextEditor.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../../core/common/common.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport type * as Protocol from '../../../generated/protocol.js';\nimport * as Bindings from '../../../models/bindings/bindings.js';\nimport * as Workspace from '../../../models/workspace/workspace.js';\nimport {renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {\n  createTarget,\n  describeWithEnvironment,\n} from '../../../testing/EnvironmentHelpers.js';\nimport {expectCall} from '../../../testing/ExpectStubCall.js';\nimport {TestPlugin} from '../../../testing/LanguagePluginHelpers.js';\nimport {describeWithMockConnection} from '../../../testing/MockConnection.js';\nimport {MockExecutionContext} from '../../../testing/MockExecutionContext.js';\nimport * as CodeMirror from '../../../third_party/codemirror.next/codemirror.next.js';\nimport * as UI from '../../legacy/legacy.js';\n\nimport * as TextEditor from './text_editor.js';\n\nfunction makeState(doc: string, extensions: CodeMirror.Extension = []) {\n  return CodeMirror.EditorState.create({\n    doc,\n    extensions: [\n      extensions,\n      TextEditor.Config.baseConfiguration(doc),\n      TextEditor.Config.autocompletion.instance(),\n    ],\n  });\n}\n\ndescribeWithEnvironment('TextEditor', () => {\n  describe('component', () => {\n    it('has a state property', () => {\n      const editor = new TextEditor.TextEditor.TextEditor(makeState('one'));\n      assert.strictEqual(editor.state.doc.toString(), 'one');\n      editor.state = makeState('two');\n      assert.strictEqual(editor.state.doc.toString(), 'two');\n      renderElementIntoDOM(editor);\n      assert.strictEqual(editor.editor.state.doc.toString(), 'two');\n      editor.editor.dispatch({changes: {from: 3, insert: '!'}});\n      editor.remove();\n      assert.strictEqual(editor.editor.state.doc.toString(), 'two!');\n    });\n\n    it('sets an aria-label attribute', () => {\n      const editor = new TextEditor.TextEditor.TextEditor(makeState(''));\n      assert.strictEqual(editor.editor.contentDOM.getAttribute('aria-label'), 'Code editor');\n    });\n\n    it('can highlight whitespace', () => {\n      const editor = new TextEditor.TextEditor.TextEditor(\n          makeState('line1  \\n  line2( )\\n\\tline3  ', TextEditor.Config.showWhitespace.instance()));\n      renderElementIntoDOM(editor);\n      assert.strictEqual(editor.editor.dom.querySelectorAll('.cm-trailingWhitespace, .cm-highlightedSpaces').length, 0);\n      Common.Settings.Settings.instance().moduleSetting('show-whitespaces-in-editor').set('all');\n      assert.strictEqual(editor.editor.dom.querySelectorAll('.cm-highlightedSpaces').length, 4);\n      assert.strictEqual(editor.editor.dom.querySelectorAll('.cm-highlightedTab').length, 1);\n      Common.Settings.Settings.instance().moduleSetting('show-whitespaces-in-editor').set('trailing');\n      assert.strictEqual(editor.editor.dom.querySelectorAll('.cm-highlightedSpaces').length, 0);\n      assert.strictEqual(editor.editor.dom.querySelectorAll('.cm-trailingWhitespace').length, 2);\n      Common.Settings.Settings.instance().moduleSetting('show-whitespaces-in-editor').set('none');\n      assert.strictEqual(editor.editor.dom.querySelectorAll('.cm-trailingWhitespace, .cm-highlightedSpaces').length, 0);\n      editor.remove();\n    });\n\n    it('should restore scroll to the same position after reconnecting to DOM when it is scrollable', async () => {\n      const editor = new TextEditor.TextEditor.TextEditor(makeState(\n          'line1\\nline2\\nline3\\nline4\\nline5\\nline6andthisisalonglinesothatwehaveenoughspacetoscrollhorizontally',\n          [CodeMirror.EditorView.theme(\n              {'&.cm-editor': {height: '50px', width: '50px'}, '.cm-scroller': {overflow: 'auto'}})]));\n      const scrollEventHandledToSaveScrollPositionForTest =\n          sinon.stub(editor, 'scrollEventHandledToSaveScrollPositionForTest');\n      const waitForFirstScrollPromise = expectCall(scrollEventHandledToSaveScrollPositionForTest);\n      renderElementIntoDOM(editor);\n      editor.editor.dispatch({\n        effects: CodeMirror.EditorView.scrollIntoView(0, {\n          x: 'start',\n          xMargin: -20,\n          y: 'start',\n          yMargin: -20,\n        }),\n      });\n      await waitForFirstScrollPromise;\n      const scrollTopBeforeRemove = editor.editor.scrollDOM.scrollTop;\n      const scrollLeftBeforeRemove = editor.editor.scrollDOM.scrollLeft;\n\n      const waitForSecondScrollPromise = expectCall(scrollEventHandledToSaveScrollPositionForTest);\n      editor.remove();\n      renderElementIntoDOM(editor);\n      await waitForSecondScrollPromise;\n\n      const scrollTopAfterReconnect = editor.editor.scrollDOM.scrollTop;\n      const scrollLeftAfterReconnect = editor.editor.scrollDOM.scrollLeft;\n      assert.strictEqual(scrollTopBeforeRemove, scrollTopAfterReconnect);\n      assert.strictEqual(scrollLeftBeforeRemove, scrollLeftAfterReconnect);\n    });\n  });\n\n  describe('configuration', () => {\n    it('can detect line separators', () => {\n      assert.strictEqual(makeState('one\\r\\ntwo\\r\\nthree').lineBreak, '\\r\\n');\n      assert.strictEqual(makeState('one\\ntwo\\nthree').lineBreak, '\\n');\n      assert.strictEqual(makeState('one\\r\\ntwo\\nthree').lineBreak, '\\n');\n    });\n\n    it('handles dynamic reconfiguration', () => {\n      const editor = new TextEditor.TextEditor.TextEditor(makeState(''));\n      renderElementIntoDOM(editor);\n\n      assert.strictEqual(editor.state.facet(CodeMirror.indentUnit), '    ');\n      Common.Settings.Settings.instance().moduleSetting('text-editor-indent').set('\\t');\n      assert.strictEqual(editor.state.facet(CodeMirror.indentUnit), '\\t');\n      Common.Settings.Settings.instance().moduleSetting('text-editor-indent').set('    ');\n    });\n\n    it('does not treat dashes as word chars in CSS', () => {\n      const state = makeState('.some-selector {}', CodeMirror.css.cssLanguage);\n      const {from, to} = state.wordAt(1)!;\n      assert.strictEqual(state.sliceDoc(from, to), 'some');\n    });\n  });\n\n  describe('autocompletion', () => {\n    it('can complete builtins and keywords', async () => {\n      const state = makeState('c', CodeMirror.javascript.javascriptLanguage);\n      const result =\n          await TextEditor.JavaScript.javascriptCompletionSource(new CodeMirror.CompletionContext(state, 1, false));\n      assert.isNotNull(result);\n      const completions = result ? result.options : [];\n      assert.isTrue(completions.some(o => o.label === 'clear'));\n      assert.isTrue(completions.some(o => o.label === 'continue'));\n    });\n\n    async function testQueryType(\n        code: string,\n        pos: number,\n        type?: TextEditor.JavaScript.QueryType,\n        range: string = '',\n        related?: string,\n        ): Promise<void> {\n      const state = makeState(code, CodeMirror.javascript.javascriptLanguage);\n      const query = TextEditor.JavaScript.getQueryType(CodeMirror.syntaxTree(state), pos, state.doc);\n      if (type === undefined) {\n        assert.isNull(query);\n      } else {\n        assert.isNotNull(query);\n        if (query) {\n          assert.strictEqual(query.type, type);\n          assert.strictEqual(code.slice(query.from ?? pos, pos), range);\n          assert.strictEqual(query.relatedNode && code.slice(query.relatedNode.from, query.relatedNode.to), related);\n        }\n      }\n    }\n\n    it('recognizes expression queries', async () => {\n      await testQueryType('foo', 3, TextEditor.JavaScript.QueryType.Expression, 'foo');\n      await testQueryType('foo ', 4, TextEditor.JavaScript.QueryType.Expression, '');\n      await testQueryType('let', 3, TextEditor.JavaScript.QueryType.Expression, 'let');\n    });\n\n    it('recognizes propery name queries', async () => {\n      await testQueryType('foo.bar', 7, TextEditor.JavaScript.QueryType.PropertyName, 'bar', 'foo.bar');\n      await testQueryType('foo.', 4, TextEditor.JavaScript.QueryType.PropertyName, '', 'foo.');\n      await testQueryType('if (foo.', 8, TextEditor.JavaScript.QueryType.PropertyName, '', 'foo.');\n      await testQueryType('new foo.bar().', 14, TextEditor.JavaScript.QueryType.PropertyName, '', 'new foo.bar().');\n      await testQueryType('foo?.', 5, TextEditor.JavaScript.QueryType.PropertyName, '', 'foo?.');\n      await testQueryType('foo?.b', 6, TextEditor.JavaScript.QueryType.PropertyName, 'b', 'foo?.b');\n    });\n\n    it('recognizes property expression queries', async () => {\n      await testQueryType('foo[', 4, TextEditor.JavaScript.QueryType.PropertyExpression, '', 'foo[');\n      await testQueryType('foo[\"ba', 7, TextEditor.JavaScript.QueryType.PropertyExpression, '\"ba', 'foo[\"ba');\n    });\n\n    describe('potential map key retrievals', () => {\n      it('recognizes potential maps', async () => {\n        await testQueryType('foo.get(', 8, TextEditor.JavaScript.QueryType.PotentiallyRetrievingFromMap, '', 'foo');\n        await testQueryType('foo\\n.get(', 9, TextEditor.JavaScript.QueryType.PotentiallyRetrievingFromMap, '', 'foo');\n      });\n\n      it('leaves other expressions as-is', async () => {\n        await testQueryType('foo.method(', 11, TextEditor.JavaScript.QueryType.Expression);\n        await testQueryType('5 + (', 5, TextEditor.JavaScript.QueryType.Expression);\n        await testQueryType('functionCall(', 13, TextEditor.JavaScript.QueryType.Expression);\n      });\n    });\n\n    it('does not complete in inappropriate places', async () => {\n      await testQueryType('\"foo bar\"', 4);\n      await testQueryType('x[\"foo\" + \"bar', 14);\n      await testQueryType('// comment', 10);\n    });\n  });\n\n  it('dispatching a transaction from a saved editor reference should not throw an error', () => {\n    const textEditor = new TextEditor.TextEditor.TextEditor(makeState('one'));\n    const editorViewA = textEditor.editor;\n\n    renderElementIntoDOM(textEditor);\n    // textEditor.editor references to EditorView A.\n    textEditor.dispatch({changes: {from: 0, insert: 'a'}});\n    // `disconnectedCallback` removed `textEditor.#activeEditor`\n    // so reaching to `textEditor.editor` will create a new EditorView after this.\n    textEditor.remove();\n    // EditorView B is created from the previous state\n    // and EditorView B's state is diverged from previous state after this transaction.\n    textEditor.dispatch({changes: {from: 0, insert: 'b'}});\n\n    // directly dispatching from Editor A now calls `textEditor.editor.update`\n    // which references to EditorView B that has a different state.\n    assert.doesNotThrow(() => editorViewA.dispatch({changes: {from: 3, insert: '!'}}));\n  });\n});\n\ndescribeWithMockConnection('TextEditor autocompletion', () => {\n  it('does not complete on language plugin frames', async () => {\n    const executionContext = new MockExecutionContext(createTarget());\n    const {debuggerModel} = executionContext;\n    UI.Context.Context.instance().setFlavor(SDK.RuntimeModel.ExecutionContext, executionContext);\n    const workspace = Workspace.Workspace.WorkspaceImpl.instance();\n    const targetManager = SDK.TargetManager.TargetManager.instance();\n    const resourceMapping = new Bindings.ResourceMapping.ResourceMapping(targetManager, workspace);\n\n    const {pluginManager} = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance(\n        {forceNew: true, targetManager, resourceMapping});\n    const testScript = debuggerModel.parsedScriptSource(\n        '1' as Protocol.Runtime.ScriptId, 'script://1' as Platform.DevToolsPath.UrlString, 0, 0, 0, 0,\n        executionContext.id, '', undefined, false, undefined, false, false, 0, null, null, null, null, null, null);\n    const payload: Protocol.Debugger.CallFrame = {\n      callFrameId: '0' as Protocol.Debugger.CallFrameId,\n      functionName: 'test',\n      functionLocation: undefined,\n      location: {\n        scriptId: testScript.scriptId,\n        lineNumber: 0,\n        columnNumber: 0,\n      },\n      url: 'test-url',\n      scopeChain: [],\n      this: {type: 'object'} as Protocol.Runtime.RemoteObject,\n      returnValue: undefined,\n      canBeRestarted: false,\n    };\n    const callframe = new SDK.DebuggerModel.CallFrame(debuggerModel, testScript, payload);\n\n    executionContext.debuggerModel.setSelectedCallFrame(callframe);\n    pluginManager.addPlugin(new class extends TestPlugin {\n      constructor() {\n        super('TextEditorTestPlugin');\n      }\n\n      override handleScript(script: SDK.Script.Script) {\n        return script === testScript;\n      }\n    }());\n\n    const state = makeState('c', CodeMirror.javascript.javascriptLanguage);\n    const result =\n        await TextEditor.JavaScript.javascriptCompletionSource(new CodeMirror.CompletionContext(state, 1, false));\n    assert.isNull(result);\n  });\n});\n"]}