{"version":3,"file":"DomState.test.js","sourceRoot":"","sources":["../../../../../../front_end/ui/visual_logging/DomState.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {renderElementIntoDOM} from '../../testing/DOMHelpers.js';\n\nimport * as VisualLogging from './visual_logging-testing.js';\n\ndescribe('DomState', () => {\n  let container: HTMLElement;\n\n  beforeEach(() => {\n    container = document.createElement('div');\n    renderElementIntoDOM(container);\n  });\n\n  const el = (id: string, d: Document|ShadowRoot = document) => d.getElementById(id) as Element;\n\n  it('gets loggable elements and their parents', () => {\n    container.innerHTML = `\n      <div id=\"1\">\n        <div jslog=\"TreeItem\" id=\"11\">\n          <div id=\"111\">\n            <div jslog=\"TreeItem\" id=\"1111\">\n              <div jslog=\"TreeItem\" id=\"11111\"></div>\n            </div>\n            <div jslog=\"TreeItem\" id=\"1112\"></div>\n          </div>\n          <div id=\"112\"><span>hello</span></div>\n          <div jslog=\"TreeItem\" id=\"113\"></div>\n        </div>\n        <div id=\"12\">\n          <div jslog=\"TreeItem\" id=\"121\">\n            <div jslog=\"TreeItem\" id=\"1211\"></div>\n          </div>\n        </div>\n      <div>\n      <div jslog=\"TreeItem\" id=\"2\"></div>`;\n    const {loggables} = VisualLogging.DomState.getDomState([document]);\n    assert.sameDeepMembers(loggables, [\n      {element: el('2'), parent: undefined},\n      {element: el('121'), parent: undefined},\n      {element: el('1211'), parent: el('121')},\n      {element: el('11'), parent: undefined},\n      {element: el('113'), parent: el('11')},\n      {element: el('1112'), parent: el('11')},\n      {element: el('1111'), parent: el('11')},\n      {element: el('11111'), parent: el('1111')},\n    ]);\n  });\n\n  it('returns element in a BFS order', () => {\n    container.innerHTML = `\n      <li jslog=\"TreeItem\" id=\"1\">\n      </li>\n      <ol>\n        <li jslog=\"TreeItem\" id=\"11\">\n        </li>\n        <li jslog=\"TreeItem\" id=\"12\">\n      </ol>\n      <li jslog=\"TreeItem\" id=\"2\">\n      </li>\n      <ol>\n        <li jslog=\"TreeItem\" id=\"21\">\n        </li>\n        <li jslog=\"TreeItem\" id=\"22\">\n        </li>\n        </li>\n      </ol>`;\n    const {loggables} = VisualLogging.DomState.getDomState([document]);\n    assert.deepEqual(loggables, [\n      {element: el('1'), parent: undefined},\n      {element: el('2'), parent: undefined},\n      {element: el('11'), parent: undefined},\n      {element: el('12'), parent: undefined},\n      {element: el('21'), parent: undefined},\n      {element: el('22'), parent: undefined},\n    ]);\n  });\n\n  it('gets loggable elements across documents', () => {\n    container.innerHTML = `\n      <div jslog=\"TreeItem\" id=\"1\"></div>\n      <iframe id=\"iframe\"></iframe>`;\n    const iframe = el('iframe') as HTMLIFrameElement;\n    const iframeDocument = iframe.contentDocument;\n    assert.exists(iframeDocument);\n    iframeDocument.body.innerHTML = `\n      <div jslog=\"TreeItem\" id=\"2\"></div>`;\n    const {loggables} = VisualLogging.DomState.getDomState([document, iframeDocument]);\n    assert.sameDeepMembers(loggables, [\n      {element: el('1'), parent: undefined},\n      {element: el('2', iframeDocument), parent: undefined},\n    ]);\n  });\n\n  it('identifies parents across shadow DOM', () => {\n    container.innerHTML = `\n      <div jslog=\"TreeItem\" id=\"1\">\n        <div jslog=\"TreeItem\" id=\"12\"></div>\n        <div id=\"13\"></div>\n      </div>`;\n\n    const shadow = el('13').attachShadow({mode: 'open'});\n    const shadowContent = document.createElement('div');\n    shadowContent.innerHTML = `\n      <div id=\"131\">\n        <div jslog=\"TreeItem\" id=\"1311\"></div>\n      </div>`;\n    shadow.appendChild(shadowContent);\n\n    const {loggables} = VisualLogging.DomState.getDomState([document]);\n    assert.sameDeepMembers(loggables, [\n      {element: el('1'), parent: undefined},\n      {element: el('1311', shadow) as Element, parent: el('1')},\n      {element: el('12'), parent: el('1')},\n    ]);\n  });\n\n  it('walks slots in the assigned order', () => {\n    class TestComponent extends HTMLElement {\n      private render() {\n        const shadow = this.attachShadow({mode: 'open'});\n        shadow.innerHTML = `\n          <div jslog=\"TreeItem\" id=\"c1\"><slot id=\"slot-1\" name=\"slot-1\"></slot></div>\n          <div jslog=\"TreeItem\" id=\"c2\"><slot id=\"slot-2\" name=\"slot-2\"></slot></div>`;\n      }\n\n      connectedCallback() {\n        this.render();\n      }\n    }\n    customElements.define('ve-test-component', class extends TestComponent {});\n\n    container.innerHTML = `\n      <div id=\"0\" jslog=\"TreeItem\">\n        <ve-test-component id=\"1\" jslog=\"TreeItem\">\n          <div jslog=\"TreeItem\" id=\"11\" slot=\"slot-1\">\n            <div id=\"111\" jslog=\"TreeItem\"></div>\n          </div>\n          <div id=\"12\" slot=\"slot-2\" jslog=\"TreeItem\">\n        </ve-test-component>\n      </div>`;\n    const {loggables} = VisualLogging.DomState.getDomState([document]);\n    const shadow = el('1').shadowRoot as ShadowRoot;\n    assert.sameDeepMembers(loggables, [\n      {element: el('0'), parent: undefined},\n      {element: el('1'), parent: el('0')},\n      {element: el('c1', shadow), parent: el('1')},\n      {element: el('11'), parent: el('c1', shadow)},\n      {element: el('111'), parent: el('11')},\n      {element: el('c2', shadow), parent: el('1')},\n      {element: el('12'), parent: el('c2', shadow)},\n    ]);\n  });\n\n  it('returns shadow roots', () => {\n    container.innerHTML = `\n      <div id=\"1\">\n        <div class=\"shadow\" id=\"11\"></div>\n      </div>\n      <div class=\"shadow\" id=\"2\"></div>`;\n    const addedShadowRoots: ShadowRoot[] = [];\n    const attachShadows = (el: HTMLElement|ShadowRoot) => {\n      for (const target of el.querySelectorAll('.shadow')) {\n        const shadow = target.attachShadow({mode: 'open'});\n        const content = document.createElement('div');\n        content.innerHTML = '<div></div><div class=\"shadow></div>';\n        shadow.appendChild(content);\n        addedShadowRoots.push(shadow);\n      }\n    };\n\n    attachShadows(container);\n    for (const shadow of addedShadowRoots) {\n      attachShadows(shadow);\n    }\n    const {shadowRoots} = VisualLogging.DomState.getDomState([document]);\n    assert.sameDeepMembers(shadowRoots, addedShadowRoots);\n  });\n\n  it('identifies visible elements', () => {\n    container.innerHTML = `\n      <style>\n        .box {\n          position: absolute;\n          height: 100px;\n          width: 100px;\n        }\n      </style>\n      <div id=\"1\" class=\"box\" style=\"left: 50px; top: 0;\"></div>\n      <div id=\"2\" class=\"box\" style=\"left: 0; top: 50px;\"></div>`;\n\n    assert.deepStrictEqual(\n        VisualLogging.DomState.visibleOverlap(el('1'), new DOMRect(0, 0, 200, 200)), new DOMRect(50, 0, 100, 100));\n    assert.deepStrictEqual(\n        VisualLogging.DomState.visibleOverlap(el('2'), new DOMRect(0, 0, 200, 200)), new DOMRect(0, 50, 100, 100));\n\n    assert.deepStrictEqual(\n        VisualLogging.DomState.visibleOverlap(el('1'), new DOMRect(0, 0, 100, 100)), new DOMRect(50, 0, 50, 100));\n    assert.deepStrictEqual(\n        VisualLogging.DomState.visibleOverlap(el('2'), new DOMRect(0, 0, 100, 100)), new DOMRect(0, 50, 100, 50));\n\n    assert.isNull(VisualLogging.DomState.visibleOverlap(el('1'), new DOMRect(0, 0, 50, 50)));\n    assert.isNull(VisualLogging.DomState.visibleOverlap(el('2'), new DOMRect(0, 0, 50, 50)));\n\n    assert.isNull(VisualLogging.DomState.visibleOverlap(el('1'), new DOMRect(0, 0, 50, 100)));\n    assert.deepStrictEqual(\n        VisualLogging.DomState.visibleOverlap(el('2'), new DOMRect(0, 0, 50, 100)), new DOMRect(0, 50, 50, 50));\n\n    assert.isNull(VisualLogging.DomState.visibleOverlap(el('1'), new DOMRect(25, 25, 25, 50)));\n    assert.deepStrictEqual(\n        VisualLogging.DomState.visibleOverlap(el('2'), new DOMRect(25, 25, 25, 50)), new DOMRect(25, 50, 25, 25));\n\n    assert.isNull(VisualLogging.DomState.visibleOverlap(el('1'), new DOMRect(25, 25, 30, 30)));\n    assert.isNull(VisualLogging.DomState.visibleOverlap(el('2'), new DOMRect(25, 25, 30, 30)));\n  });\n});\n"]}